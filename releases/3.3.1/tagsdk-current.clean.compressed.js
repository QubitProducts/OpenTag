(function(){var E,A;function J(){function a(b){l.events.push(b);f(l.listeners,function(a){if(!a.disposed&&e(a.type,b.meta.type))try{a.callback.call(a.context,b)}catch(d){console&&console.error&&console.error("Error emitting UV event",d.stack)}});d.shift();0<d.length&&a(d[0])}function f(a,b){for(var d=a.length,l=0;l<d;l++)b(a[l],l)}function c(a){var b={},d;for(d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b}function e(a,b){return"string"===typeof a?a===b:a.test(b)}function b(a,b){for(var d=a.length,
l=[],c=0;c<d;c++)b(a[c])&&l.push(a[c]);return l}var d=[],l={emit:function(e,h){h=c(h||{});h.meta=h.meta||{};h.meta.type=e;d.push(h);1===d.length&&a(d[0]);l.listeners=b(l.listeners,function(a){return!a.disposed})},on:function(a,b,d){var c={type:a,callback:b,disposed:!1,context:d||window};l.listeners.push(c);var p={replay:function(){f(l.events,function(l){c.disposed||e(a,l.meta.type)&&b.call(d,l)});return p},dispose:function(){c.disposed=!0;return p}};return p},once:function(a,b,d){var c=l.on(a,function(){b.apply(d||
window,arguments);c.dispose()});return c},events:[],listeners:[]};return l}function L(){var a=F.uv;if(!a||!a.emit)return!1;if(!K){K=!0;for(var f=0;f<D.length;f++){var c=D[f];c.on?a.on.apply(a,c.on):c.emit&&a.emit.apply(a,c.emit)}a.on(/.*/,function(a){var b=a.meta.type,d=G[b];d?(d.current=a,d.history.push(a)):G[b]={current:a,history:[a]}}).replay();H=!0}return!0}(function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var f=Array.prototype.slice.call(arguments,1),c=this,e=function(){},b=function(){return c.apply(this instanceof e?this:a,f.concat(Array.prototype.slice.call(arguments)))};e.prototype=this.prototype;b.prototype=new e;return b})})();var B={__anonymous__:!0},y=null;try{y=(0,eval)("this")}catch(M){}if(!y)try{y=function(){return this}()}catch(N){}var B=y,k=B.qubit||{};B.qubit||(B.qubit=k);if(k.VERSION&&"3.3.1"!==k.VERSION)try{console.warn("There is already 'qubit.VERSION' set to: "+k.VERSION)}catch(O){}k.VERSION=
"3.3.1";try{"object"===typeof module&&(module.exports=B)}catch(P){}var x=function(){};(function(){function a(){}function f(b,d,l,c,h){b=b.split(".");var e=a.NAMESPACE_BASE||B,f=null,p=null;h&&(e=y);h=e;e=l||e;for(l=0;l<b.length-1;l+=1)p=b[l],e[p]=e[p]||{},e=e[p];f=e;p=b[b.length-1];y.TAGSDK_NS_OVERRIDE&&(c=!1);void 0!==y.TAGSDK_NS_FORCED_OVERRIDE_OPTION&&(c=!y.TAGSDK_NS_FORCED_OVERRIDE_OPTION);void 0!==d?void 0!==f[p]&&c||(f[p]=d):f[p]=f[p]||{};d&&(d.CLASSPATH=b.join("."),b.splice(b.length-1,1),d.PACKAGE_NAME=
b.join("."));return{root:h,object:f,instance:f[p]}}a.global=function(){return y};a.STANDARD_CS_NS="qubit.cs";a.clientSpaceClasspath=function(){return window.qubit.CLIENT_CONFIG?"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id:a.STANDARD_CS_NS};a.globalNamespace=function(a,d,c,e){return f(a,d,c,e,!0)};a.namespace=function(a,d,c,e){return f(a,d,c,e,!1)};a.clientNamespace=function(b,d,c,e){return a.namespace(a.clientSpaceClasspath()+"."+b,d,c,e)};a.clazz=function(b,d,c,e,h){a.namespace(b,d,e,!0);"function"===
typeof c&&(d.SUPER=c,d.superclass=c,d.prototype=new c(h),d.prototype.SUPER=c,d.prototype.CLASS=d);b=b.split(".");d.prototype?(d.prototype.CLASSPATH=b.join("."),d.prototype.CLASS_NAME=b[b.length-1],b.splice(b.length-1,1),d.prototype.PACKAGE_NAME=b.join(".")):(d.CLASSPATH=b.join("."),d.STATIC_NAME=b[b.length-1],b.splice(b.length-1,1),d.PACKAGE_NAME=b.join("."));return d};a.clazz("qubit.Define",a);a.clientClazz=function(b,d,c,e,h){return a.clazz(a.clientSpaceClasspath()+"."+b,d,c,e,h)};a.STANDARD_VS_NS=
"qubit.vs";a.vendorsSpaceClasspath=function(b){var d=k.VENDOR_SPACE_CP,d=void 0===d||null===d?a.STANDARD_VS_NS:d;return b?d?d+"."+b:b:d};var c=a.vendorsSpaceClasspath(),e;e=c?a.namespace(c,{},null,!0).instance:a.global();a.getVendorSpace=function(){return e};a.vendorNamespace=function(b,d,c,e){b=a.vendorsSpaceClasspath(b);return a.namespace(b,d,c,e)};a.vendorClazz=function(b,d,c,e,h){b=a.vendorsSpaceClasspath(b);return a.clazz(b,d,c,e,h)}})();(function(){function a(a){}for(var f={},c=0;93>c;c++)f["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=".charAt(c)]=
c;k.Define.clazz("qubit.Cookie",a);a.cookieAlphabet="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=";a.cookieAlphabetMap=f;a.decode=function(a){return unescape(a)};a.encode=function(a){return escape(a)};a.set=function(b,c,e,h,n){if(e){var f=new Date;f.setTime(f.getTime()+864E5*e);e="; expires="+f.toGMTString()}else e="";n||(b=a.encode(b),c=a.encode(c));b=b+"="+c+e+"; path=/;";h&&(b+=" domain="+h);document.cookie=b};var e,b={};a.resetCache=function(){e=
null;b={}};a.getCached=function(d,c){var m=d+"="+!!c;if(void 0!==b[m])return b[m];var h=d+"=";e||(e=document.cookie.split(";"));for(var n=0;n<e.length;n++){for(var f=e[n];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(h))return h=f.substring(h.length,f.length),c||(h=a.decode(h)),b[m]=h}return b[m]=null};a.get=function(b,c){for(var e=b+"=",h=document.cookie.split(";"),n=0;n<h.length;n++){for(var f=h[n];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(e))return e=f.substring(e.length,
f.length),c||(e=a.decode(e)),e}return null};a.getAllForName=function(b,c){if(!b)return[];for(var e=b+"=",h=document.cookie.split(";"),n=[],f=0;f<h.length;f++){for(var p=h[f];" "===p.charAt(0);)p=p.substring(1,p.length);0===p.indexOf(e)&&(p=p.substring(e.length,p.length),c&&(p=a.decode(p)),n.push(p))}return n};a.getAll=function(b){for(var c=document.cookie.split(";"),e=[],h=0;h<c.length;h++){for(var n=c[h];" "===n.charAt(0);)n=n.substring(1,n.length);var f=n.substring(0,n.indexOf("=")),n=n.substring(f.length+
1,n.length);b&&(n=a.decode(n));e.push([f,n])}return e};a.rm=function(b,c){a.set(b,"",-1,c)}})();(function(){function a(a,g){for(var b=m.length,d=0;d<b;d++)if(a===m[d][0])return m[d][1];m[m.length]=[a,g];return!1}function f(g,b,d,c,s){var e=!1,h=!1,n=!1,p=!1,t=!1,q=t=!1;b&&(e=(t=!!b.all)||b.nodes,p=t||b.win,h=t,q=!!b.emptyForMaxDeep,n=b.noFunctions&&!t,void 0!==b.noOwn&&(h=!!b.noOwn),void 0!==b.noFunctions&&(n=!!b.noFunctions),void 0!==b.win&&(p=!!b.win),void 0!==b.nodes&&(e=!!b.nodes),t=!!b.copyReference);
if(void 0===d||d)void 0!==d&&d--;else return q?void 0:g;if(!(g&&g instanceof Object))return g;if(!e){try{if(g instanceof Node)return g}catch(k){if(g instanceof ActiveXObject&&void 0!==g.nodeType)return g}if(g===document)return g}if(!p&&g===l)return g;e=g instanceof Array?[]:{};g instanceof Date&&(e=new Date(g));!n&&g instanceof Function&&(n=String(g).replace(/\s+/g,""),e=n.indexOf("{[nativecode]}")+14===n.length?function(){return g.apply(s||this,arguments)}:function(){return g.apply(this,arguments)});
void 0===c&&(m=[],c=0);if(n=a(g,e))return n;if(e instanceof Array)for(n=0;n<g.length;n++)e[e.length]=g[n]===g[n]?f(g[n],b,d,c+1,g):g[n];else{var n=0,r;for(r in g){if(h||g.hasOwnProperty(r))e[r]=g[r]===g[r]?f(g[r],b,d,c+1,g):g[r];n++}}b.proto&&(e.prototype=f(g.prototype,b,d,c+1,g));t&&(e.___copy_ref=g);return e}function c(a,g,b,d,e,s,n,m){b=b||{};void 0===b.hasOwn&&(b.hasOwn=!0);if(!b.objectsOnly||a instanceof Object)if(void 0===m||m){void 0!==m&&m--;if(!b||!b.nodes)try{if(a instanceof Node)return}catch(f){if(a instanceof
ActiveXObject&&void 0!==a.nodeType)return}if(a!==l){void 0===d&&(h=[],d=0);var p;a:{for(p=0;p<d&&p<h.length;p++)if(a===h[p]){p=!0;break a}p=!1}if(!(p||(h[d]=a,e=e||a,e&&s&&e[s]!==e[s]||g(a,e,s,n)))){s=0;p="";for(var t in a){if(!b.hasOwn||a.hasOwnProperty(t))try{var q=a[t];b.track&&(p=n?n+"."+t:t);c(q,g,b,d+1,e,t,p,m)}catch(k){}s++}}}}}var e=k.Define,b=k.Cookie,d=function(){},l=e.global();e.clazz("qubit.opentag.Utils",d);d.global=e.global;d.namespace=e.namespace;d.clazz=e.clazz;d.getObjectUsingPath=
function(a,g){g=g||l;for(var b=a.split("."),d=0;d<b.length;d++)g&&b[d]&&(g=g[b[d]]);return g};d.getParentObject=function(a){var g=a.lastIndexOf(".");a=a.substring(0,g);return d.getObjectUsingPath(a)};d.variableExists=function(a){return void 0!==a&&null!==a};d.ANON_VARS=[];d.getAnonymousAcessor=function(a){var g=d.indexInArray(a,d.ANON_VARS);-1===g&&(g=d.addToArrayIfNotExist(d.ANON_VARS,a));return"qubit.opentag.Utils.ANON_VARS["+g+"]"};d.replaceAll=function(a,g,b){return a.replace(new RegExp(g.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,
"\\$1"),"g"),b)};d.secureText=function(a){"string"!==typeof a&&(a+="");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")};d.getUrl=function(){return document.location.href};d.getQueryParam=function(a){var g,b,c,e;g=d.getUrl();if(0<g.indexOf("?"))for(e=g.substring(g.indexOf("?")+1).split("&"),g=0,b=e.length;g<b;g+=1)if(c=e[g],0<c.indexOf("=")&&(c=c.split("="),2===c.length&&c[0]===a))return c[1];return null};d.getElementValue=function(a){return(a=document.getElementById(a))?a.textContent||a.innerText:
null};var m=[];d.objectCopy=function(a,g){g=g||{};var b=f(a,g,g.maxDeep);m=[];return b};var h=[];d.traverse=function(a,g,b){c(a,g,b,void 0,void 0,void 0,void 0,b.maxDeep)};d.prepareQuotedString=function(a){return"string"===typeof a?'"'+a.replace(/\"/g,'\\"')+'"':a};d.expressionToFunction=function(a,g){return d.gevalAndReturn("function ("+(g||"")+") {"+a+"}").result};d.defineWrappedClass=function(a,g,b,d,c){var s=function(){return c?c.apply(this,arguments):g.apply(this,arguments)};e.clazz(a,s,g,d);
for(var h in b)b.hasOwnProperty(h)&&"CONSTRUCTOR"!==h&&(s.prototype[h]=b[h]);return s};d.copyAandAddFromB=function(a,g,b){a=this.objectCopy(a,{maxDeep:b||8});for(var d in g)g.hasOwnProperty(d)&&(a[d]=g[d]);return a};d.keys=function(a){if(a instanceof Object){if(Object.keys)return Object.keys(a);var g=[],b;for(b in a)a.hasOwnProperty(b)&&(g[g.length]=b);return g}throw"keys() called on non-object!";};d.getSrcElement=function(a){var g;a=a||window.event;a.srcElement?g=a.srcElement:a.target&&(g=a.target);
return g};d.addToArrayIfNotExist=function(a,g,b){for(var d=0,c=!1;d<a.length;d+=1)if(b&&b(a[d],g)||a[d]===g){c=!0;break}c||(a[a.length]=g,d=-1);return d};d.indexInArray=function(a,g){for(var b=0;b<a.length;b++)if(a[b]===g)return b;return-1};d.existsInArray=function(a,g){for(var b=0;b<a.length;b++)if(a[b]===g)return!0;return!1};d.removeFromArray=function(a,g){for(var b=0,d=0;b<a.length;)a[b]===g?(a.splice(b,1),d++):b++;return d};d.addClass=function(a,g){var b;try{a.classList.add(g)}catch(c){null===
a.className?a.className=g:(b=a.className.split(" "),d.addToArrayIfNotExist(b,g),a.className=b.join(" "))}};d.removeClass=function(a,g){var b;try{a.classList.remove(g)}catch(c){null===a.className?a.className="":(b=a.className.split(" "),d.removeFromArray(b,g),a.className=b.join(" "))}};d.gevalAndReturn=function(a){var g=y;g.qubitopentagutilsgevalandreturn__var_test__=void 0;g.qubitopentagutilsgevalandreturn__var_test__error=void 0;d.geval("try{this.qubitopentagutilsgevalandreturn__var_test__=("+a+
");}catch(ex){this.qubitopentagutilsgevalandreturn__var_test__error = ex;}");a=g.qubitopentagutilsgevalandreturn__var_test__;var b=g.qubitopentagutilsgevalandreturn__var_test__error;try{g.qubitopentagutilsgevalandreturn__var_test__=void 0,g.qubitopentagutilsgevalandreturn__var_test__error=void 0,delete g.qubitopentagutilsgevalandreturn__var_test__,delete g.qubitopentagutilsgevalandreturn__var_test__error}catch(c){}return{result:a,error:b}};d.trim=function(a){try{return String(a).trim()}catch(g){return String(a).replace(/^\s+|\s+$/g,
"")}};d.setIfUnset=function(a,g){if(a&&g)for(var b in g)g.hasOwnProperty(b)&&!a.hasOwnProperty(b)&&(a[b]=g[b])};var n=Math.floor(1E12*Math.random());d.UUID=function(){l.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__||(l.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__=(new Date).valueOf());return n+"."+ ++l.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__};d.overrideFromLeftToRight=function(a,g){if(a&&g)for(var b in g)g.hasOwnProperty(b)&&(a[b]=g[b]);return a};d.geval=function(a){return window&&window.execScript?window.execScript(""===
a?" ":a):l.eval.call(l,a)};var q=[];d.bodyAvailable=function(a){if(document.body){if(q){for(var g=0;g<q.length;g++)try{q[g]()}catch(b){}q=!1}a()}else q.push(a)};d.rmCookiesMatching=function(a){for(var g=b.getAll(),d=0;d<g.length;d++){var c=g[d][0];0===c.match(a)&&b.rm(c)}};var p=[],t=!1,g=!1;d.bodyReady=function(a){if(g)return a&&a(),!0;if(t=t||!(!document.body||"complete"!==document.readyState)){g=!0;for(var b=0;b<p.length;b++)try{p[b]()}catch(d){}a&&a()}else a&&p.push(a);return t};var s=l.onload;
l.onload=function(a){try{d.bodyReady()}catch(g){try{window.qubit.opentag.Utils.bodyReady()}catch(b){}}var c=!1;try{c=s}catch(e){}c&&c(a)};(function(){var a,g=!1,b=1,c,e,s,h;e=function(a){!0===a&&(b-=1);if(!b||!0!==a&&!g){if(!document.body)return setTimeout(e,1);g=!0;if(!0!==a&&(b-=1,0<b))return;for(;0<c.length;)a=c.shift(),a()}};h=function(){if(!g){try{document.documentElement.doScroll("left")}catch(a){setTimeout(h,1);return}e()}};s=function(){if(!c){c=[];if("complete"===document.readyState)return setTimeout(e,
1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",e,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",a);window.attachEvent("onload",e);var g=!1;try{g=null===window.frameElement||void 0===window.frameElement}catch(b){}document.documentElement.doScroll&&g&&h()}}};document.addEventListener?a=function(){document.removeEventListener("DOMContentLoaded",a,!1);e()}:document.attachEvent&&(a=function(){"complete"===document.readyState&&
(document.detachEvent("onreadystatechange",a),e())});(function(a){s();g?setTimeout(a,1):c.push(a)})(function(){t=!0;d.bodyReady()})})()})();(function(){function a(b,g,d){this.collectLogs=!!a.isCollecting();this.collectLocally=d;this.collection=[];this.getPrefix=function(){var a="";g&&("function"===typeof g?a=g(this.ref):g.CLASS_NAME?a=g.CLASS_NAME:g.constructor&&g.constructor.name&&(a=g.constructor.name),a&&(a+=" -> "));return(b||"")+a}}function f(d,g,c,e,h,l,n,m){var f=b>=m;if(0<=a.getCollectLevel()||
f)g=h?[e,n,c]:[g+d.getPrefix()+e,l,c],g[3]=m,d.collect(g,m),f&&d.printMessage.apply(d,g)}var c=k.Define,e=null;c.clazz("qubit.opentag.Log",a);a.LEVEL_FINEST=4;a.LEVEL_FINE=3;a.LEVEL_INFO=2;a.LEVEL_WARN=1;a.LEVEL_ERROR=0;a.LEVEL_NONE=-1;a.MAX_LOG_LEN=1E4;a.prototype.MAX_LOG_LEN=-1;var b=a.LEVEL_NONE,d=a.LEVEL_NONE,l=!0;a.setLevelFromCookie=function(){var b=k.Cookie.get("qubit.opentag.Log.LEVEL");if(b&&(b=+b,!isNaN(b)&&0<b)){var g=a.LEVEL_FINE;a.setCollectLevel(b>g?b:g);a.setLevel(+b)}};a.setCollecting=
function(a){l=!!a};a.isCollecting=function(){return l||a.COLLECT};a.setLevel=function(a){b=+a};a.setCollectAndLevel=function(b){a.setLevel(b);a.setCollectLevel(b)};a.getLevel=function(){return b};a.setCollectLevel=function(a){d=+a};a.getCollectLevel=function(){return d};var m=[];a.logsCollection=m;a.rePrintAll=function(d,g,c,h){var l=b;void 0!==d&&(b=d);try{if(a.isCollecting()){try{c||e.clear()}catch(n){}var m=h||a.logsCollection,f=0;for(c=0;c<m.length;c++)(function(c){var e=m[c];c=e[3];void 0!==
c&&b>=c&&(f++,g?k.opentag.Timed.setTimeout(function(){void 0!==d&&(b=d);try{a.print.apply(a,e)}finally{b=l}},f*g):a.print.apply(a,e))})(c)}}catch(p){}finally{b=l}};var h=c.global(),n=!!(h.webkitMediaStream||h.webkitURL||h.mozContact);a.isStyleSupported=function(){return n};var q={};a.setConsole=function(a){return e=a||q};a.delayPrint=-1;var p=(new Date).valueOf();a.prototype.printMessage=function(b,g,d,c){if(0<a.delayPrint){var e=a.delayPrint,h=p-(new Date).valueOf();0<h&&(e+=h);try{k.opentag.Timed.setTimeout(function(){this.print(b,
g,d,c)}.bind(this),e)}catch(l){setTimeout(function(){this.print(b,g,d,c)}.bind(this),e)}p=(new Date).valueOf()+e}else this.print(b,g,d,c)};a.prototype.print=function(b,g,d,c){a.print(b,g,d,c)};a.print=function(d,g,c,h){if(!(void 0!==h&&b<h))try{if(e&&e.log)if(g&&a.isStyleSupported())if(c&&e[c])e[c]("%c"+d,g);else e.log("%c"+d,g);else if(c&&e[c])e[c](d);else e.log(d)}catch(l){}};a.prototype.collect=function(b,g){void 0===g&&(g=a.getCollectLevel());var d=!1,c=this.collectLogs&&a.isCollecting()&&a.getCollectLevel()>=
+g;c&&(m.push(b),d=!0);this.collectLocally&&c&&(this.collection.push(b),d=!0);0<a.MAX_LOG_LEN&&m.length>a.MAX_LOG_LEN&&m.splice(0,m.length-a.MAX_LOG_LEN);if(0<a.MAX_LOG_LEN||0<this.MAX_LOG_LEN)c=a.MAX_LOG_LEN,0<this.MAX_LOG_LEN&&(c=this.MAX_LOG_LEN),this.collection.length>c&&this.collection.splice(0,this.collection.length-c);return d?b:null};a.clearAllLogs=function(){try{e.clear()}catch(a){}finally{m.splice(0,m.length)}};a.getCollectedByLevel=function(a,g){g=g||m;for(var b=[],d=0;d<g.length;d++){var c=
g[d];c[0][4]===a&&b.push(c)}return b};a.prototype.rePrint=function(b,g,d){a.rePrintAll(b,g,!d,this.collection)};a.prototype.FINEST=function(b,g){f(this,"FINEST: ",!1,b,g,"color:#CCCCCC;",!1,a.LEVEL_FINEST)};a.prototype.FINE=function(b,g){f(this,"FINE: ",!1,b,g,"color:#999999;",!1,a.LEVEL_FINE)};a.prototype.INFO=function(b,g,d){f(this,"INFO: ","info",b,g,d,d,a.LEVEL_INFO)};a.prototype.WARN=function(b,g){f(this,"WARN: ","warn",b,g,"color:#26A110;",!1,a.LEVEL_WARN)};a.prototype.ERROR=function(b,g){f(this,
"ERROR: ","error",b,g,"color:red;",!1,a.LEVEL_ERROR)};a.setConsole(c.global().console);a.setLevelFromCookie()})();(function(){function a(a){a&&(this._rate=a.rate||10,this._smallestRate=-1,a.start&&this.startPooling(),this.config=a);this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}k.Define.clazz("qubit.opentag.Timer",a);a.prototype.timers=[];a.prototype.startPooling=function(a){a&&this.config.dynamic&&(0>this._smallestRate||this._smallestRate>a)&&(this._smallestRate=Math.min(Math.floor(a/
2),1500));this.started||(this.started=!0,setTimeout(this._binded_pool,0))};a.prototype._pool=function(){this.maxFrequent(function(){},5E3,this._lck_obj);this.callTimers();0!==this.timers.length?setTimeout(this._binded_pool,this._smallestRate>this._rate?this._smallestRate:this._rate):(this.started=!1,this._smallestRate=-1)};a.prototype.callTimers=function(){this.lastCalled=(new Date).valueOf();for(var a=0;a<this.timers.length;a++){var e=this.timers[a];if((new Date).valueOf()>=e.time){try{e.execute()}catch(b){}this.timers.splice(a,
1);--a}}};a.prototype.cancellAll=function(){this.timers=[]};a.prototype.setRate=function(a){this._rate=a};a.prototype.maxFrequent=function(a,e,b){b||(a.__maxFrequent__timer_opentag_qubit_=a.__maxFrequent__timer_opentag_qubit_||{},b=a.__maxFrequent__timer_opentag_qubit_);var d=b.____last__timed__max__frequent____;if(!d||(new Date).valueOf()-d>e)d=(new Date).valueOf(),b.____last__timed__max__frequent____=d,a()};a.prototype.runIfNotScheduled=function(a,e,b){b=b||a;if(b.__lastRun__&&(new Date).valueOf()<
e+b.__lastRun__)return this.schedule(a,e,b);b.__lastRun__=(new Date).valueOf();a();return!0};a.prototype.schedule=function(a,e,b){if(b.___scheduled___)return!1;b.___scheduled___=(new Date).valueOf();this.setTimeout(function(){b.___scheduled___=!1;b.__lastRun__=(new Date).valueOf();a()},e);return!0};var f=1;a.prototype.setTimeout=function(a,e){var b={id:f++,time:(new Date).valueOf()+ +e,execute:a};this.timers.push(b);this.startPooling(e);return b};a.prototype.setInterval=function(a,e){var b=setInterval(a,
e);this.inervals.push(b);return b}})();(function(){k.Define.namespace("qubit.opentag.Timed",new k.opentag.Timer({rate:37,dynamic:!0}));var a=k.opentag.Timed;a.tillTrue=function(f,c,e){var b=function(){f()?c():a.setTimeout(b,e||33)};b()}})();var r;r=r||{};r.fileLoader={};r.fileLoader.load=function(a,f,c,e,b,d){var l,m,h,n;n=!1;h=function(b){return function(){n||(n=!0,b&&!m&&(m={url:document.location.href}),c(a,m,b))}};try{f&&(l=f(a))}catch(q){l=!1,c(a,"Exception loading pre",!0)}finally{!1!==l&&(f=
r.fileLoader.createScriptEl(a,b,!1,d),c&&(f.onload=h(!1),f.onerror=h(!0),f.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||setTimeout(function(){h(!1)()},1)}),e||(e=window.document.getElementsByTagName("head")[0]),e.appendChild(f))}};r.fileLoader.createScriptEl=function(a,f,c,e){var b,d=document.createElement("script");d.type="text/javascript";d.src=r.fileLoader.tidyUrl(a)+(c?"?"+(new Date).getTime():"");!1!==f?(d.async="true",d.defer="true"):(d.async="false",
!1!==d.async&&(d.async=!1),d.defer="false",!1!==d.defer&&(d.defer=!1));for(b in e)e.hasOwnProperty(b)&&d.setAttribute(b,e[b]);return d};r.fileLoader.tidyUrl=function(a){return"http:"===a.substring(0,5)||"https:"===a.substring(0,6)?a:"//"+a};(function(){function a(a){this.calls={}}var f=k.Define,c=k.opentag.Utils;a.prototype.on=function(a,b){this.calls[a]||(this.calls[a]=[]);return c.addToArrayIfNotExist(this.calls[a],b)};a.prototype.call=function(a,b){var d=this.calls[a];if(d)for(var c=0;c<d.length;c++)try{d[c](b)}catch(m){}};
a.prototype.remove=function(a,b){return this.calls[a]?c.removeFromArray(this.calls[a],b):null};a.prototype.removeAll=function(a){var b=0,d;for(d in this.calls)this.calls.hasOwnProperty(d)&&(b+=c.removeFromArray(this.calls[d],a));return b};a.prototype.clear=function(){this.calls={}};f.clazz("qubit.Events",a)})();(function(){function a(a){this.log=new k.opentag.Log("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.config={order:0,include:!0,name:"Filter-"+
c++,script:void 0,session:void 0,restartable:!0};this.runtimeId=f.UUID();this.session=null;if(a){for(var d in a)a.hasOwnProperty(d)&&(this.config[d]=a[d]);a.session&&this.setSession(a.session);this.register(this)}this.events=new k.Events({})}var f=k.opentag.Utils,c=0,e=[];k.Define.clazz("qubit.opentag.filter.BaseFilter",a);a.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};a.prototype.EVENT_TYPES={RESTART_EVENT:"restart"};a.prototype.prepareForRestart=function(){this.config.restartable&&(this.events.call("restart",
this),this.reset())};a.prototype.onRestart=function(a){this.events.on("restart",a)};a.prototype.reset=function(){this.runtimeId=f.UUID();this.enable()};a.prototype.disable=function(){this.config.disabled=!0};a.prototype.enable=function(){this.config.disabled=!1};a.prototype.match=function(){return!0};a.prototype.setSession=function(a){this.session=a};a.prototype.getSession=function(){return this.session};a.prototype.getState=function(){var b=a.state.PASS;if(this.config.disabled)return a.state.DISABLED;
this.config.script&&(b=this.config.script.call(this,b));isNaN(+b)&&(b=a.state.FAIL);this.lastState=+b;return b};a.getFilters=function(){return e};a.prototype.register=function(){a.register(this)};a.register=function(a){f.addToArrayIfNotExist(e,a)}})();k.Define.namespace("qubit.opentag.filter.pattern.PatternType",{CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"});(function(){function a(e){this._lockObject=
{};var b={patternType:c.CONTAINS,pattern:""};if(e)for(var d in e)e.hasOwnProperty(d)&&(b[d]=e[d]);a.SUPER.call(this,b)}var f=k.opentag.Utils,c=k.opentag.filter.pattern.PatternType;k.Define.clazz("qubit.opentag.filter.URLFilter",a,k.opentag.filter.BaseFilter);a.prototype.PATTERNS=c;a.prototype.getURL=function(a){return a||f.getUrl()};a.prototype.match=function(a){a=this.getURL(a);var b=!0,d=this.config.pattern;switch(this.config.patternType){case c.CONTAINS:b=0<=a.toLowerCase().indexOf(d.toLowerCase());
break;case c.MATCHES_EXACTLY:b=a.toLowerCase()===this.config.pattern.toLowerCase();break;case c.STARTS_WITH:b=0===a.toLowerCase().indexOf(d.toLowerCase());break;case c.ENDS_WITH:b=a.lastIndexOf(d.toLowerCase())+d.length===a.length;break;case c.REGULAR_EXPRESSION:b=(new RegExp(d)).test(a);break;case c.ALL_URLS:b=!0}return b}})();(function(){function a(b){var d={};if(b){for(var c in b)b.hasOwnProperty(c)&&("customStarter"===c&&b[c]?this.customStarter=b[c]:"customScript"===c&&b[c]&&(this.customScript=
b[c]),d[c]=b[c]);this.uid="f"+e++}this.tagsToRun=[];a.SUPER.call(this,d)}var f=k.opentag.filter.BaseFilter,c=k.opentag.Utils,e=0;k.Define.clazz("qubit.opentag.filter.Filter",a,k.opentag.filter.URLFilter);a.prototype.customStarter=function(a,d,c){d(!1)};a.prototype.isSession=function(){return this.config.sessionDisabled||null===this.customStarter&&null===this.customScript?!1:!0};a.prototype.customScript=function(a){return!0};a.prototype.match=function(b){var d=!0;try{this.customScript&&(void 0===this._matchState&&
(this._matchState=!!this.customScript(this.getSession())),d=this._matchState)}catch(c){d=!1}return d&&a.SUPER.prototype.match.call(this,b)};a.prototype.runTag=function(b){c.addToArrayIfNotExist(this.tagsToRun,b);if(this.starterExecuted)this._triggerTag(b);else if(!this._starterWasRun){this._starterWasRun=!0;var d=this.runtimeId,e=function(a){d===this.runtimeId&&(this.reRun=a,this.starterExecuted=(new Date).valueOf(),this._processQueuedTagsToRun())}.bind(this);this.customStarter?this.customStarter(this.getSession(),
e,b):a.prototype.customStarter.call(this,this.getSession(),e,b)}};a.prototype._processQueuedTagsToRun=function(){for(var a=0;a<this.tagsToRun.length;a++)this._triggerTag(this.tagsToRun[a])};a.prototype._triggerTag=function(a){!0===this.reRun?a.run():a.runOnce()};a.prototype.getState=function(b){b&&this.setSession(b);b=a.SUPER.prototype.getState.call(this);if(b===f.state.DISABLED)return f.state.DISABLED;b===f.state.PASS&&this.isSession()&&(b=f.state.SESSION);this.config.script&&(b=this.config.script.call(this,
b,this.getSession()));return this.lastState=b};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);this.starterExecuted=this._starterWasRun=this._matchState=void 0;this.tagsToRun=[];this.reRun=void 0}})();r.GlobalEval={};r.GlobalEval.globalEval=function(a){window.execScript?window.execScript(""===a?" ":a):window.eval.call(window,a)};r.HtmlInjector={};r.HtmlInjector.inject=function(a,f,c,e,b){var d,l,m,h;if(0<=c.toLowerCase().indexOf("<script")){b=document.createElement("div");b.innerHTML=
"a"+c;l=b.getElementsByTagName("script");m=[];c=0;for(d=l.length;c<d;c+=1)m.push(l[c]);h=[];c=0;for(d=m.length;c<d;c+=1){l=m[c];var n={attributes:r.HtmlInjector.getAttributes(l)};l.src?n.src=l.src:n.script=l.innerHTML;h.push(n);l.parentNode.removeChild(l)}b.innerHTML&&0<b.innerHTML.length&&(b.innerHTML=b.innerHTML.substring(1));r.HtmlInjector.doInject(a,f,b);r.HtmlInjector.loadScripts(h,0,e,a)}else b=document.createElement("div"),b.innerHTML=c,r.HtmlInjector.doInject(a,f,b),e&&e()};r.HtmlInjector.doInject=
function(a,f,c){if(0<c.childNodes.length){for(var e=document.createDocumentFragment();0<c.childNodes.length;)e.appendChild(c.removeChild(c.childNodes[0]));f?r.HtmlInjector.injectAtStart(a,e):r.HtmlInjector.injectAtEnd(a,e)}};r.HtmlInjector.injectAtStart=function(a,f){0===a.childNodes.length?a.appendChild(f):a.insertBefore(f,a.childNodes[0])};r.HtmlInjector.injectAtEnd=function(a,f,c){c||(c=1);a===document.body&&"complete"!==document.readyState&&50>c?setTimeout(function(){r.HtmlInjector.injectAtEnd(a,
f,c+1)},100):a.appendChild(f)};r.HtmlInjector.loadScripts=function(a,f,c,e){var b,d,l=!1;for(b=a.length;f<b;f+=1)if(d=a[f],d.src){l=!0;break}else r.GlobalEval.globalEval(d.script);l&&r.fileLoader.load(d.src,null,function(){r.HtmlInjector.loadScripts(a,f+1,c,e)},e,!1,d.attributes);c&&f===b&&c()};r.HtmlInjector.getAttributes=function(a){var f,c,e,b,d={};if(a){c=a.attributes;f=c.length;for(a=0;a<f;a++)e=c[a].value,b=c[a].name.toLowerCase(),""===e||"id"!==b&&"class"!==b&&"charset"!==b&&"data-"!==b.substr(0,
5)||(d[b]=e);return d}};(function(){function a(){q=q||{write:document.write,writeln:document.writeln}}function f(){document.write=q.write;document.writeln=q.writeln;q=null}var c=k.opentag.filter.BaseFilter,e=k.opentag.Utils,b=r.HtmlInjector,d=r.fileLoader,l=k.opentag.filter.Filter,m=function(){};k.Define.clazz("qubit.opentag.TagsUtils",m);var h=!1;m.bodyLoaded=function(){return h?!0:h=!(!document.body||"loading"===document.readyState)};m.bodyAvailable=function(a){return!!document.body};var n={};m.loadScript=
function(a){var g=a.url,b=function(b,d,c){n[g].error=d;c?(n[g].state="failure",a.onerror()):(n[g].state="success",a.onsuccess())};if(n[g]){if(a.noMultipleLoad)return b(g,n[g].error,"failure"===n[g].state);n[g].count+=1}else n[g]={count:1,state:null};var c=!a.async,e=m.bodyLoaded();c&&!e?m.writeScriptURL(g,function(a,d){b(g,d,!a)}):d.load(g,!1,b,a.node,a.async)};var q=null;m.redirectDocumentWritesToArray=function(g,b){a();document.write=function(a){g.push(a)};document.writeln=function(a){g.push(a)}};
m.flushDocWritesArray=function(a,g,b,d,c){if(g&&a){a=a.splice(0,a.length);try{return m.injectHTML(g,b,a.join("\n"),c||x),!0}catch(e){}}else return!1;c&&c();return!0};m.unlockDocumentWrites=function(){q&&f()};var p=m.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks",t={};k.Define.namespace(p,t,y,!0);var g=0,s=(new Date).valueOf();m.writeScriptURL=function(b,c){var h="_"+s+"_"+g++,v=p+"."+h,l=!1;t[h]=function(a){l||(l=!0,a?c(!1,"error while loading script "+b):c(!0),t[h]=void 0,delete m.writeScriptURL.callbacks[h])};
var n='if(this.readyState === "loaded" || this.readyState === "complete"){ try {'+v+"(true)} catch (ex) {}}",w="try{"+v+"(false)}catch(ex){}",v="try{"+v+"(true)}catch(ex){}";b=d.tidyUrl(b);n="<script onload='"+w+"'  onerror='"+v+"' onreadystatechange='"+n+"' type='text/javascript'  src='"+b+"'>\x3c/script>";q?(f(),document.write(n),a()):document.write(n);e.bodyReady(function(){l||(l=!0,c(!0))})};m.writeScriptURL.callbacks={};var v=c.state.SESSION,w=c.state.PASS,u=c.state.FAIL;m.filtersState=function(a,
g,b,d){a=a.sort(function(a,g){try{var b=g.config.order,d=a.config.order;isNaN(-d)&&(d=0);isNaN(-b)&&(b=0);return b-d}catch(c){return 0}});var e=w;if(!a||0===a.length)return e;for(var e=null,h=!1,s=!1,n=0,m,f,p=[],q,k,t=0;t<a.length;t++)if(q=a[t],q.setSession(g),q.match())if(m=q.getState(),0<m){if(0===n||n>m)n=m}else m===c.state.DISABLED?h=!0:m===v?(s=!0,f=e=q,p.push(q)):e=q;else k=q;a=!1;null===e?(a=!0,e=h?w:u):e=e.config.include?m:m===w?u:w;0<n&&(e===w||a)&&(e=n);if(e===v||e===w&&s){if(!f.config.include)return u;
e=v;if(f instanceof l&&f.isSession()&&d)for(d=0;d<p.length;d++)try{p[d].runTag(b)}catch(r){}}b.config.dedupe&&e===w&&k&&k instanceof l&&k.isSession()&&(b.sendDedupePing=!0,e=u);return e};m.injectHTML=function(a,g,d,c){return b.inject(a,g?0:1,d,c||x)};m.getHTMLLocationForTag=function(a){a=a.prepareLocationObject(a.config.locationObject);switch(a){case "HEAD":a=document.getElementsByTagName("head")[0];break;case "BODY":a=document.body;break;default:a=a?document.getElementById(a):document.body}return a}})();
(function(){function a(d){this.config={};this.handlers=[];this.parameters=null;this.callHandlersOnRead=!1;if(d){this.uniqueId="BV"+b++;a.ALL_VARIABLES[this.uniqueId]=this;for(var c in d)d.hasOwnProperty(c)&&(this.config[c]=d[c],"value"===c&&(this.value=d.value));return a.register(this)}}function f(){if(l)return!1;for(var b=0;b<d.length;b++)try{d[b].getValue()}catch(c){}e.setTimeout(f,a.CHECK_POLL_RATE);return!0}var c=k.opentag.Utils,e=k.opentag.Timed,b=0;k.Define.clazz("qubit.opentag.pagevariable.BaseVariable",
a);a.ALL_VARIABLES={};var d=[];a.OBSERVED_VARIABLES=d;a.pageVariables=[];a.register=function(b){if(b instanceof a){for(var d=0;d<a.pageVariables.length;d++){var c=a.pageVariables[d];if(b===c)return c}a.pageVariables.push(b);return b}return null};a.prototype.getValue=function(){this._updateCurrentValue(this.value);return this.currentValue};a.prototype._updateCurrentValue=function(a){return this.valuesAreEqual(a,this.currentValue)?!1:(this.oldValue=this.currentValue,this.currentValue=a,l&&!this.callHandlersOnRead||
this._handleValueChanged(),!0)};a.prototype.getDefaultValue=function(){return this.defaultValue};a.prototype.setDefaultValue=function(a){this.defaultValue=a};a.prototype.exists=function(a){var b=c.variableExists(this.getValue());a&&(b=b||c.variableExists(this.getDefaultValue()));return b};a.prototype.getRelativeValue=function(a,b){var d=this.getValue();c.variableExists(d)||(d=b);var e;a&&!c.variableExists(d)&&(e=this.getDefaultValue(),c.variableExists(e)&&(d=e));return d};a.prototype.replaceToken=
function(a,b,d,e){var l=this.exists();d=l?this.getValue():d;a="\\$\\{"+a+"\\}";return e||d instanceof Array?(e=l?this.getValueAccessorString():c.getAnonymousAcessor(d),b.replace(new RegExp(a,"g"),e)):b.replace(new RegExp(a,"g"),d)};a.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};a.prototype.getValueAccessorString=function(){return this.getAccessorString()+".getValue()"};a.prototype.onValueChanged=function(a,b){c.addToArrayIfNotExist(this.handlers,
a);!1!==b&&this.startObservingForChanges()};a.prototype.deatchOnValueChanged=function(a){c.removeFromArray(this.handlers,a)};a.prototype._handleValueChanged=function(){for(var a={oldValue:this.oldValue,newValue:this.currentValue,variable:this},b=0;b<this.handlers.length;b++)try{this.handlers[b](a)}catch(d){}};var l=!0;a.CHECK_POLL_RATE=333;a.prototype.startObservingForChanges=function(){this.addToObservedVariables();l&&(l=!1,f())};a.prototype.stopObservingForChanges=function(){this.removeFromObservedVariables();
0===d.length&&(l=!0)};a.prototype.addToObservedVariables=function(){c.addToArrayIfNotExist(d,this)};a.prototype.removeFromObservedVariables=function(){c.removeFromArray(d,this)};a.prototype.getObservedVariables=function(){return d};a.prototype.valuesAreEqual=function(a,b){return a===b}})();(function(){function a(c){this._lockExprObject={};a.SUPER.apply(this,arguments)}var f=k.opentag.Utils;k.Define.clazz("qubit.opentag.pagevariable.Expression",a,k.opentag.pagevariable.BaseVariable);a.prototype.getValue=
function(){var c,e,b=this.value;try{if(b&&-1===b.indexOf("[#]")){var d=f.gevalAndReturn(b);c=d.result;this.failMessage=null;e=d.error}else c=a.parseUVArray(b)}catch(l){e=l}e&&(c="could not read value of expression: \n"+b+"\nexact cause: "+e,this.failMessage!==c&&(this.failMessage=c),c=null);this._updateCurrentValue(c);return c};a.parseUVArray=function(a){var e=a.split("[#]");a=f.gevalAndReturn(e[0]).result;var b=[],e=e[1];0===e.indexOf(".")&&(e=e.replace(".",""));for(var d=0;d<a.length;d++){var l=
f.getObjectUsingPath(e,a[d]);b.push(l)}return b};a.prototype.replaceToken=function(c,e,b,d){this.getValue()instanceof Array&&(d=!0);return a.SUPER.prototype.replaceToken.call(this,c,e,b,d)}})();(function(){function a(c){a.SUPER.apply(this,arguments)}var f=k.opentag.Utils;k.Define.clazz("qubit.opentag.pagevariable.DOMText",a,k.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=f.getElementValue(this.value);this._updateCurrentValue(a);return a}})();(function(){function a(f){a.SUPER.apply(this,
arguments);this._lockObject={}}k.Define.clazz("qubit.opentag.pagevariable.Cookie",a,k.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=k.Cookie.get(this.value);this._updateCurrentValue(a);return a}})();(function(){function a(c){a.SUPER.apply(this,arguments)}var f=k.opentag.Utils;k.Define.clazz("qubit.opentag.pagevariable.URLQuery",a,k.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=f.getQueryParam(this.value);this._updateCurrentValue(a);return a}})();
(function(){function a(f){a.SUPER.apply(this,arguments)}k.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",a,k.opentag.pagevariable.Expression)})();var C=!1;try{"object"===typeof module&&module.exports&&(module.exports=J,C=!0)}catch(Q){}!C&&window&&(window.uv=J());var G={},D=[],K=!1,H=!1,F=k.Define.global(),C={allEventsByType:G,subscribe:function(a,f){if(H)F.uv.on(a,f);else D.push({on:[a,f]})},getEventHistory:function(a){return this.allEventsByType[a]},publish:function(a,f){H?F.uv.emit(a,
f):D.push({emit:[a,f]})},connect:function(){L()}};C.connect();k.Define.namespace("qubit.qprotocol.PubSub",C);(function(){function a(c){a.SUPER.apply(this,arguments)}var f=k.qprotocol.PubSub,c=k.opentag.Utils;k.Define.clazz("qubit.opentag.pagevariable.QProtocolVariable",a,k.opentag.pagevariable.BaseVariable);a.prototype.init=function(){if(this.initialized)return!1;this.initialized=(new Date).valueOf();this.callHandlersOnRead=!0;if(!this.handlerAttached){var a=this,b=this.getValueAndPath(this.value);
this.eventName=b[0];this.objectPath=b[1];this.updateValue();f.subscribe(this.eventName,function(b){a.updateValue(b)});this.handlerAttached=(new Date).valueOf()}};a.prototype.getValueAndPath=function(a){var b=a,d;if(b){var c=a.indexOf(":");-1!==c&&(b=a.substring(0,c),d=a.substring(c+1))}return[b,d]};a.prototype.getValue=function(){this.init();return this.currentValue};a.prototype.getEventsHistory=function(){return f.getEventHistory(this.eventName)};a.prototype.updateValue=function(a){if(!a){var b=
this.getEventsHistory();b&&(a=b.current)}b=this.objectPath;a=a&&b?c.getObjectUsingPath(b,a):a;this._updateCurrentValue(a);return a};a.prototype.startObservingForChanges=function(){};a.prototype.stopObservingForChanges=function(){}})();(function(){function a(){}function f(a,b){var d=[];try{var c=a.parameters;if(c)for(var g=0;g<c.length;g++)a.getVariableForParameter(c[g])===b&&d.push(c[g])}catch(e){}return d}var c=k.opentag.Utils,e=k.opentag.TagsUtils,b=k.opentag.pagevariable.BaseVariable,d=k.opentag.pagevariable.Expression,
l=k.opentag.pagevariable.DOMText,m=k.opentag.pagevariable.Cookie,h=k.opentag.pagevariable.URLQuery;k.Define.clazz("qubit.opentag.TagHelper",a);a.injectHTMLForLoader=function(a,b,d,c){if(c=void 0!==c?c:a.getHtml()){var g="END"===a.config.locationPlaceHolder,h=e.getHTMLLocationForTag(a);a.injectHTMLNotFinished=!0;try{h?e.injectHTML(h,g,c,function(){a.injectHTMLNotFinished=!1;if(b)try{b()}catch(g){}}.bind(a)):d&&"loading"===document.readyState?(document.write(c),a.injectHTMLNotFinished=!1):a.injectHTMLFailed=
(new Date).valueOf()}catch(v){a.injectHTMLNotFinished=!1,a.injectHTMLFailed=(new Date).valueOf()}}};a.getAllVariablesWithParameters=function(a){for(var b=a.getPageVariables(),d=[],c=0;c<b.length;c++)for(var g=b[c],e=f(a,g),h=0;h<e.length;h++)d.push({parameter:e[h],variable:g});return d};a.allParameterVariablesReadyForTag=function(a,b){for(var d=!0,c=a.getPageVariables(),g=0;g<c.length;g++){var e=c[g];try{var h=f(a,e),l=e.exists();!l&&b&&(0<h.length&&(l=!!h[0].defaultValue),l=l||e.exists(!0));if(!l){d=
!1;break}}catch(m){d=!1;break}}return d};a.validateAndGetVariableForParameter=function(b){b.hasOwnProperty("variable")&&b.variable&&(b.variable=a.initPageVariable(b.variable));return b.variable};a.initPageVariable=function(a){if(!a||a instanceof b)return a;if("string"===typeof a){var e=c.getObjectUsingPath(a);if(e&&e instanceof b)return e}switch(a.type){case "2":return new d(a);case "3":return new h(a);case "4":return new m(a);case "5":return new l(a);case "EPRESSION":return new d(a);case "URL_PARAMETER":return new h(a);
case "COOKIE_VALUE":return new m(a);case "DOM_VALUE":return new l(a);default:return new b(a)}}})();(function(){function a(a){this.log=new m("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.runCounter=this.urlsFailed=this.urlsLoaded=0;this.events=new k.Events({});this._depLoadedHandler=function(){this.dependenciesLoaded()&&this.awaitingDependencies&&this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+l++,async:!0,usesDocumentWrite:!1,
timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,locationPlaceHolder:"END",locationObject:null,dontWaitForInjectionLocation:!1,noMultipleLoad:!1,loadDependenciesOnLoad:!1,restartable:!0};this.restartCounter=0;this.cancelled=!1;this.runtimeId=c.UUID();this.delayDocWrite=!1;this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=[];if(a){if(!a.name){var b="Tag-"+l++;this.config.name=b}this.addState("INITIAL");for(var d in a)this.config[d]=
a[d];a.genericDependencies&&(this.genericDependencies=this.genericDependencies.concat(a.genericDependencies));a.dependencies&&(this.dependencies=a.dependencies.concat(this.dependencies));a.PACKAGE&&(this._package=a.PACKAGE);this.onInit()}}function f(){if(this.cancelled)this._handleCancel();else{this.waitForDependenciesFinished=(new Date).valueOf();var a=this._fullBodyNeededAndUnLoaded(),b=this._bodyNeededButNotAvailable();a||b?this.waitForDependenciesFinished=!1:(this.timeoutCountdownStart||(this.timeoutCountdownStart=
(new Date).valueOf()),this.allDependenciesLoaded()?this._markLoadedSuccesfuly():this._loadingOutOfTimeFrames()?(this.loadingTimedOut=(new Date).valueOf(),this.allDependenciesLoaded(!0)?this._markLoadedSuccesfuly():(this.addState("TIMED_OUT"),this._markLoadingDependenciesFailed(),this._triggerOnLoadTimeout())):this.waitForDependenciesFinished=!1);this.waitForDependenciesFinished?this.addState("LOADED_DEPENDENCIES"):this._setTimeout(f.bind(this),65)}}var c=k.opentag.Utils,e=k.opentag.TagsUtils,b=k.opentag.Timed,
d=k.opentag.TagHelper,l=0,m=k.opentag.Log;k.Define.clazz("qubit.opentag.GenericLoader",a);a.prototype.EVENT_TYPES={AFTER_EVENT:"after",BEFORE_EVENT:"before",RESTART_EVENT:"restart"};a.prototype.onInit=x;a.prototype.LOADING_TIMEOUT=5E3;a.prototype.getHtml=function(){return this.config.html?this.config.html:this.htmlContent?c.trim(this.htmlContent):null};a.prototype._executeScript=function(){var a=!1;try{this.script(),a=!0}catch(b){this.addState("EXECUTED_WITH_ERRORS"),this.executedWithErrors=(new Date).valueOf(),
this._onError(b)}finally{this._onExecute(a)}};a.prototype.getTimeout=function(){return this._getTimeout()};a.prototype._getTimeout=function(a){var b=+this.config.timeout,d=this.dependencies;if(-1!==b&&0<d.length){var e=0;a=a||[];if(-1===c.indexInArray(a,this)){a[a.length]=this;for(var l=0;l<d.length;l++){var g=d[l]._getTimeout(a);g>e&&(e=g)}0<e&&(b+=e)}else return 0}return b};a.prototype._onExecute=function(a){this.onExecute(a)};a.prototype.onExecute=x;a.prototype._flushDocWrites=function(a){var b=
!0;this._docWriteNotFlushed=!1;try{var d=e.getHTMLLocationForTag(this);d&&this._securedWrites&&0<this._securedWrites.length&&((b=e.flushDocWritesArray(this._securedWrites,d,"END"===this.config.locationPlaceHolder,this.log,a))?this._docWriteFlushed=(new Date).valueOf():this._docWriteNotFlushed=(new Date).valueOf())}catch(c){this._onError(c)}a&&a();this._securedWrites&&0<this._securedWrites.length&&(b=!1,this._docWriteNotFlushed=(new Date).valueOf());return b};a.prototype.log=x;a.prototype.finished=
function(){return!!this.runIsFinished};a.prototype.script=function(){};a.prototype.before=function(){this.beforeRun=(new Date).valueOf();try{this.events.call("before",this)}catch(a){this._onError(a)}};a.prototype.onBefore=function(a){this.events.on("before",a)};a.prototype.after=function(a){this.afterRun=(new Date).valueOf();try{this.events.call("after",{success:a,tag:this})}catch(b){this._onError(b)}};a.prototype.onAfter=function(a){this.events.on("after",a)};a.prototype.runOnce=function(){this._runOnceTriggered||
this.scriptExecuted||(this._runOnceTriggered=(new Date).valueOf(),this.run())};a.CANCEL_ALL=!1;a.prototype.run=function(){if(!isNaN(this.config.runningLimit)&&this.config.runningLimit<=this.runCounter)return!1;if(this.cancelled||a.CANCEL_ALL)return this._handleCancel(),!1;if(this.isRunning)return!1;this.lastRun&&this.reset();this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;this._ignoreDeps=!!this.ignoreDependencies;return this._ignoreDeps||this.dependenciesLoaded()?this._triggerLoadingAndExecution():
(this._attachDepsEventsToContinue(),!1)};a.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();this._ignoreDeps?this.execute():this.waitForDependenciesAndExecute();return!0};a.prototype._attachDepsEventsToContinue=function(){this.awaitingDependencies=(new Date).valueOf();for(var a=this.dependencies,b=0;b<a.length;b++)try{a[b].events.on("success",this._depLoadedHandler)}catch(d){}};a.prototype.dependenciesLoaded=function(){for(var a=this.dependencies,
b=0;b<a.length;b++)if(a[b]!==this&&!(0<+a[b].scriptExecuted))return!1;return!0};a.prototype._setTimeout=function(a,d){this._wasTimed=(new Date).valueOf();var c=this.runtimeId,e=function(){if(this.runtimeId===c)return a()}.bind(this);return b.setTimeout(e,d)};a.prototype._handleCancel=function(){this.addState("CANCELLED");try{this.onCancel()}catch(a){this._onError(a)}};a.prototype.waitForDependenciesAndExecute=function(){this.loadedDependencies?this.execute():this.loadingDependenciesFailed?(this._markFailure(),
this._markFinished()):this._setTimeout(this.waitForDependenciesAndExecute.bind(this),30)};a.prototype.execute=function(){this._triggerExecution()};a.prototype._triggerExecution=function(){if(this.cancelled)this._handleCancel();else if(!this.scriptExecuted){var a=!0;if(this.shouldWaitForDocWriteProtection())a=!1;else{if(!this._beforeEntered){this._beforeEntered=(new Date).valueOf();a=!1;try{a=this.before()}catch(b){this._onError(b)}if(a){this._markFailure();this._markFinished();return}}a=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(!this.scriptExecuted)if(this.unexpectedFail&&
(a=!0),a){this._flushDocWrites();this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail?this._markFailure():(this.scriptExecuted=(new Date).valueOf(),this.addState("EXECUTED"),this._executeScript());if(this.cancelled)return this._handleCancel(),!1;a=0<this.scriptExecuted;try{this.afterRun||(this.afterRun=(new Date).valueOf(),this.after(a))}catch(d){this.executedWithErrors=(new Date).valueOf()}this.executedWithErrors||a&&this.events.call("success");this._flushDocWrites();this._markFinished()}else this._setTimeout(this._triggerExecution.bind(this),
30)}};a.prototype._markFailure=function(){this.scriptExecuted=-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};a.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();this.isRunning=!1;a.LOCK_DOC_WRITE===this&&(this._flushDocWrites(),e.unlockDocumentWrites(),a.LOCK_DOC_WRITE=!1);this.onFinished(!0)};a.prototype.onFinished=x;a.prototype.onCancel=x;a.prototype.onFinished=x;a.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!a.LOCK_DOC_WRITE)a.LOCK_DOC_WRITE=
this,this._secureWriteAndCollectForExecution();else if(a.LOCK_DOC_WRITE!==this)return this._lockedDocWriteInformed||(this._lockedDocWriteInformed=(new Date).valueOf()),!0;return!1};a.prototype.runWithoutDependencies=function(){this.ignoreDependencies=!0;this.run()};a.prototype.loadExecutionURLsAndHTML=function(a){if(this.cancelled)return this._handleCancel(),!0;this._loadExecutionURLsAndHTMLInformed||(this._loadExecutionURLsAndHTMLInformed=!0);this._triggerURLsLoading(a);return this.loadURLsNotFinished||
(this._flushDocWrites(),this._triggerHTMLInjection(),this._flushDocWrites(),this.injectHTMLNotFinished||(this._flushDocWrites(),this._docWriteNotFlushed))?!1:!0};a.prototype._triggerURLsLoading=function(a){!this._urlLoadTriggered&&this.config.url&&(this._urlLoadTriggered=!0,this.loadURLs(!1,a))};a.prototype._triggerHTMLInjection=function(){!this._injectHTMLTriggered&&this.getHtml()&&(this._injectHTMLTriggered=!0,this.injectHTML())};a.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,
LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,UNEXPECTED_FAIL:2048,CANCELLED:4096};a.prototype.addState=function(a){if(this.STATE.hasOwnProperty(a)){this.state|=this.STATE[a];try{this.onStateChange(a)}catch(b){this._onError(b)}}};a.prototype.onStateChange=x;a.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};a.prototype.unCancel=function(){this.cancelled=!1};a.prototype.state=
a.prototype.STATE.INITIAL;a.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};a.prototype._secureWriteAndCollectForExecution=function(){this._securedWrites||(this._securedWrites=[],e.redirectDocumentWritesToArray(this._securedWrites,this.log))};a.prototype._markLoadingDependenciesFailed=function(){this.addState("FAILED_TO_LOAD_DEPENDENCIES");this.loadingDependenciesFailed=(new Date).valueOf()};a.prototype.allDependenciesLoaded=
function(a,b){return 0===this.getDependenciesToBeLoaded(a,b).length};a.prototype.getDependenciesToBeLoaded=function(a,b){var d=b||[];this.injectionLocationReady()||d.push("injection location");var c,e=this.dependencies;for(c=0;c<e.length;c++)e[c]!==this&&(0<+e[c].scriptExecuted||d.push("dependant Tag with name -> "+(e[c].config?e[c].config.name:"anonymous")));for(c=0;c<this.genericDependencies.length;c++)this.genericDependencies[c](this)||d.push("this.genericDependencies["+c+"] (index: "+c+")");return d};
a.prototype.docWriteAsksToWaitForBody=function(){return!(!this.delayDocWrite||!this.config.usesDocumentWrite)};a.prototype._bodyNeededButNotAvailable=function(){return this._dontWaitForInjections()?!1:this._isBodyLocationNeeded()&&!e.bodyAvailable()};a.prototype._isBodyLocationNeeded=function(){return this.isLoadingAsynchronously()?this._isBodyLocationSet()?!0:"HEAD"===this.config.locationObject&&"END"===this.config.locationPlaceHolder:!1};a.prototype._isBodyLocationSet=function(){var a=this.config.locationObject;
return!a||"BODY"===a};a.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return!1;var a=!1;this._isBodyLocationNeeded()&&(a="END"===this.config.locationPlaceHolder);return(a=a||this.fullbodyNeeded||this.docWriteAsksToWaitForBody())&&!c.bodyReady()};a.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||a.dontWaitForInjectionLocation};a.prototype.injectionLocationReady=function(){return this._dontWaitForInjections()?
!0:this._fullBodyNeededAndUnLoaded()?!1:this.isLoadingAsynchronously()?!!e.getHTMLLocationForTag(this):!0};a.prototype._loadingOutOfTimeFrames=function(){return 0>this.getTimeout()?!1:(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};a.prototype.loadDependencies=function(){this._loadDependencies()};a.prototype.addClientDependenciesList=function(a,b){return this.addDependenciesList(a,k.Define.clientSpaceClasspath())};a.prototype.addDependenciesList=function(b,d){if(b&&0!==b.length){this.failedDependenciesToParse||
(this.failedDependenciesToParse=[]);for(var e=this.dependencies,l=0;l<b.length;l++){var f=b[l],g=!1;if(f instanceof a)e.push(f);else if("string"===typeof f){var s=f;d&&(f=d+"."+f);var v=c.getObjectUsingPath(f);v?v instanceof a?e.push(v):g=!0:this.failedDependenciesToParse.push(s)}else g=!0;g&&(this.badDepsObjects=this.badDepsObjects||[],c.addToArrayIfNotExist(this.badDepsObjects,f))}}};a.prototype._loadDependencies=function(a){a=a||[];var b=this.dependencies;if(-1===c.indexInArray(a,this)){a[a.length]=
this;for(var d=0;d<b.length;d++)b[d].load(a)}};a.prototype.onError=x;a.prototype._onError=function(a){try{this.onError(a)}catch(b){}};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.onLoadTimeout=x;a.prototype.onScriptsLoadSuccess=x;a.prototype.onScriptLoadError=x;a.prototype.onAllDependenciesLoaded=x;a.prototype.onBeforeLoad=null;a.prototype.load=function(){if(!this.loadStarted){this.loadStarted=(new Date).valueOf();try{if(this.onBeforeLoad)this.onBeforeLoad()}catch(a){this._onError(a)}this.addState("LOADING_DEPENDENCIES");
try{!this._ignoreDeps&&this.config.loadDependenciesOnLoad&&this.loadDependencies()}catch(b){throw b;}f.call(this)}};a.prototype._singleUrlLoadHandler=function(a,b,d){++this.urlsLoaded;a||++this.urlsFailed;if(this.urlsLoaded===b.length)if(this.loadURLsNotFinished=!1,a&&0===this.urlsFailed){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{d&&d(!0)}catch(c){this._onError(c)}finally{this.onScriptsLoadSuccess()}}else{a="error loading urls. Failed "+this.urlsFailed;this._onError(a);
this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=!0,d&&d(!1)}catch(e){this._onError(e)}finally{this.onScriptLoadError(a)}}};a.prototype.loadURLs=function(a,b){var d=a||this.config.url;this.addState("LOADING_URL");try{!d||d instanceof Array||(d=[d]);for(var c=0;c<d.length;c++){this.loadURLsNotFinished=!0;var e=d[c],e=this.prepareURL(e);this.loadURL(e,function(a){this._singleUrlLoadHandler(a,d,b)}.bind(this))}}catch(g){this.loadURLsNotFinished=!1,
this.addState("UNEXPECTED_FAIL"),this.unexpectedFail=(new Date).valueOf(),this._onError(g)}};a.prototype.prepareLocationObject=function(a){return a};a.prototype.prepareURL=function(a){return a};a.prototype.prepareHTML=function(a){return a};a.prototype.loadURL=function(a,b,d){this.addState("LOADING_URL");e.loadScript({onsuccess:function(){try{b&&b(!0)}catch(a){}}.bind(this),onerror:function(){try{b&&b(!1)}catch(a){}}.bind(this),url:a,node:d||this.config.urlLocation,async:this.isLoadingAsynchronously(),
noMultipleLoad:this.config.noMultipleLoad})};a.prototype.onRestart=function(a){this.events.on("restart",a)};a.prototype.prepareForRestart=function(){if(this.config.restartable){var a=this.restartCounter+1;this.events.call("restart",this);this.reset();this.restartCounter=a}};a.prototype.restart=function(){this.config.restartable&&(this.prepareForRestart(),this.run())};a.prototype.reset=function(){this._securedWrites=this.delayDocWrite=this.scriptLoadingFailed=this.scriptExecuted=this.runIsFinished=
this.loadingTimedOut=this.loadingDependenciesFailed=this.loadedDependencies=this.loadURLsNotFinished=this.loadStarted=this.injectHTMLFailed=this.filtersRunTriggered=this.beforeRun=this.afterRun=this._urlLoadTriggered=this._runOnceTriggered=this._lockedDocWriteInformed=this._loadExecutionURLsAndHTMLInformed=this._injectHTMLTriggered=void 0;this.state=0;this.unexpectedFail=void 0;this.urlsLoaded=this.urlsFailed=0;this.timeoutCountdownStart=this.awaitingDependencies=this._beforeEntered=this.cancelled=
this.lastRun=this.isRunning=this.waitForDependenciesFinished=void 0;this.restartCounter=0;this.runtimeId=c.UUID();this.addState("INITIAL")};a.prototype.isLoadingAsynchronously=function(){return this._wasTimed?!0:!(!this.config.async&&!this.forceAsynchronous)};a.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};a.prototype.injectHTML=function(a){var b=!this.docWriteAsksToWaitForBody(),c=this.prepareHTML(this.getHtml());c&&d.injectHTMLForLoader(this,
a,b,c)};a.prototype.clone=function(){return new a(this.config)}})();(function(){function a(g){c.setIfUnset(g,{filterTimeout:g&&g.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:g&&g.PACKAGE,dedupe:!1,needsConsent:!1,inactive:!1,variables:null,runner:null,disabled:!1,locked:!1,reRunOnVariableChange:!1});a.SUPER.apply(this,arguments);this.namedVariables={};this._runtimeMarkers={};this.parameters=[];this.filters=[];this.owningContainer=this.session=null;this.oldDedupePingSent=this.dedupePingSent=this.oldPingSent=
this.pingSent=!1;this.reRunCounter=0;if(g){this.addState("INITIAL");try{a.register(this)}catch(b){}this.setupConfig(g);this.uniqueRefString=null;if(g.init)try{g.init.call(this,g)}catch(d){}this.onTagInit();this.handleVariableChange=this._handleVariableChange.bind(this)}}function f(a,b){var c=a.namedVariables,e=d.initPageVariable(c[b]);return c[b]=e}var c=k.opentag.Utils,e=k.opentag.TagsUtils,b=k.opentag.filter.BaseFilter,d=k.opentag.TagHelper,l=k.opentag.pagevariable.BaseVariable,m=k.Cookie,h=k.Define;
h.clazz("qubit.opentag.BaseTag",a,k.opentag.GenericLoader);a.prototype.setupConfig=function(a){if(a){a.filters&&this.addFilters(a.filters);a.parameters&&this.addParameters(a.parameters);if(a.variables)for(var b in a.variables)if(a.variables.hasOwnProperty(b)){var d=this.getParameterByTokenName(b);if(d){var c=a.variables[b];d.variable=c;void 0!==c.defaultValue&&(d.defaultValue=c.defaultValue);void 0!==c.uv&&(d.uv=c.uv)}}a.locked&&this.lock()}};a.prototype.valueForToken=function(a,b){var d=this.getParameterByTokenName(a);
if(d)return void 0===b&&this.loadingTimedOut&&(b=!0),this.getParameterValue(d,b);if((d=this.namedVariables)&&d[a]&&(d=f(this,a)))return d.getRelativeValue(b)};a.prototype.addParameters=function(a){this.parameters=this.parameters.concat(a)};a.prototype.LOADING_TIMEOUT=5E3;a.prototype.FILTER_WAIT_TIMEOUT=-1;a.prototype._isVariable=function(a){return null!==a&&void 0!==a};a.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();this.runPostInitialisationSection();
var a=this.parameters;if(a)for(var b=0;b<a.length;b++){var d=this.getVariableForParameter(a[b]);if(!this._isVariable(d)){this._markLoadingDependenciesFailed();this._markFinished();return}}if(this.config.runner){a=!1;try{this.addState("AWAITING_CALLBACK"),a=this._runner=(new Date).valueOf(),this.config.runner.call(this)}catch(c){}return a}this._runner=!1;return this.start()};a.prototype.lock=function(){this.locked=!0;this._unlock=null};a.prototype.unlock=function(){this.locked=!1;this._unlock&&(this._unlock(),
this._unlock=!1)};a.prototype.start=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.run.call(this)}.bind(this),!1):a.SUPER.prototype.run.call(this)};a.prototype.startOnce=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.runOnce.call(this)}.bind(this),!1):a.SUPER.prototype.runOnce.call(this)};a.prototype.getFilters=function(){return this.filters};a.prototype.runOnceIfFiltersPass=function(){this._runOnceIfFiltersPassTriggered||this.scriptExecuted||
(this._runOnceIfFiltersPassTriggered=(new Date).valueOf(),this.runIfFiltersPass())};a.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();this.runPostInitialisationSection();var a=this.filtersState(!0);this.addState("FILTER_ACTIVE");this.filtersRunTriggered||(this.filtersRunTriggered=(new Date).valueOf());if(a===b.state.SESSION)this.addState("AWAITING_CALLBACK"),this.awaitingCallback=(new Date).valueOf();else if(a===b.state.PASS){this.filtersPassed=
(new Date).valueOf();try{this.onFiltersPassed()}catch(d){}this.run()}else if(a===b.state.FAIL)this._markFiltersFailed(),this._markFinished();else if(0<a){var c=this.config.filterTimeout;if(0>c||(new Date).valueOf()-this.filtersRunTriggered>c){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(e){}}this._setTimeout(this.runIfFiltersPass.bind(this),a)}else this._markFiltersFailed(),this._markFinished(),this.filtersRunTimedOut=
(new Date).valueOf()}try{this.onFiltersCheck(a)}catch(l){}return a};a.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};a.prototype.STATE={INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,TIMED_OUT:8192,UNEXPECTED_FAIL:16384,
CANCELLED:32768};a.prototype.addState=function(b){a.SUPER.prototype.addState.call(this,b);try{a.onStateChange(this)}catch(d){}this.stateStack=[];b=this.STATE;var c=this.state,e=this.stateStack;c&b.INITIAL&&e.push("Initial state.");c&b.FILTER_ACTIVE&&e.push("Tag running with filters pass triggered.");c&b.FILTERS_FAILED&&e.push("Filters failed to pass.");c&b.AWAITING_CALLBACK&&e.push("Awaiting callback to run this tag. Not pooling.");c&b.STARTED&&e.push("Tag is initialised and loading has been started.");
c&b.LOADING_DEPENDENCIES&&e.push("Dependencies are being loaded.");c&b.LOADED_DEPENDENCIES&&e.push("Dependencies loading process has been finished.");c&b.LOADING_URL&&e.push("External URL is being loaded.");c&b.LOADED_URL&&e.push("External URL has been loaded.");c&b.EXECUTED&&e.push("Main script has been executed.");c&b.EXECUTED_WITH_ERRORS&&e.push("Main script has been executed but errors occured.");c&b.FAILED_TO_LOAD_DEPENDENCIES&&e.push("Dependencies has failed to load.");c&b.FAILED_TO_LOAD_URL&&
e.push("URL location failed to load.");c&b.FAILED_TO_EXECUTE&&e.push("Script failed to execute.");c&b.TIMED_OUT&&e.push("Script timed out awaiting for dependencies.");c&b.UNEXPECTED_FAIL&&e.push("Script occured UNEXPECTED exception and is failed.");c&b.CANCELLED&&e.push("Tag has been cancelled.")};a.prototype.onTagInit=x;a.prototype.postInitialisationSection=x;a.onStateChange=x;a.prototype.onFiltersDelayed=x;a.prototype.onFiltersPassed=x;a.prototype.onFiltersCheck=x;a.prototype.state=a.prototype.STATE.INITIAL;
a.prototype.arePageVariablesLoaded=function(a){return d.allParameterVariablesReadyForTag(this,a)};a.prototype.getDependenciesToBeLoaded=function(b,d){var c=d||[];this.arePageVariablesLoaded(b)||c.push("page variables");return a.SUPER.prototype.getDependenciesToBeLoaded.call(this,b,c)};a.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};a.prototype.resolveDependencies=function(){var a=this.failedDependenciesToParse;a&&(this.failedDependenciesToParse=
null,this.addDependenciesList(a,h.clientSpaceClasspath()));return this.dependencies};a.prototype.addClientVariablesMap=function(a){return this.unresolvedClientVariablesMap=this._addVariablesMap(a,h.clientSpaceClasspath())};a.prototype.resolvePageVariables=function(){var a=this.unresolvedClientVariablesMap;a&&(this.unresolvedClientVariablesMap=null,this.addClientVariablesMap(a));if(a=this.unresolvedVariablesMap)this.unresolvedVariablesMap=null,this.addVariablesMap(a);return this.getPageVariables()};
a.prototype.addVariablesMap=function(a){return this.unresolvedVariablesMap=this._addVariablesMap(a)};a.prototype._addVariablesMap=function(a,b){if(a){var d={},e=this.namedVariables,f;for(f in a)if(a.hasOwnProperty(f)){var h=a[f];if(h instanceof l)e[f]=h;else if("string"===typeof h){var m=h;b&&(h=b+"."+h);var n=c.getObjectUsingPath(h);n?e[f]=n instanceof l?n:h:d[f]=m}}return d}};a.prototype.prepareURL=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareLocationObject=function(a){return this.replaceTokensWithValues(a)};
a.prototype.prepareHTML=function(a){a&&(a=this.replaceTokensWithValues(a));return a};a.prototype._executeScript=function(){if(this.config&&this.config.script)if("function"===typeof this.config.script)this.script=this.config.script;else{var b=this.replaceTokensWithValues(String(this.config.script));this.script=c.expressionToFunction(b).bind(this)}a.SUPER.prototype._executeScript.call(this)};a.prototype.replaceTokensWithValues=function(a){if(!a||-1===a.indexOf("${"))return a;var b=this.parameters;if(b)for(var d=
0;d<b.length;d++){var c=this.getVariableForParameter(b[d]);if(c){var e=b[d].token,l=this.valueForToken(e);a=c.replaceToken(e,a,l)}}return a};a.prototype.getParameter=function(a){var b=this.parameters,d=null;if(b)for(var c=0;c<b.length;c++)b[c].name===a&&(d=b[c]);return d};a.prototype.setParameterValueByTokenName=function(a,b){var d=this.getParameterByTokenName(a);return null!==d?(d.variable={value:b},!0):!1};a.prototype.getParameterValue=function(a,b){var d="string"===typeof a?this.getParameter(a):
a;if(d){var e=this.getVariableForParameter(d);if(e)try{var l;b&&""!==d.defaultValue&&(l=c.gevalAndReturn(d.defaultValue).result);return l=e.getRelativeValue(b,l)}catch(f){}}};a.prototype.filtersState=function(a){return e.filtersState(this.filters,this.session,this,a)};a.prototype.addFilter=function(a){c.addToArrayIfNotExist(this.filters,a)};a.prototype.addFilters=function(a){for(var b=0;b<a.length;b++)this.addFilter(a[b])};a.prototype.addClientFiltersList=function(a){return this.unresolvedClientFilterClasspaths=
this.addFiltersList(a,h.clientSpaceClasspath())};a.prototype.resolveFilters=function(){var a=this.unresolvedClientFilterClasspaths;a&&(this.unresolvedClientFilterClasspaths=null,this.addClientFiltersList(a));return this.filters};a.prototype.addFiltersList=function(a,d){for(var e=[],l=0;l<a.length;l++)try{var f=a[l],h=null;"string"===typeof f&&(h=f,d&&(f=d+"."+f),f=c.getObjectUsingPath(f));"function"===typeof f&&(f=new f);!f instanceof b&&(f=null);f?this.addFilter(f):h&&c.addToArrayIfNotExist(e,h)}catch(m){this.failedFilters=
this.failedFilters||[],this.failedFilters.push(a[l])}return e};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);this.filtersPassed=void 0;this.oldPingSent=this.pingSent=this.oldDedupePingSent=this.dedupePingSent=!1;this._runner=this.filtersRunTriggered=this._runOnceIfFiltersPassTriggered=void 0;this.reRunCounter=0;this.detachVariablesChangedListeners()};a.prototype.resetFilters=function(){for(var a=0;a<this.filters.length;a++)this.filters[a].reset()};a.prototype.getParameterByTokenName=
function(a){var b=null;if(this.parameters)for(var d=this.parameters,c=0;c<d.length;c++)d[c].token===a&&(b=d[c]);return b};a.prototype.removeFilter=function(a){c.removeFromArray(this.filters,a)};var n=0,q=[],p={},t={};a.register=function(a){var b=c.addToArrayIfNotExist(q,a);a._tagIndex=-1===b?q.length-1:b;a.config.id?(b="Q"+a.config.id,t[b]=a,a.uniqueId=b):t[a.CLASSPATH]=a};a.getById=function(a){return t[String(a)]};a.prototype.getById=a.getById;a.prototype.unregister=function(b){a.unregister(b||this)};
a.prototype.destroy=function(){this.destroyed=!0;this.cancel();a.unregister(this)};a.unregister=function(a){c.removeFromArray(q,a);a._tagIndex=-1};a.getTags=function(){return q};a.getAccessorsMap=function(){return p};a.prototype.getTags=function(){return q};a.prototype.getPageVariables=function(){var a=this.parameters,b=[];if(a)for(var d=0;d<a.length;d++){var e=this.getVariableForParameter(a[d]);this._isVariable(e)&&c.addToArrayIfNotExist(b,e)}if(this.namedVariables)for(var l in this.namedVariables)c.addToArrayIfNotExist(b,
f(this,l));return b};a.prototype.getAccessorString=function(){this._accessorsMapKey||(this._accessorsMapKey="_"+n++,p[this._accessorsMapKey]=this);return"qubit.opentag.BaseTag.getAccessorsMap()."+this._accessorsMapKey};a.prototype.getVariableForParameter=function(a){var b,c=this.namedVariables;c&&c[a.token]&&(b=f(this,a.token));b||(b=d.validateAndGetVariableForParameter(a));return b};a.prototype.printVariablesState=function(){for(var a=[],b=d.getAllVariablesWithParameters(this),c=0;c<b.length;c++){var e=
b[c].parameter,l=b[c].variable,f;f=e&&e.token?this.valueForToken(e.token):l.getRelativeValue(!0);e={name:l.config.name,exists:l.exists(),token:e?e.token:null,value:f,variable:l};a.push(e)}return a};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.getId=function(){return this._getUniqueId()};a.prototype._getUniqueId=function(){return this.config.id?this.config.id:0===String(this.CLASSPATH).indexOf(h.STANDARD_CS_NS)?this.CLASSPATH.substring(h.STANDARD_CS_NS.length+1):this.CLASSPATH+
"#"+this.config.name};a.prototype.cookieSaysToRunEvenIfDisabled=function(){var a=this._getUniqueId(),b=!!m.getCached("qubit.tag.forceAllToRun");b||(b=!!m.getCached("qubit.tag.forceRunning_"+a));return b};a.prototype.setCookieForcingTagToRun=function(){var a=this._getUniqueId();m.set("qubit.tag.forceRunning_"+a,"true");m.resetCache()};a.setCookieForcingTagsToRun=function(){m.set("qubit.tag.forceAllToRun","true");m.resetCache()};a.prototype.setCookieToDisable=function(){var a=this._getUniqueId();m.set("qubit.tag.disableRunning_"+
a,"true");m.resetCache()};a.prototype.rmCookieToDisable=function(){var a=this._getUniqueId();m.rm("qubit.tag.disableRunning_"+a);m.resetCache()};a.prototype.disabledByCookie=function(){var a=this._getUniqueId();return!!m.getCached("qubit.tag.disableRunning_"+a)};a.rmCookieForcingTagsToRun=function(){m.rm("qubit.tag.forceAllToRun");m.resetCache()};a.prototype.rmCookieForcingTagToRun=function(){var a=this._getUniqueId();m.rm("qubit.tag.forceRunning_"+a);m.resetCache()};a.rmAllDisablingCookies=function(){c.rmCookiesMatching("qubit.tag.disableRunning_");
m.resetCache()};a.rmAllCookiesForcingTagToRun=function(){c.rmCookiesMatching("qubit.tag.forceRunning_");a.rmCookieForcingTagsToRun()};a.prototype.onVariableChanged=function(a){this.attachVariablesChangedListeners(!0);this.events.on("variableChanged",a)};a.prototype._handleVariableChange=function(a){this.events.call("variableChanged",a);this.isRunning||!this.config.reRunOnVariableChange||!isNaN(this.config.reRunLimit)&&this.config.reRunLimit<=this.reRunCounter||(a=this.reRunCounter+1,this.reset(),
this.reRunCounter=a,this.resetFilters(),this.runIfFiltersPass())};a.prototype.attachVariablesChangedListeners=function(a){var b=this.getPageVariables();if(a=!!(this.config.reRunOnVariableChange||this.config.observeVariables||a))for(var d=0;d<b.length;d++)b[d].onValueChanged(this.handleVariableChange,a)};a.prototype.detachVariablesChangedListeners=function(){for(var a=this.getPageVariables(),b=0;b<a.length;b++)a[b].deatchOnValueChanged(this.handleVariableChange)};a.prototype._markFinished=function(){a.SUPER.prototype._markFinished.call(this);
this.attachVariablesChangedListeners()};a.prototype.prepareForRestart=function(b){if(this.config.restartable&&(a.SUPER.prototype.prepareForRestart.call(this,!1),!b)){b=this.getFilters();for(var d=0;d<b.length;d++)b[d].prepareForRestart()}};a.prototype.restart=function(a){this.config.restartable&&(this.prepareForRestart(a),this.runIfFiltersPass())};a.prototype.runPostInitialisationSection=function(){if(!this._postInitialisationRun&&(this._postInitialisationRun=!0,this.postInitialisationSection))try{this.postInitialisationSection()}catch(a){}}})();
(function(){function a(a){if(a)if(a.alphabet)for(this.alphabet=a.alphabet,this.dict={},a=0;a<this.alphabet.length;a++)this.dict[this.alphabet[a]]=a;else this.alphabet=c,this.dict=d}function f(a,b){for(var d in b)if(a===b[d])return d;return null}for(var c=[],e=Math.pow(2,8),b=0;b<e;b++)c.push(String.fromCharCode(b));for(var d={},e=0;e<c.length;e++)d[c[e]]=e;k.Define.clazz("qubit.compression.LZW",a);a.prototype.encode=function(a){for(var b=this.alphabet.length,d={},c=[],e=0,f=a.charAt(e++),k,g=this.dict;k=
a.charAt(e++);){var s=f+k;if(g.hasOwnProperty(s)||d.hasOwnProperty(s))f=s;else{var v=g.hasOwnProperty(f)?g[f]:d[f];if(void 0===v)throw"Dictionary base is to small for those contents: "+f;c.push(v);d[s]=b++;f=k}}""!==f&&c.push(d.hasOwnProperty(f)?d[f]:g[f]);return c};a.prototype.decode=function(a){for(var b=this.dict,d=this.alphabet.length,c,e={},k=f(a[0],b),t=k,g=[k],s=1;s<a.length;s++){var v=a[s];c=f(v,b);null===c&&(e.hasOwnProperty(v)&&(c=e[v]),null===c&&(c=t+k));g.push(c);k=c.charAt(0);e[d++]=
t+k;t=c}return g.join("")}})();(function(){function a(a){}for(var f={},c=0;45>c;c++)f["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(c)]=c;for(var e={},c=0;45>c;c++)e['ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(c)]=c;for(var b={},c=0;45>c;c++)b["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(c)]='ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(c);var d="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".split(""),l=d.length,m=new k.compression.LZW({});k.Define.clazz("qubit.compression.Compressor",
a);a.prototype.compress=function(a,b){for(var d=(b||m).encode(a),c=[],e=0;e<d.length;e++)c.push(String.fromCharCode(d[e]));return c.join("")};a.prototype.compressAnsi=function(a,c){for(var e=(c||m).encode(a),f=[],k=0;k<e.length;k++){var g;g=e[k];var s=0,v=0>g;v&&(g=-g);var w="",u=!0;do s=g%l,u?(w=b[d[s]],u=!1):w=d[s]+w,g=(g-s)/l;while(0<g);g=v?"-"+w:w;f.push(g)}return f.join("")};a.prototype.decompressAnsi=function(a,b){for(var d=[],c="",k=0;k<a.length;k++){var g=a.charAt(k);if(e.hasOwnProperty(g)){for(var g=
c+g,c="",s=0,v=0,w=!0,u=0;u<g.length;u++){var I=g.charAt(g.length-1-u);w&&(w=!1,I="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(e[I]));s+=f[I]*Math.pow(l,v++)}g=s;d.push(g)}else c+=g}return(b||m).decode(d)};a.prototype.decompress=function(a,b){for(var d=[],c=0;c<a.length;c++)d.push(a.charCodeAt(c));return(b||m).decode(d)}})();(function(){function a(a){for(var d=[],c=0;c<a.length;c++){var e=b(a[c][0]);d.push([new RegExp(e,"g"),"*"+a[c][1]])}return d}function f(a,b){for(var d=0;d<b.length;d++)if(b[d][1]===
a)return b[d][0];return null}function c(b){this._regexDefs=n;this._defs=h;b&&b.definitions&&(this._regexDefs=a(b.definitions),this._defs=b.definitions)}function e(a,b){for(var d=[],c=0;c<a.length;c++){var e=!0;b&&(e=a.charCodeAt(c)<=b);var l=m.cookieAlphabetMap.hasOwnProperty(a.charAt(c));e&&!l?d.push("*"+a.charCodeAt(c)+"."):d.push(a.charAt(c))}return d.join("")}function b(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function d(a){for(var b={},d="",c=0;c<a.length;c++){var e=a.charAt(c);
q[e]?d+=e:(isNaN(b[d])&&(b[d]=a.split(d).length-1),d="")}a=[];for(var l in b)b.hasOwnProperty(l)&&(d=b[l],d>=t&&l.length>=p&&a.push([l,d]));return a=a.sort(function(a,b){return a[0].length===b[0].length?0:b[0].length>a[0].length?1:-1})}var l=k.Define,m=k.Cookie,h=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',
"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww","10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["<","S"],[">","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")",
"d"],["!","e"],["#","f"],["$","g"],["!","q"],["'","i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]],n=a(h);l.clazz("qubit.opentag.compression.Encoder",c);c.prototype.encode=function(a,c){for(var l=a.replace(/\*/g,"**"),f=d(l),h=0;h<this._regexDefs.length;h++)var m=this._regexDefs[h],l=l.replace(m[0],m[1]);l=l.replace(/;/g,"*-");l=l.replace(/&/g,"*.");l=l.replace(/\\/g,"*/");l=l.replace(/=/g,"*+");l=l.replace(/\n/g,"*N");l=l.replace(/ /g,"*_");l=l.replace(/\t/g,
"*T");l=l.replace(/"/g,"*Q");h=d(l);h.concat(f);for(var f=l.replace(/@/g,"@@"),m=[],k=0,n=0;k<h.length;k++){var p=new RegExp(b(h[k][0]),"g"),p=f.replace(p,"@"+n+"-");p!==f&&(m.push(h[k][0]),n++,f=p)}h=[f,m];f=h[1];(m=0<f.length)&&(l=h[0]);l=c?e(l,c):e(l);return m?"Y"+f.join("*")+"@"+l:"N"+l};for(var q={},l=0;65>l;l++)q["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.".charAt(l)]=!0;var p=4,t=2;c.prototype.decode=function(a){var b=null;if("N"===a.charAt(0))a=a.substring(1);else if("Y"===
a.charAt(0)){var d=a.indexOf("@");if(0<=d&&(b=a.substring(1,d),b=b.split("*"),a=a.substring(d+1),b&&0!==b.length&&a)){for(var d="",c=!1,e=!1,l="",h=0;h<a.length;h++){var m=a.charAt(h);"@"===m||c||e?c||e?(c=!1,"@"===m?d+="@":isNaN(+("-"+m))?e?(d=b&&"-"===m&&b[+l]?d+b[+l]:d+("@"+l+m),l="",e=!1):d+="@"+m:(e=!0,l+=m)):c=!0:d+=m}l&&(d+="@"+l);c&&(d+="@");a=d}}b="";c=d=!1;e="";for(l=0;l<a.length;l++)h=a.charAt(l),"*"===h||d||c?d||c?(d=!1,isNaN(+("-"+h))?c?(b="."===h?b+String.fromCharCode(+e):"-"===h&&f(e+
"-",this._defs)?b+f(e+"-",this._defs):b+("*"+e+h),e="",c=!1):"*"===h?b+="*":"-"===h?b+=";":"/"===h?b+="\\":"."===h?b+="&":"+"===h?b+="=":"N"===h?b+="\n":"_"===h?b+=" ":"T"===h?b+="\t":"Q"===h?b+='"':null!==f(h,this._defs)?(h=f(h,this._defs),b+=h):b+="*"+h:(e+=h,c=!0)):d=!0:b+=h;e&&(b+="*"+e);d&&(b+="*");return b}})();(function(){function a(a){this.testBinary=!1;this.binSupported=c;a&&(this.compressor=new k.compression.Compressor,this.encoder=new k.opentag.compression.Encoder({}))}var f=k.Cookie,c=
!1;k.Define.clazz("qubit.opentag.compression.CookieCompressor",a);a.prototype.compress=function(a,b){if("string"!==typeof a||""===a)return a;var d=this.encoder.encode(a),c;if(this.binSupported||this.testBinary){c=this.compressor.compress(d);c='"B'+this.encoder.encode(c,128)+'"';f.set("__qtag_test_bin__",c,void 0,void 0,!0);var m=f.get("__qtag_test_bin__",!0);f.rm("__qtag_test_bin__");m&&m!==c&&(c=null)}m=this.encoder.encode(this.compressor.compressAnsi(d));d=!b&&d.length<=m.length?"E"+d:"C"+m;return c&&
c.length<d.length?c:d};a.prototype.decompress=function(a){if("string"!==typeof a||""===a)return a;'"'===a.charAt(0)&&(a=a.substring(1,a.length-1));var b=a.charAt(0);a=a.substring(1);switch(b){case "E":return this.encoder.decode(a);case "C":return a=this.compressor.decompressAnsi(this.encoder.decode(a)),this.encoder.decode(a);case "B":return a=this.compressor.decompress(this.encoder.decode(a)),this.encoder.decode(a);default:throw"This code is not supported! Code: "+b;}}})();(function(){function a(b){c.setIfUnset(b,
a.defaultConfig);if(this.singleton){var d=k.opentag.Utils.getObjectUsingPath(this.PACKAGE_NAME+"."+this.CLASS_NAME,B);if(d.__instance)return d.__instance;d.__instance=this}a.SUPER.call(this,b)}function f(a,d){var e=a.toString(),e=e.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,""),e=e.substring(0,e.lastIndexOf("}")),e=e.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,'$1"${$2}"'),e=e.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),
e=e.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"'),e=e.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),e=e.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'(\s*)\)/g,"$1${$2}$3"),e=e.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"(\s*)\)/g,"$1${$2}$3"),e=d.replaceTokensWithValues(e);c.geval(e)}var c=k.opentag.Utils,e=k.Define;k.Define.clazz("qubit.opentag.LibraryTag",a,k.opentag.BaseTag);a.defaultConfig=
{vendor:null,imageUrl:null,description:"",async:!1,isPrivate:!1,upgradeable:!0,html:"",parameters:[],prePostWindowScope:!1};a.prototype.pre=function(){};a.prototype.post=function(){};a.prototype.before=function(){a.SUPER.prototype.before.call(this);try{var b=this.config;if(b&&b.pre)if("function"===typeof b.pre)this.pre=b.pre;else{var d=this.replaceTokensWithValues(String(b.pre));this.pre=c.expressionToFunction(d).bind(this)}this.config.prePostWindowScope&&this.pre!==a.prototype.pre&&this.pre.toString?
f(this.pre,this):this.pre()}catch(e){return!0}return!1};a.prototype.after=function(b){a.SUPER.prototype.after.call(this,b);try{var d=this.config;if(d&&d.post)if("function"===typeof d.post)this.post=d.post;else{var e=this.replaceTokensWithValues(String(d.post));this.post=c.expressionToFunction(e).bind(this)}this.config.prePostWindowScope&&this.post!==a.prototype.post&&this.post.toString?f(this.post,this):this.post(b)}catch(m){}};a.define=function(b,d){b=b.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,
".");b=k.Define.vendorsSpaceClasspath(b);var l={};d.getDefaultConfig&&(l=d.getDefaultConfig());var f=d.CONSTRUCTOR,h={},n;for(n in d)"config"!==n&&(h[n]=d[n]);h=k.opentag.Utils.defineWrappedClass(b,a,h,y,function(a){a=a||{};a=c.overrideFromLeftToRight(l,a);var b=k.opentag.LibraryTag.call(this,a);f&&f.call(this,a);if(b)return b});n=e.STANDARD_VS_NS+".";0!==b.indexOf(n)&&c.namespace(n+b,h);return h};a.getLibraryByClasspath=function(a){return c.getObjectUsingPath(a,k.Define.getVendorSpace())}})();(function(){function a(c){f.setIfUnset(c,
{url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:!0});a.SUPER.call(this,c)}var f=k.opentag.Utils;k.Define.clazz("qubit.opentag.CustomTag",a,k.opentag.LibraryTag)})();(function(){var a=k.opentag.Utils,f=k.opentag.filter.BaseFilter,c=function(){};k.Define.clazz("qubit.opentag.Tags",c);c.getById=function(a){return k.opentag.BaseTag.getById(String(a))};c.getAllTagsByState=function(){return k.opentag.Container.getAllTagsByState(c.getTags())};c.findTagByName=function(a){for(var d=
this.getTags(),c=[],e=0;e<d.length;e++)d[e].config.name===a&&c.push(d[e]);return c};c.findTagByMatch=function(a){for(var d=this.getTags(),c=[],e=0;e<d.length;e++)d[e].config.name.match(a)&&c.push(d[e]);return c};c.findTagContainers=function(a){for(var d=c.getContainers(),e=[],f=0;f<d.length;f++){var h=d[f].tags,k;for(k in h)if(h[k]===a){e.push(d[f]);break}}return e};c.getTags=function(){return k.opentag.BaseTag.getTags()};c.resetAllTags=function(a){for(var d=c.getTags(),e=0;e<d.length;e++)d[e].reset(),
a||d[e].resetFilters()};c.getContainersPageVariables=function(){for(var a=c.getContainers(),d=[],e=0;e<a.length;e++)d=d.concat(a.getPageVariables());return d};c.getAllPageVariables=function(){for(var a=c.getTags(),d=[],e=0;e<a.length;e++)d=d.concat(a[e].getPageVariables());return d};c.cancelAll=function(){for(var a=c.getTags(),d=0;d<a.length;d++)a[d].cancel()};c.resetAll=function(a){for(var d=c.getTags(),e=0;e<d.length;e++)d[e].reset(),a||d[e].resetFilters()};c.getPageVariableByName=function(a){for(var d=
c.getAllPageVariables(),e=[],f=0;f<d.length;f++)d[f].config.name===a&&e.push(d[f]);return e};c.getLoadTime=function(a){var d=a.beforeRun,c=a.runIsFinished;return isNaN(c)?{tag:a,loadTime:null}:{tag:a,loadTime:c-d}};c.getLoadTimes=function(a){var d=[];if(a instanceof k.opentag.BaseTag)return d.push([c.getLoadTime(a[e])]),d;a=a||c.getTags();if(a instanceof Array)for(e=0;e<a.length;e++)a[e]instanceof k.opentag.BaseTag&&d.push(c.getLoadTime(a[e]));else for(var e in a)a[e]instanceof k.opentag.BaseTag&&
d.push(c.getLoadTime(a[e]));return d};c.forceAllContainersAndTagsToRunIfDisabled=function(){k.opentag.Container.setCookieForDisabledContainersToRun();k.opentag.BaseTag.setCookieForcingTagsToRun()};c.rmAllContainersAndTagsForcingFlags=function(){k.opentag.Container.rmCookieForDisabledContainersToRun();k.opentag.BaseTag.rmAllCookiesForcingTagToRun()};c.getContainers=function(){return k.opentag.Container.getContainers()};c.findAllTagsByClassPath=function(b){var d=[],e=[];try{e.push(k.opentag.CustomTag),
e.push(k.opentag.LibraryTag)}catch(f){}for(var h=c.getTags(),n=0;n<h.length;n++){var q=h[n];0>a.indexInArray(e,q)&&0===q.PACKAGE_NAME.indexOf(b)&&d.push(q)}return d};c.findAllTags=function(a,d){var e=k.opentag.BaseTag,f=[];try{f.push(k.opentag.CustomTag),f.push(k.opentag.LibraryTag)}catch(h){}return c.findAllInstances(a,e,f,d)};var e=function(b,d,c,e){var f=[];"string"===typeof b&&(b=a.getObjectUsingPath(b));if(b){var k={objectsOnly:!0};e&&(k.maxDeep=!0);e=function(b,e,m,g){if(d(b)){for(e=0;e<c.length;e++)if(c[e]===
b)return!0;a.addToArrayIfNotExist(f,b);return!0}return!1}.bind(this);a.traverse(b,e,k)}return f};c.findAllInstances=function(a,d,c,f){return e(a,function(a){return a instanceof d},c,f)};c.findAllInheriting=function(a,d,c,f){return e(a,function(a){return a.prototype instanceof d},c,f)};c.findAllFilters=function(a,d){var e=[];try{e.push(k.opentag.filter.Filter),e.push(k.opentag.filter.URLFilter)}catch(m){}return c.findAllInheriting(a,f,e,d)}})();E={};A=void 0;E.update=function(){var a,f;f=function(){return Math.floor(1+
65536*Math.random()).toString(36).substring(1)};window.__pageViewId__||(a=(new Date).getTime().toString(36),window.__pageViewId__=a+f()+f()+f());return window.__pageViewId__};r.PostData=function(a,f,c,e){var b,d,l;b=navigator.userAgent.toLowerCase();d=-1!==b.indexOf("msie");b.indexOf("msie 9");b=-1!==b.indexOf("msie 7")||-1!==b.indexOf("msie 6");l=("https:"===document.location.protocol?"https:":"http:")+a;c=c||"POST";a=function(){var a;try{a=null;try{a=new XMLHttpRequest}catch(b){}a&&!d?a.open(c,
l,!0):"undefined"!==typeof XDomainRequest?(a=new XDomainRequest,a.open(c,l)):a=null;try{a.withCredentials=!1}catch(k){}a.setRequestHeader&&(e?a.setRequestHeader("Content-Type",e):a.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));a.onload=function(){};a.onreadystatechange=function(){};a.ontimeout=function(){};a.onerror=function(){};a.onprogress=function(){};a.send(f)}catch(q){try{try{r.fileLoader.load(l)}catch(p){window.console&&window.console.log&&window.console.log(q)}}catch(t){}}};
b?r.fileLoader.load(l):a()};(function(){function a(){}function f(a,e){var b={};b.clientId=""+e.clientId;b.containerId=""+a.getContainerId();b.classpath=""+a.PACKAGE_NAME;b.opentagStats=!0;a.sentPing?b.containerLoad=!1:(a.sentPing=(new Date).valueOf(),b.containerLoad=!0);b.isS3=!1;b.pageViewId=E.update();b.tags=[];return b}k.Define.clazz("qubit.opentag.Ping",a);a.prototype.sendErrors=function(a,e){};a.getPingID=function(a){if(a.config.id)return a.config.id;var e=a.PACKAGE_NAME.lastIndexOf(".");return-1!==
e?a.PACKAGE_NAME.substring(e+1):a.PACKAGE_NAME};a.prototype.send=function(c,e){for(var b=c.config,d=f(c,b),l=d.tags,b=b.pingServerUrl,k=0;k<e.length;k++){var h=e[k].tag,n=e[k].loadTime;if(null!==n&&!isNaN(n)){var q={},p=a.getPingID(h);!h.pingSent&&p&&null!==n&&void 0!==p&&(q.tagId=p,q.loadTime=n,q.fired=!0,l.push(q),h.pingSent=!0)}}b&&(0<l.length||d.containerLoad)&&(d=z.stringify(d),r.PostData("//"+b,d,"POST","text/plain;charset=UTF-8"))};a.prototype.sendDedupe=function(c,e){for(var b=c.config,d=
f(c,b),b=b.pingServerUrl,l=d.tags,k=0;k<e.length;k++){var h=e[k],n=a.getPingID(h),q={};void 0===n||h.dedupePingSent||(q.tagId=""+n,q.fired=!1,q.loadTime=0,l.push(q),h.dedupePingSent=!0)}b&&(0<l.length||d.containerLoad)&&(d=z.stringify(d),r.PostData("//"+b,d,"POST","text/plain;charset=UTF-8"))}})();A={_cookieName:"_qst_s",_sessionCookie:"_qsst_s",update:function(a){var f,c;f=k.Cookie.get(A._cookieName);c=k.Cookie.get(A._sessionCookie);if(f){if(f=parseInt(f,10),!c||parseInt(c,10)<(new Date).getTime()-
18E5)f+=1}else f=1;k.Cookie.set(A._cookieName,f,365,a);k.Cookie.set(A._sessionCookie,(new Date).getTime().toString(),null,a);return f}};var z={};(function(){function a(a){return 10>a?"0"+a:a}function f(a){b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(a){var b=k[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(b,e){var k,m,g,s,v=d,w,u=e[b];if(u instanceof Date)k=u,u=isFinite(k.valueOf())?k.getUTCFullYear()+"-"+a(k.getUTCMonth()+
1)+"-"+a(k.getUTCDate())+"T"+a(k.getUTCHours())+":"+a(k.getUTCMinutes())+":"+a(k.getUTCSeconds())+"Z":null;else if(u instanceof String||u instanceof Number||u instanceof Boolean)u=u.valueOf();"function"===typeof h&&(u=h.call(e,b,u));switch(typeof u){case "string":return f(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);case "object":if(!u)return"null";d+=l;w=[];if("[object Array]"===Object.prototype.toString.apply(u)){s=u.length;for(k=0;k<s;k+=1)try{w[k]=
c(k,u)||"null"}catch(r){w[k]='{"stack_exceeded": null}'}g=0===w.length?"[]":d?"[\n"+d+w.join(",\n"+d)+"\n"+v+"]":"["+w.join(",")+"]";d=v;return g}if(h&&"object"===typeof h)for(s=h.length,k=0;k<s;k+=1){if("string"===typeof h[k]){m=h[k];try{g=c(m,u)}catch(x){g='{"stack_exceeded": null}'}g&&w.push(f(m)+(d?": ":":")+g)}}else for(m in u)if(Object.prototype.hasOwnProperty.call(u,m)){try{g=c(m,u)}catch(y){g='{"stack_exceeded": null}'}g&&w.push(f(m)+(d?": ":":")+g)}g=0===w.length?"{}":d?"{\n"+d+w.join(",\n"+
d)+"\n"+v+"}":"{"+w.join(",")+"}";d=v;return g}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d,l,k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h;"function"!==typeof z.stringify&&(z.stringify=function(a,b,e){var f;l=d="";if("number"===typeof e)for(f=0;f<e;f+=1)l+=" ";else"string"===
typeof e&&(l=e);if((h=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!==typeof z.parse&&(z.parse=function(a,b){function d(a,c){var e,f,l=a[c];if(l&&"object"===typeof l)for(e in l)Object.prototype.hasOwnProperty.call(l,e)&&(f=d(l,e),void 0!==f?l[e]=f:delete l[e]);return b.call(a,c,l)}var c;a=String(a);e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));
if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+a+")"),"function"===typeof b?d({"":c},""):c;throw new SyntaxError("JSON.parse");})})();(function(){var a=k.Cookie,f=k.opentag.Utils,c=function(){};k.Define.clazz("qubit.opentag.Session",c);var e=new k.opentag.compression.CookieCompressor({});c.readCompressedCookie=function(b){b=a.get(b,!0);
return e.decompress(b)};c.setupSession=function(b){var d=b.config,l,k,h,n,q;l={};l.sessionCount=A.update(d.cookieDomain);q="qtag_"+b.getContainerId();var p="x_qtag_"+b.getContainerId();h=a.get(q);b=!!h;null===h&&(h=a.get(p,!0),h=e.decompress(h));if(h)try{h=z.parse(h)}catch(r){h={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else h={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};k=(new Date).getTime();l.sessionCount!==
parseInt(h.sc,10)?(h.sessionStartTime=k,h.sc=l.sessionCount,h.sessionCount+=1,h.referrer.push({url:c.getReferrer(),landing:f.getUrl().substring(0,300),time:k}),h.sessionLandingPage=f.getUrl().substring(0,300)):c.isReferrerDifferent()&&!c.referrerIsSameAsPrevious(h.referrer,k,18E5)&&(h.referrer.push({url:c.getReferrer(),landing:f.getUrl().substring(0,300),time:k}),h.sessionLandingPage=f.getUrl().substring(0,300),h.sessionStartTime=k,h.sessionCount+=1);l.sessionCount=h.sessionCount;l.sessionStartTime=
h.sessionStartTime;l.pageStartTime=k;h.pageViews+=1;l.pageViews=h.pageViews;l.sessionLandingPage=h.sessionLandingPage;l.referrer=h.referrer;5<l.referrer.length&&l.referrer.splice(2,l.referrer.length-5);n=z.stringify(h);for(k=0;e.compress(n).length>d.maxCookieLength&&5>k;)3<=h.referrer.length?h.referrer.splice(2,1):2===h.referrer.length?h.referrer=[h.referrer[0]]:1===h.referrer.length&&(h.referrer=[]),n=z.stringify(h),k+=1;l.referrer=h.referrer;b&&a.rm(q);q=e.compress(n);a.rm(p);0<d.maxCookieLength&&
a.set(p,q,365,d.cookieDomain,!0);l.setVariable=function(b,c,f){h.__v[b]=[c,f?f:0];b=e.compress(z.stringify(h));0<d.maxCookieLength?a.set(p,b,365,d.cookieDomain,!0):a.rm(p)};l.getCookie=function(b,d){var c=a.get(b,!0);if(c&&(d||0===b.indexOf("x_")))try{c=e.decompress(c)}catch(f){}else null!==c&&(c=a.decode(c));return c};l.getVariable=function(a){var b;if(a=h.__v[a])if(b=a[1],0===b||b>(new Date).getTime())return a[0];return null};l.on=function(a,b,d){b.attachEvent?b.attachEvent("on"+a,d):b.addEventListener&&
b.addEventListener(a,d,!1)};l.getTagCookie=function(){return c.readCompressedCookie(p)};return c.lastSession=l};c.referrerIsSameAsPrevious=function(a,d,e){var k,h;return 0<a.length?(k=c.getReferrer(),h=f.getUrl().substring(0,300),a=a[a.length-1],a.url===k&&a.landing===h&&a.time+e>d):!1};c.isReferrerDifferent=function(){var a,d;d=c.getReferrer();a=d.indexOf("://");if(-1===a)return!0;try{return 0!==d.substring(a+3).indexOf(c.getDomain())?!0:!1}catch(e){return!0}};c.getReferrer=function(){return document.referrer?
document.referrer.substring(0,300):"direct"};c.getDomain=function(){return document.location.host}})();(function(){function a(){}var f=k.opentag.LibraryTag,c=k.Define;a.library=function(){return f.define.apply(f,arguments)};a.libraryRef=function(){return f.getLibraryByClasspath.apply(f.getLibraryByClasspath,arguments)};c.namespace("qubit.Quick",a)})();(function(){function a(b){this.runQueue=[];this.tags=[];this.config={cookieDomain:"",maxCookieLength:1E3,gzip:!0,delayDocWrite:!1,clientId:"",name:"",
tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:!1,containerId:"",scanTags:!1,noPings:!1,restartable:!0};this.ignoreTagsState=!1;if(b){this.setConfig(b);b.name||(this.config.name="Cont-"+q++);a.register(this);a.NO_PINGS&&(this.config.noPings=!0);this.ping=new k.opentag.Ping(this.config);this._sendPingsTrigger=this.sendPings.bind(this);if(b.init)try{b.init.call(this,b)}catch(d){}var c=this;this._tagLoadedHandler=function(a){c._containerAlreadySentPings&&c.sendPingsNotTooOften()}}this.events=
new k.Events({});return this}function f(a,b,d,c){a[d]&&(c[d]=c[d]+1||1,d+="("+c[d]+")");a[d]=b}var c=k.opentag.Utils,e=k.opentag.filter.BaseFilter,b=k.opentag.filter.Filter,d=k.opentag.BaseTag,l=k.opentag.Timed,m=k.opentag.Tags,h=k.opentag.Session,n=k.Cookie,q=1;try{window.opentag_consentGiven=function(){a.consentIsGiven=!0;for(var b=a.getContainers(),d=0;d<b.length;d++)try{b[d].run()}catch(c){}}.bind(this)}catch(p){}k.Define.clazz("qubit.opentag.Container",a);var r=[];a.prototype.EVENT_TYPES={RESTART_EVENT:"restart"};
a.register=function(a){c.addToArrayIfNotExist(r,a)};a.prototype.isTellingLoadTimes=function(){var a=this.config.tellLoadTimesProbability;null===a&&(a=0);return a>Math.random()};a.prototype.destroy=function(a){this.destroyed=!0;this.unregister();for(var b=0;b<this.tags.length;b++){var c=this.tags[b];c.owningContainer===this&&(c.owningContainer=null,a&&c instanceof d&&c.destroy())}this.tags=[]};a.destroyAll=function(b){for(var d=a.getContainers(),c=0;c<d.length;c++)d[c].destroy(b)};a.findContainersByName=
function(b){for(var d=a.getContainers(),c=[],e=0;e<d.length;e++)d[e].config.name===b&&c.push(d[e]);return c};a.getById=function(b){for(var d=a.getContainers(),c=0;c<d.length;c++)if(d[c].getContainerId()===b)return d[c];return null};a.prototype.unregister=function(b){a.unregister(this,b)};a.unregister=function(a,b){c.addToArrayIfNotExist(r,a);c.removeFromArray(r,a);if(b){for(var e=0;e<a.tags.length;e++){var f=a.tags[e];f.owningContainer===a&&(f.owningContainer=null,f instanceof d&&f.unregister())}a.tags=
[]}};a.prototype.hasConsent=function(){return"Accepted"===n.get("qubitconsent")};a.prototype.register=function(b){a.register(b||this)};a.getContainers=function(){return r};a.prototype.getContainers=function(){return a.getContainers()};a.prototype.onTagRegistered=function(a){};a.prototype.registerTag=function(a){if(null!==a.owningContainer)return!1;this.tags.push(a);a.owningContainer=this;a.onAfter(this._tagLoadedHandler);try{this.onTagRegistered(a)}catch(b){}return!0};a.prototype.unregisterTag=function(a){a.owningContainer===
this&&(a.owningContainer=null);for(var b=0;b<this.tags.length;)this.tags[b]===a?this.tags.splice(b,1):b++};a.prototype.registerTags=function(a){for(var b=0;b<a.length;b++)this.registerTag(a[b])};a.prototype.setConfig=function(a){for(var b in a)this.config[b]=a[b]};a.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};a.prototype.runWithoutFilters=function(){this.runTags({command:"run"})};a.prototype.containerScriptLoadedSynchronously=function(){var a,b,d,c,e;c=document.getElementsByTagName("script");
a=0;for(b=c.length;a<b;a+=1)if(d=c[a],(e=d.getAttribute("src"))&&0<e.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js"))return null===d.getAttribute("async")&&(!1===d.getAttribute("defer")||""===d.getAttribute("defer")||null===d.getAttribute("defer"));return!0};a.prototype.prepareSessionIfNeeded=function(){var d=this.config.trackSession;if(!0!==d&&!1!==d)for(d=0;d<this.tags.length;d++){var c=this.tags[d];c.resolveAllDynamicData();for(var c=c.getFilters(),e=0;e<c.length;e++){var f=c[e];
if(f instanceof b&&f.isSession()){this.trackSession=!0;break}}if(this.trackSession)break}else this.trackSession=d;a.TRACK_SESSION&&(this.trackSession=!0);this.trackSession&&(this.session=h.setupSession(this))};a.runtimeCounter=a.runtimeCounter||1;a.prototype.runTags=function(b,d){if(this.destroyed)throw"Container has been destroyed.";if(d||!a.LOCKED&&!c.global().QUBIT_CONTAINERS_LOCKED){if(this.onBeforeRun)try{this.onBeforeRun()}catch(e){}var f=!this.containerScriptLoadedSynchronously(),h="runIfFiltersPass";
b&&b.command&&(h=b.command);this.runningStarted=(new Date).valueOf();this.config.scanTags&&!this._scanned&&(this.scanForTags(),this._scanned=(new Date).valueOf());this.prepareSessionIfNeeded();for(var k=this.getTagsInOrder(),m="___otctnmk"+a.runtimeCounter++,n=0;n<k.length;n++)try{var p=k[n];this.includedToRun(p)&&this._checkAndRun(p,h,f,m)}catch(q){}l.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),3100);this.waitForAllTagsToFinish();for(f=0;f<k.length;f++)k[f]._runtimeMarkers[m]=void 0,
delete k[f]._runtimeMarkers[m]}};a.prototype.getTagsInOrder=function(){for(var a=[],b=0;b<this.tags.length;b++){var d=this.tags[b],c=d.config.priority;if(0<+c){for(var e=0,f=0;f<a.length;f++){var l=a[f];if(l)if(l=+l.config.priority,0<l&&l>c)e++;else break}a.splice(e,0,d)}else a.push(d)}return a};a.prototype._checkAndRun=function(a,b,d,c){if(!a._runtimeMarkers[c]){a._runtimeMarkers[c]=!0;var e=a.resolveDependencies();if(0<e.length)for(var f=0;f<e.length;f++)this._checkAndRun(e[f],b,d,c);this._tagRunner(a,
b,d)}};a.prototype._tagRunner=function(a,b,d){try{this.includedToRun(a)&&(d&&(a.forceAsynchronous=!0),this.config.delayDocWrite&&(a.delayDocWrite=!0),a.session=a.session||this.session,a[b]())}catch(c){}};a.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;if(this._pkgName)return this._pkgName;var a=this.PACKAGE_NAME.split(".");return this._pkgName=a=a[a.length-1]};a.prototype.includedToRun=function(b){if(!b)return!1;var c=b.config;if(c.inactive||c.disabled&&
!b.cookieSaysToRunEvenIfDisabled()||b.disabledByCookie())return!1;c=a.consentIsGiven||!c.needsConsent||this.hasConsent();b=b.state===d.prototype.STATE.INITIAL;return this.ignoreTagsState||c&&b};a.prototype.scanForTags=function(a,b){a&&(this.tags=[]);var d;d=b&&"object"===typeof b?this.findAllTags(b):this.findAllTagsByClassPath();this.registerTags(d);return d};a.prototype.findAllTags=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return m.findAllTags(a,b)};a.prototype.findAllTagsByClassPath=
function(a){a=a||this.PACKAGE_NAME;return m.findAllTagsByClassPath(a)};a.prototype.findAllFilters=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return m.findAllFilters(a,b)};a.prototype.waitForAllTagsToFinish=function(){if(!this._waitForAllTagsToFinishWaiting){this._lastWaited||(this._lastWaited=(new Date).valueOf());var a=15E3<(new Date).valueOf()-this._lastWaited,a=this.allTagsFinished()||a;if(!this._showFinishedOnce&&a){if(this._lastWaited=null,this._showFinishedOnce=!0,this.runningFinished=
(new Date).valueOf(),this._containerAlreadySentPings=(new Date).valueOf(),this.sendPingsNotTooOften(),this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else a||(this._waitForAllTagsToFinishWaiting=!0,this._showFinishedOnce=!1,l.setTimeout(function(){this._waitForAllTagsToFinishWaiting=!1;this.waitForAllTagsToFinish()}.bind(this),100))}};a.prototype.onTagsInitiallyRun=x;a.prototype.resetAllTags=function(a){for(var b=0;b<this.tags.length;b++)this.tags[b].reset(),a||this.tags[b].resetFilters()};a.prototype._prepareTagsToRestart=
function(a){for(var b=0;b<this.tags.length;b++)this.tags[b].prepareForRestart(a)};a.prototype.reset=function(a,b){this._showFinishedOnce=this.runningStarted=this._waitForAllTagsToFinishWaiting=this.runningFinished=void 0;a||this.resetAllTags(b)};a.prototype.onRestart=function(a){this.events.on("restart",a)};a.prototype.restart=function(a,b){this.config.restartable&&(this.events.call("restart",this),this.reset(!0,!0),a||this._prepareTagsToRestart(b),this.run())};a.restartAll=function(b,d){for(var c=
a.getContainers(),e=0;e<c.length;e++)try{c[e].restart(b,d)}catch(f){log.ERROR("Restart failed for container "+c[e].config.name,f)}};a.resetAll=function(b,d){for(var c=a.getContainers(),e=0;e<c.length;e++)try{c[e].reset(b,d)}catch(f){log.ERROR("Reset failed for container "+c[e].config.name,f)}};a.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};l.runIfNotScheduled(this._sendPingsTrigger,2E3,this._sndLck)};a.prototype.sendPings=function(){if(!this.config.noPings){var a;if(this.isTellingLoadTimes()){var b=
this.getAllTagsByState(),d=[];b.run&&(d=m.getLoadTimes(b.run));this.lastPingsSentTime=(new Date).valueOf();this.ping.send(this,d);var d=m.getLoadTimes(),c=[];for(a=0;a<d.length;a++){var e=d[a].tag;e.config.dedupe&&e.sendDedupePing&&c.push(e)}0<c.length&&(this.lastDedupePingsSentTime=(new Date).valueOf(),this.ping.sendDedupe(this,c));if(b.other){d=m.getLoadTimes(b.other);c=[];for(a=0;a<d.length;a++)c.push(d[a]);0<c.length&&this.ping.send(this,c)}if(b.awaiting){d=m.getLoadTimes(b.awaiting);b=[];for(a=
0;a<d.length;a++)b.push(d[a]);0<b.length&&this.ping.send(this,b)}}else this.ping.send(this,[])}};a.prototype.getAllTagsByState=function(){return a.getAllTagsByState(this.tags)};a.getAllTagsByState=function(a){for(var b=null,c=null,l=null,h=null,k=null,m=null,n={},p=d.prototype.STATE.EXECUTED_WITH_ERRORS,q=0;q<a.length;q++){var r=a[q];if(r instanceof d){var t=r.config.name;0<r.scriptExecuted?(b=b||{},f(b,r,t,n)):r.locked?(m=m||{},f(m,r,t,n)):0>r.scriptExecuted||r.state>=p?(h=h||{},f(h,r,t)):r.filtersState()===
e.state.SESSION||0<r.filtersState()?(l=l||{},f(l,r,t,n)):r.config.needsConsent?(k=k||{},f(k,r,t,n)):(c=c||{},f(c,r,t,n))}}return{run:b,failed:h,awaiting:l,consent:k,locked:m,other:c}};a.prototype.allTagsFinished=function(){for(var a=0;a<this.tags.length;a++){var b=this.tags[a];if(b instanceof k.opentag.BaseTag){var d=b.filtersState();if(!b.config.disabled){var c=0>b.filtersState()&&!b.locked,f=!(b.finished()||b.config.runner&&!b.isRunning);if(c&&f&&(b=0<+b.awaitingDependencies,d!==e.state.SESSION&&
!b))return!1}}}return!0};a.prototype.getPageVariables=function(){for(var a=[],b=0;b<this.tags.length;b++)for(var d=this.tags[b].getPageVariables(),e=0;e<d.length;e++)c.addToArrayIfNotExist(a,d[e]);return a};a.getPageVariableByName=function(a){for(var b=this.getAllPageVariables(),d=[],c=0;c<b.length;c++)b[c].config.name===a&&d.push(b[c]);return d};a.prototype._getCookieNameForDisabling=function(){return"qubit.opentag.disableContainerRunning_"+this.getContainerId()+this.config.name};a.prototype.disabledByCookie=
function(){return!!n.getCached(this._getCookieNameForDisabling())};a.prototype.setCookieToDisable=function(){n.set(this._getCookieNameForDisabling(),"true");n.resetCache()};a.prototype.rmCookieToDisable=function(){n.rm(this._getCookieNameForDisabling());n.resetCache()};a.rmAllDisablingCookies=function(){c.rmCookiesMatching("qubit.opentag.disableContainerRunning_");n.resetCache()};a.setCookieForDisabledContainersToRun=function(){n.set("qubit.opentag.forceContainerRunning","true");n.resetCache()};a.rmCookieForDisabledContainersToRun=
function(){n.rm("qubit.opentag.forceContainerRunning");n.resetCache()}})();(function(){var a={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null},f,c="universal_variable";a._isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a._targetChanged=function(c,b,d){if(null===d)return"null"===b?!1:!0;if(void 0===d)return b===d?!1:!0;b=z.parse(b);b=a._getNested(b,c);c=a._getNested(d,c);return!a._jsonIsEqual(b,c)};a._processCallbacks=function(){var c;if(a.early_callbacks&&
0<a.early_callbacks.length){for(c=0;c<a.early_callbacks.length;c+=1)a.push(a.early_callbacks[c]);a.early_callbacks=null}};a._keyStringToArr=function(a){a=a.replace(/^\s+/,"").replace(/\s+$/,"");if(""===a)return[];a=a.replace(/\[(\w+)\]/g,".$1");a=a.replace(/^\./,"");return a.split(".")};a._getNested=function(c,b){for(var d=a._keyStringToArr(b),f;0<d.length;)if(f=d.shift(),c.hasOwnProperty(f))c=c[f];else return;return c};a._jsonIsEqual=function(c,b){"string"!==typeof c&&(c=z.stringify(c,a._stripEvents));
"string"!==typeof b&&(b=z.stringify(b,a._stripEvents));return c===b};a._stripEvents=function(a,b){if("events"!==a)return b};a._on=function(c,b){var d;d=c.split(":");c=d[0];d=d[1];a.callbacks[c]=a.callbacks[c]||[];d?a.callbacks[c].push({keyString:d,func:b}):a.callbacks[c].push({func:b})};a._trigger=function(c,b){var d,l;if(a.callbacks[c])for(d=0;d<a.callbacks[c].length;d+=1)"function"===typeof a.callbacks[c][d].func&&((l=a.callbacks[c][d].keyString)?"change"===c&&a._targetChanged(l,a.currentUV,f)&&
a.callbacks[c][d].func(b):a.callbacks[c][d].func(b))};a._eventsPush=function(c){var b,d;f.events[f.events.length]=c;c.time=c.time||(new Date).getTime();if(a.callbacks.event)for(b=0,d=a.callbacks.event.length,b;b<d;b+=1)a.callbacks.event[b].func(c);c.has_fired=!0};a._getUnfiredEvents=function(){for(var c=0,c=0;c<f.events.length;c+=1)f.events[c].has_fired||(a.unfired_events.push(f.events.splice(c,1)[0]),c-=1)};a._fireEvents=function(){for(;0<a.unfired_events.length;)f.events.push(a.unfired_events.shift())};
a._resetEventsPush=function(){f.events=f.events||[];-1!==f.events.push.toString().indexOf("[native code]")&&(f.events.push=a._eventsPush,a._getUnfiredEvents(),a._fireEvents())};a._checkForChanges=function(){a.callbacks.change&&0<a.callbacks.change.length&&!a._jsonIsEqual(a.currentUV,f)&&(a._trigger("change",f),a.currentUV=z.stringify(f,a._stripEvents))};a._setUVLocation=function(e){c=e;a._initUV()};a._initUV=function(){window[c]=window[c]||{events:[]};f=window[c];f.events||(f.events=[])};a.push=function(c){a._isArray(c)&&
("on"===c[0]?a._on(c[1],c[2]):"trigger"===c[0]&&c[1]&&a._trigger(c[1]))};a.init=function(e,b){b&&(c=b);a._initUV();!window.uv_listener||a._isArray(window.uv_listener)?(a.early_callbacks=window.uv_listener||null,window.uv_listener=a,e||a.start()):b&&window.uv_listener._setUVLocation(c)};a.start=function(){a.currentUV=z.stringify(f,a._stripEvents);setInterval(function(){a._initUV();a._resetEventsPush();a._checkForChanges()},500);a._processCallbacks()};r.UVListener=a})();(function(){function a(){}function f(a,
b,c){!c||void 0!==a[b]&&""!==a[b]&&null!==a[b]||(a[b]=c)}function c(a){var c=a.PACKAGE_NAME.split("."),c=c[c.length-1];a=b.getParentObject(a.PACKAGE_NAME);a[c]=null;delete a[c]}var e=k.Cookie,b=k.opentag.Utils;k.opentag.Log.setLevelFromCookie();a.run=function(){var b=!1,c;a:{try{var f=y.TAGSDK_MAIN_DISABLED_FUNCTION;if(f&&f()){c=!0;break a}}catch(h){}c=0<=document.location.href.indexOf("opentag_disabled=true")?!0:!1}if(!c){c=!1;if(e.get("opentag_debug_tool")||0<=document.location.href.indexOf("opentag_debug_tool"))c=
!0;!c&&(c=!1,e.get("opentag_debug")||0<=document.location.href.indexOf("opentag_debug"))&&(c=!0);c&&(y.TAGSDK_NS_OVERRIDE=k.DEBUG_MODE?!1:!0,b=!0);k.DEBUG_MODE&&(y.TAGSDK_NS_OVERRIDE=!1);try{r.UVListener.init()}catch(n){}a.runAllContainers(b)}};a.runAllContainers=function(d){try{for(var e=k.opentag.Container.getContainers(),m=0;m<e.length;m++){var h=e[m],n=h.config;if(!h.runningStarted&&!h.configuredInMain){n.scanTags=!0;var q=b.getParentObject(h.PACKAGE_NAME).ClientConfig;q&&f(h.config,"clientId",
q.id);var p=b.getParentObject(h.PACKAGE_NAME).SystemDefaults;p&&(f(n,"pingServerUrl",p.pingServerUrl),f(n,"tellLoadTimesProbability",p.tellLoadTimesProbability));h.configuredInMain=!0;d?(h.destroy(!0),c(h),a.loadDebugVersion(h)):y.QUBIT_OPENTAG_STOP_MAIN_EXECUTION?function(){var a=k.opentag.RUN_STOPPED_EXECUTON;k.opentag.RUN_STOPPED_EXECUTON=function(){try{a&&a()}finally{h.run()}}}(h):h.run()}}}catch(r){}};a.loadDebugVersion=function(a){var c=document.createElement("script"),e,f=a.config.scriptURL,
k;(k=b.getParentObject(a.PACKAGE_NAME).ClientConfig)&&k.clientId?k=k.clientId:(k=a.PACKAGE_NAME.split("."),k=k[k.length-2].substring(1));a=a.getContainerId();f&&(e=f,e.lastIndexOf("-debug.js")!==e.length-9&&(e=e.substring(0,e.length-3),e+="-debug.js"));c.src=e&&"//d3c3cq33003psk.cloudfront.net/opentag-"+k+"-"+a+"-debug.js"!==e?e:"//s3-eu-west-1.amazonaws.com/opentag/opentag-"+k+"-"+a+"-debug.js";document.getElementsByTagName("head")[0].appendChild(c)};k.Define.namespace("qubit.opentag.Main",a)})()})();
