(function(){var K,D;(function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var l=Array.prototype.slice.call(arguments,1),k=this,b=function(){},d=function(){return k.apply(this instanceof b?this:a,l.concat(Array.prototype.slice.call(arguments)))};b.prototype=this.prototype;d.prototype=new b;return d})})();var G={__anonymous__:!0},A=null;try{A=(0,eval)("this")||
function(){return this}()}catch(P){}var G=A,g=G.qubit||{};G.qubit||(G.qubit=g);g.VERSION="3.0.0";try{module.exports=G}catch(S){}var v=function(){},r;K={};D=void 0;K.update=function(){var a,l;l=function(){return Math.floor(1+65536*Math.random()).toString(36).substring(1)};window.__pageViewId__||(a=(new Date).getTime().toString(36),window.__pageViewId__=a+l()+l()+l());return window.__pageViewId__};(function(){function a(){}function l(b,d,c,f,h){b=b.split(".");var e=a.NAMESPACE_BASE||G,m=null,k=null;
h&&(e=A);h=e;e=c||e;for(c=0;c<b.length-1;c+=1)k=b[c],e[k]=e[k]||{},e=e[k];m=e;k=b[b.length-1];A.TAGSDK_NS_OVERRIDE&&(f=!1);void 0!==d?void 0!==m[k]&&f||(m[k]=d):m[k]=m[k]||{};d&&(d.CLASSPATH=b.join("."),b.splice(b.length-1,1),d.PACKAGE_NAME=b.join("."));return{root:h,object:m,instance:m[k]}}a.global=function(){return A};a.clientSpaceClasspath=function(){return window.qubit.CLIENT_CONFIG?"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id:"qubit.cs"};a.globalNamespace=function(a,d,c,f){return l(a,d,c,f,!0)};
a.namespace=function(a,d,c,f){return l(a,d,c,f,!1)};a.clientNamespace=function(b,d,c,f){return a.namespace(a.clientSpaceClasspath()+"."+b,d,c,f)};a.clazz=function(b,d,c,f,h){a.namespace(b,d,f,!0);"function"===typeof c&&(d.SUPER=c,d.superclass=c,d.prototype=new c(h),d.prototype.SUPER=c,d.prototype.CLASS=d);b=b.split(".");d.prototype?(d.prototype.CLASSPATH=b.join("."),d.prototype.CLASS_NAME=b[b.length-1],b.splice(b.length-1,1),d.prototype.PACKAGE_NAME=b.join(".")):(d.CLASSPATH=b.join("."),d.STATIC_NAME=
b[b.length-1],b.splice(b.length-1,1),d.PACKAGE_NAME=b.join("."));return d};a.clazz("qubit.Define",a);a.clientClazz=function(b,d,c,f,h){return a.clazz(a.clientSpaceClasspath()+"."+b,d,c,f,h)};a.vendorsSpaceClasspath=function(){var a=g.VENDOR_SPACE_CP;return void 0===a||null===a?"qubit.vs":a};var k=a.namespace(a.vendorsSpaceClasspath(),{},null,!0).instance;a.getVendorSpace=function(){return k};a.vendorNamespace=function(b,d,c,f){return a.namespace(a.vendorsSpaceClasspath()+"."+b,d,c,f)};a.vendorClazz=
function(b,d,c,f,h){return a.clazz(a.vendorsSpaceClasspath()+"."+b,d,c,f,h)}})();(function(){function a(a){}for(var l={},k=0;93>k;k++)l["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=".charAt(k)]=k;g.Define.clazz("qubit.Cookie",a);a.cookieAlphabet="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=";a.cookieAlphabetMap=l;a.decode=function(a){return unescape(a)};a.encode=function(a){return escape(a)};a.set=
function(b,d,c,f,h){if(c){var e=new Date;e.setTime(e.getTime()+864E5*c);c="; expires="+e.toGMTString()}else c="";h||(b=a.encode(b),d=a.encode(d));b=b+"="+d+c+"; path=/;";f&&(b+=" domain="+f);document.cookie=b};a.get=function(b,d){for(var c=b+"=",f=document.cookie.split(";"),h=0;h<f.length;h++){for(var e=f[h];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(c))return c=e.substring(c.length,e.length),d||(c=a.decode(c)),c}return null};a.getAllForName=function(b,d){if(!b)return[];for(var c=
b+"=",f=document.cookie.split(";"),h=[],e=0;e<f.length;e++){for(var m=f[e];" "===m.charAt(0);)m=m.substring(1,m.length);0===m.indexOf(c)&&(m=m.substring(c.length,m.length),d&&(m=a.decode(m)),h.push(m))}return h};a.getAll=function(b){for(var d=document.cookie.split(";"),c=[],f=0;f<d.length;f++){for(var h=d[f];" "===h.charAt(0);)h=h.substring(1,h.length);var e=h.substring(0,h.indexOf("=")),h=h.substring(e.length+1,h.length);b&&(h=a.decode(h));c.push([e,h])}return c};a.rm=function(b,d){a.set(b,"",-1,
d)}})();D={_cookieName:"_qst_s",_sessionCookie:"_qsst_s",update:function(a){var l,k;l=g.Cookie.get(D._cookieName);k=g.Cookie.get(D._sessionCookie);if(l){if(l=parseInt(l,10),!k||parseInt(k,10)<(new Date).getTime()-18E5)l+=1}else l=1;g.Cookie.set(D._cookieName,l,365,a);g.Cookie.set(D._sessionCookie,(new Date).getTime().toString(),null,a);return l}};r=r||{};r.fileLoader={};r.fileLoader.load=function(a,l,k,b,d,c){var f,h,e,m;m=!1;e=function(b){return function(){m||(m=!0,b&&!h&&(h={url:document.location.href}),
k(a,h,b))}};try{l&&(f=l(a))}catch(g){f=!1,k(a,"Exception loading pre",!0)}finally{!1!==f&&(l=r.fileLoader.createScriptEl(a,d,!1,c),k&&(l.onload=e(!1),l.onerror=e(!0),l.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||setTimeout(function(){e(!1)()},1)}),b||(b=window.document.getElementsByTagName("head")[0]),b.appendChild(l))}};r.fileLoader.createScriptEl=function(a,l,k,b){var d,c=document.createElement("script");c.type="text/javascript";c.src=r.fileLoader.tidyUrl(a)+
(k?"?"+(new Date).getTime():"");!1!==l?(c.async="true",c.defer="true"):(c.async="false",!1!==c.async&&(c.async=!1),c.defer="false");for(d in b)b.hasOwnProperty(d)&&c.setAttribute(d,b[d]);return c};r.fileLoader.tidyUrl=function(a){return"http:"===a.substring(0,5)||"https:"===a.substring(0,6)?a:"//"+a};r.GlobalEval={};r.GlobalEval.globalEval=function(a){window.execScript?window.execScript(a):window.eval.call(window,a)};r.HtmlInjector={};r.HtmlInjector.inject=function(a,l,k,b,d){var c,f,h,e;if(0<=k.toLowerCase().indexOf("<script")){d=
document.createElement("div");d.innerHTML="a"+k;f=d.getElementsByTagName("script");h=[];k=0;for(c=f.length;k<c;k+=1)h.push(f[k]);e=[];k=0;for(c=h.length;k<c;k+=1){f=h[k];var m={attributes:r.HtmlInjector.getAttributes(f)};f.src?m.src=f.src:m.script=f.innerHTML;e.push(m);f.parentNode.removeChild(f)}d.innerHTML&&0<d.innerHTML.length&&(d.innerHTML=d.innerHTML.substring(1));r.HtmlInjector.doInject(a,l,d);r.HtmlInjector.loadScripts(e,0,b,a)}else d=document.createElement("div"),d.innerHTML=k,r.HtmlInjector.doInject(a,
l,d),b&&b()};r.HtmlInjector.doInject=function(a,l,k){if(0<k.childNodes.length){for(var b=document.createDocumentFragment();0<k.childNodes.length;)b.appendChild(k.removeChild(k.childNodes[0]));l?r.HtmlInjector.injectAtStart(a,b):r.HtmlInjector.injectAtEnd(a,b)}};r.HtmlInjector.injectAtStart=function(a,l){0===a.childNodes.length?a.appendChild(l):a.insertBefore(l,a.childNodes[0])};r.HtmlInjector.injectAtEnd=function(a,l,k){k||(k=1);a===document.body&&"complete"!==document.readyState&&50>k?setTimeout(function(){r.HtmlInjector.injectAtEnd(a,
l,k+1)},100):a.appendChild(l)};r.HtmlInjector.loadScripts=function(a,l,k,b){var d,c,f=!1;for(d=a.length;l<d;l+=1)if(c=a[l],c.src){f=!0;break}else r.GlobalEval.globalEval(c.script);f&&r.fileLoader.load(c.src,null,function(){r.HtmlInjector.loadScripts(a,l+1,k,b)},b,!1,c.attributes);k&&l===d&&k()};r.HtmlInjector.getAttributes=function(a){var l,k,b,d,c={};if(a){k=a.attributes;l=k.length;for(a=0;a<l;a++)b=k[a].value,d=k[a].name.toLowerCase(),""===b||"id"!==d&&"class"!==d&&"charset"!==d&&"data-"!==d.substr(0,
5)||(c[d]=b);return c}};var z={};(function(){function a(a){return 10>a?"0"+a:a}function l(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=h[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function k(b,d){var p,h,q,s,n=c,w,t=d[b];if(t instanceof Date)p=t,t=isFinite(p.valueOf())?p.getUTCFullYear()+"-"+a(p.getUTCMonth()+1)+"-"+a(p.getUTCDate())+"T"+a(p.getUTCHours())+":"+a(p.getUTCMinutes())+":"+a(p.getUTCSeconds())+"Z":null;else if(t instanceof
String||t instanceof Number||t instanceof Boolean)t=t.valueOf();"function"===typeof e&&(t=e.call(d,b,t));switch(typeof t){case "string":return l(t);case "number":return isFinite(t)?String(t):"null";case "boolean":case "null":return String(t);case "object":if(!t)return"null";c+=f;w=[];if("[object Array]"===Object.prototype.toString.apply(t)){s=t.length;for(p=0;p<s;p+=1)try{w[p]=k(p,t)||"null"}catch(B){w[p]='{"stack_exceeded": null}'}q=0===w.length?"[]":c?"[\n"+c+w.join(",\n"+c)+"\n"+n+"]":"["+w.join(",")+
"]";c=n;return q}if(e&&"object"===typeof e)for(s=e.length,p=0;p<s;p+=1){if("string"===typeof e[p]){h=e[p];try{q=k(h,t)}catch(g){q='{"stack_exceeded": null}'}q&&w.push(l(h)+(c?": ":":")+q)}}else for(h in t)if(Object.prototype.hasOwnProperty.call(t,h)){try{q=k(h,t)}catch(T){q='{"stack_exceeded": null}'}q&&w.push(l(h)+(c?": ":":")+q)}q=0===w.length?"{}":c?"{\n"+c+w.join(",\n"+c)+"\n"+n+"}":"{"+w.join(",")+"}";c=n;return q}}var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,f,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},e;"function"!==typeof z.stringify&&(z.stringify=function(a,b,d){var h;f=c="";if("number"===typeof d)for(h=0;h<d;h+=1)f+=" ";else"string"===typeof d&&(f=d);if((e=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return k("",{"":a})});"function"!==
typeof z.parse&&(z.parse=function(a,c){function d(a,s){var n,b,e=a[s];if(e&&"object"===typeof e)for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(b=d(e,n),void 0!==b?e[n]=b:delete e[n]);return c.call(a,s,e)}var e;a=String(a);b.lastIndex=0;b.test(a)&&(a=a.replace(b,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return e=eval("("+a+")"),"function"===typeof c?d({"":e},""):e;throw new SyntaxError("JSON.parse");})})();r.PostData=function(a,l,k){var b,d,c,f,h,e,m;m=2;h=!1;e=function(){0<m&&setTimeout(function(){h||(m-=1,b())},5E3)};d=navigator.userAgent.toLowerCase();c=-1!==d.indexOf("msie");d.indexOf("msie 9");d=-1!==d.indexOf("msie 7")||-1!==d.indexOf("msie 6");f=("https:"===document.location.protocol?"https:":"http:")+a;k=k||"POST";b=function(){var a;try{a=null;try{a=new XMLHttpRequest}catch(b){}a&&!c?
a.open(k,f,!0):"undefined"!==typeof XDomainRequest?(a=new XDomainRequest,a.open(k,f)):a=null;try{a.withCredentials=!1}catch(d){}a.setRequestHeader&&a.setRequestHeader("Content-Type","text/plain;charset=UTF-8");a.onload=function(){h=!0};a.onreadystatechange=function(){};a.ontimeout=function(){};a.onerror=function(){};a.onprogress=function(){};a.send(l)}catch(m){try{try{r.fileLoader.load(f)}catch(s){window.console&&window.console.log&&window.console.log(m)}}catch(n){}}e()};d?r.fileLoader.load(f):b()};
(function(){var a,l=!1,k=1,b,d,c,f;d=function(a){!0===a&&(k-=1);if(!k||!0!==a&&!l){if(!document.body)return setTimeout(d,1);l=!0;if(!0!==a&&(k-=1,0<k))return;for(;0<b.length;)a=b.shift(),a()}};f=function(){if(!l){try{document.documentElement.doScroll("left")}catch(a){setTimeout(f,1);return}d()}};c=function(){if(!b){b=[];if("complete"===document.readyState)return setTimeout(d,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",d,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",
a);window.attachEvent("onload",d);var c=!1;try{c=null===window.frameElement||void 0===window.frameElement}catch(e){}document.documentElement.doScroll&&c&&f()}}};r.ready=function(a){c();l?setTimeout(a,1):b.push(a)};document.addEventListener?a=function(){document.removeEventListener("DOMContentLoaded",a,!1);d()}:document.attachEvent&&(a=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",a),d())})})();r.UVCommonValues={};r.UVCommonValues.keys="version page category subcategory user name username user_id email language returning facebook_id twitter_id listing items id sku url manufacturer color currency unit_price unit_sale_price basket subtotal subtotal_include_tax tax shipping_cost total line_items product sku_code quantity environment variation revision age gender first_order registered_today registered_in_current_session registration_date last_order_date last_transaction_payment_type".split(" ");
r.UVCommonValues.values=["",!0,!1,"true","false","GBP","USD","production"];(function(){var a={},l,k;a.replaceCommonValues=function(b){var d=0,c=b.length,f=[],h,e={};if(b.constructor===Array){for(;d<c;d+=1)f.push(a.replaceCommonValues(b[d]));return f}if(b.constructor===Object){for(h in b)if(void 0!==b[h]&&null!==b[h]&&("string"!==typeof b[h]||0<b[h].trim().length)){d=h.trim();a:{var c=r.UVCommonValues.keys,f=d,m=void 0,k=c.length,m=Number(m)||0,m=0>m?Math.ceil(m):Math.floor(m);for(0>m&&(m+=k);m<k;m+=
1)if(c.hasOwnProperty(m)&&c[m]===f){c=m;break a}c=-1}d=-1===c||0===l?d:c;e[d]=a.replaceCommonValues(b[h])}return e}"string"===typeof b&&(b=b.trim());return b};a.restoreCommonValues=function(b){var d=0,c=b.length,f=[],h={},e;if(b.constructor===Array){for(;d<c;d+=1)f.push(a.restoreCommonValues(b[d]));return f}if(b.constructor===Object){for(e in b)b.hasOwnProperty(e)&&(d=isNaN(Number(e))?e:r.UVCommonValues.keys[Number(e)],h[d]=a.restoreCommonValues(b[e]));return h}return b};a.compress=function(b){l=
void 0===b.compressionLevel?1:b.compressionLevel;k=b.universalVariable;return z.stringify(a.replaceCommonValues(k))};a.decompress=function(b){b=z.parse(b);return z.stringify(a.restoreCommonValues(b))};r.UVCompressor=a})();(function(){var a={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null},l,k="universal_variable";a._isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a._targetChanged=function(b,d,c){if(null===c)return"null"===d?!1:!0;if(void 0===c)return d===
c?!1:!0;d=z.parse(d);d=a._getNested(d,b);b=a._getNested(c,b);return!a._jsonIsEqual(d,b)};a._processCallbacks=function(){var b;if(a.early_callbacks&&0<a.early_callbacks.length){for(b=0;b<a.early_callbacks.length;b+=1)a.push(a.early_callbacks[b]);a.early_callbacks=null}};a._keyStringToArr=function(a){a=a.replace(/^\s+/,"").replace(/\s+$/,"");if(""===a)return[];a=a.replace(/\[(\w+)\]/g,".$1");a=a.replace(/^\./,"");return a.split(".")};a._getNested=function(b,d){for(var c=a._keyStringToArr(d),f;0<c.length;)if(f=
c.shift(),b.hasOwnProperty(f))b=b[f];else return;return b};a._jsonIsEqual=function(b,d){"string"!==typeof b&&(b=z.stringify(b,a._stripEvents));"string"!==typeof d&&(d=z.stringify(d,a._stripEvents));return b===d};a._stripEvents=function(a,d){if("events"!==a)return d};a._on=function(b,d){var c;c=b.split(":");b=c[0];c=c[1];a.callbacks[b]=a.callbacks[b]||[];c?a.callbacks[b].push({keyString:c,func:d}):a.callbacks[b].push({func:d})};a._trigger=function(b,d){var c,f;if(a.callbacks[b])for(c=0;c<a.callbacks[b].length;c+=
1)"function"===typeof a.callbacks[b][c].func&&((f=a.callbacks[b][c].keyString)?"change"===b&&a._targetChanged(f,a.currentUV,l)&&a.callbacks[b][c].func(d):a.callbacks[b][c].func(d))};a._eventsPush=function(b){var d,c;l.events[l.events.length]=b;b.time=b.time||(new Date).getTime();if(a.callbacks.event)for(d=0,c=a.callbacks.event.length,d;d<c;d+=1)a.callbacks.event[d].func(b);b.has_fired=!0};a._getUnfiredEvents=function(){for(var b=0,b=0;b<l.events.length;b+=1)l.events[b].has_fired||(a.unfired_events.push(l.events.splice(b,
1)[0]),b-=1)};a._fireEvents=function(){for(;0<a.unfired_events.length;)l.events.push(a.unfired_events.shift())};a._resetEventsPush=function(){l.events=l.events||[];-1!==l.events.push.toString().indexOf("[native code]")&&(l.events.push=a._eventsPush,a._getUnfiredEvents(),a._fireEvents())};a._checkForChanges=function(){a.callbacks.change&&0<a.callbacks.change.length&&!a._jsonIsEqual(a.currentUV,l)&&(a._trigger("change",l),a.currentUV=z.stringify(l,a._stripEvents))};a._setUVLocation=function(b){k=b;
a._initUV()};a._initUV=function(){window[k]=window[k]||{events:[]};l=window[k];l.events||(l.events=[])};a.push=function(b){a._isArray(b)&&("on"===b[0]?a._on(b[1],b[2]):"trigger"===b[0]&&b[1]&&a._trigger(b[1]))};a.init=function(b,d){d&&(k=d);a._initUV();!window.uv_listener||a._isArray(window.uv_listener)?(a.early_callbacks=window.uv_listener||null,window.uv_listener=a,b||a.start()):d&&window.uv_listener._setUVLocation(k)};a.start=function(){a.currentUV=z.stringify(l,a._stripEvents);setInterval(function(){a._initUV();
a._resetEventsPush();a._checkForChanges()},500);a._processCallbacks()};r.UVListener=a})();(function(){function a(a,b){for(var c=0;c<b.length;c++)if("function"===typeof b[c]&&a instanceof b[c])return!0;return!1}function l(a,b){for(var c=0;c<b.length;c++)if(typeof a===b[c])return!0;return!1}function k(a,b){for(var c=0;c<b.length;c++)b[c]===a&&b.splice(c,1);return b}function b(a){return"string"!==typeof a?'"'+a+'"':'"'+a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"').replace(/\n/g,"\\n")+'"'}function d(a,
b){return a?" "+b:b}function c(a,b,c,s,n){var d=" ";""===c&&(d="");return(c||s?0===n.length?[d,a,n.join(","),b]:[d,a,"\n",c,h,n.join(",\n"+c+h),"\n",c,b]:[a,n.join(","),b]).join("")}var f={};f.checkIfInstanceOf=a;var h="  ",e=function(f,m,q,s,n,w){if(isNaN(n)||!(s>=n)){var t,B,g,u,L,N=!0,C=!1,M,r=!0,I=!1,v=!1,z=!1,E=!1,A;m&&(m.prettyPrint&&(E=!0),m.raw&&(I=m.raw),m.renderFunction&&(A=m.renderFunction),m.excludeInstances&&(t=m.excludeInstances),m.excludeTypes&&(B=m.excludeTypes),m.exclude&&(g=m.exclude),
m.excludeNames&&(L=m.excludeNames),m.excludeMatches&&(u=m.excludeMatches),void 0!==m.hasOwn&&(N=m.hasOwn),m.fakeFunctions&&(v=m.fakeFunctions),m.realFunctions&&(z=m.realFunctions),m.includeFunctions&&(C=m.includeFunctions),m.excludeOnTrue&&(M=m.excludeOnTrue),m.dateAsString&&(r=m.dateAsString));var F="",D="";if(E){for(E=0;E<s;E++)F+=h;D="\n"}if(M)try{if(M(f))return}catch(G){}if("function"===typeof A&&(w=A(f,w),"string"===typeof w))return b(w);if(f instanceof Date)return!I||r?b(f.toISOString()):f.valueOf();
if(C||"function"!==typeof f){if("number"===typeof f)return d(F,String(f));if("string"===typeof f)return d(F,b(f));if(null===f)return d(F,"null");if(void 0===f)return I?d(F,"undefined"):void 0;if("boolean"===typeof f)return d(F,String(f));if(C&&"function"===typeof f&&v)return"(function () {})";if(C&&"function"===typeof f&&z)return d(F,f.toString());a:{if(f instanceof Object)for(C=0;C<q.length;C++)if(q[C]===f){C=!0;break a}C=!1}if(!C){q.push(f);++s;if(f instanceof Array){g=[];for(E=0;E<f.length;E++)if(!t||
!a(f,t))if(!B||!l(f,B)){var H;try{var x=f[E];I||void 0!==x||(x=null);H=e(x,m,q,s,n,E)}catch(K){return k(f,q),b(String(K))}void 0!==H&&g.push(H)}k(f,q);return c("[","]",F,D,g)}var I=[],J;for(J in f)if(H=f[J],!N||f.hasOwnProperty(J))if(!t||!a(H,t))if(!B||!l(H,B)){if(x=L)a:{for(x=0;x<L.length;x++)if(J===L[x]){x=!0;break a}x=!1}if(!x){if(x=g)a:{for(x=0;x<g.length;x++)if(H===g[x]){x=!0;break a}x=!1}if(!x){if(x=u)a:{C=J;r=u;try{for(v=0;v<r.length;v++)if(r[v].test(C)){x=!0;break a}}catch(P){}x=!1}if(!x)try{var O=
e(H,m,q,s,n,J);if(void 0!==O){var Q='"'+J.replace(/\"/g,'\\"')+'":'+O;I.push(Q)}}catch(R){return k(f,q),b(String(R))}}}}k(f,q);return c("{","}",F,D,I)}}}};f.serialize=function(a,b){var c;b&&(c=b.level);return e(a,b,[],0,c)};var m=(0,eval("this"))||function(){return this}()||this.window;f.parse=function(a){if(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(a.replace(/"(\\.|[^"\\])*"/g,"")))throw"insecure json!";a="json.___tmp = ("+a+")";m.execScript?m.execScript(a):m.eval.call(m,a);return f.___tmp};m.json=
f;f.jsonString=b;try{module.exports=f}catch(g){}})();(function(){function a(){}function l(a,n){for(var b=h.length,c=0;c<b;c++)if(a===h[c][0])return h[c][1];h[h.length]=[a,n];return!1}function k(a,n,b,c,d){var e=!1,m=!1,p=!1,q=!1,g=!1,y=g=!1;n&&(e=(g=!!n.all)||n.nodes,q=g||n.win,m=g,y=!!n.emptyForMaxDeep,p=n.noFunctions&&!g,void 0!==n.noOwn&&(m=!!n.noOwn),void 0!==n.noFunctions&&(p=!!n.noFunctions),void 0!==n.win&&(q=!!n.win),void 0!==n.nodes&&(e=!!n.nodes),g=!!n.copyReference);if(void 0===b||b)void 0!==
b&&b--;else return y?void 0:a;if(!(a&&a instanceof Object))return a;if(!e){try{if(a instanceof Node)return a}catch(u){if(a instanceof ActiveXObject&&void 0!==a.nodeType)return a}if(a===document)return a}if(!q&&a===f)return a;e=a instanceof Array?[]:{};a instanceof Date&&(e=new Date(a));!p&&a instanceof Function&&(p=String(a).replace(/\s+/g,""),e=p.indexOf("{[nativecode]}")+14===p.length?function(){return a.apply(d||this,arguments)}:function(){return a.apply(this,arguments)});void 0===c&&(h=[],c=0);
if(p=l(a,e))return p;if(e instanceof Array)for(p=0;p<a.length;p++)e[e.length]=a[p]===a[p]?k(a[p],n,b,c+1,a):a[p];else{var p=0,r;for(r in a){if(m||a.hasOwnProperty(r))e[r]=a[r]===a[r]?k(a[r],n,b,c+1,a):a[r];p++}}n.proto&&(e.prototype=k(a.prototype,n,b,c+1,a));g&&(e.___copy_ref=a);return e}function b(a,n,c,d,m,p,h,k){c=c||{};void 0===c.hasOwn&&(c.hasOwn=!0);if(!c.objectsOnly||a instanceof Object)if(void 0===k||k){void 0!==k&&k--;if(!c||!c.nodes)try{if(a instanceof Node)return}catch(l){if(a instanceof
ActiveXObject&&void 0!==a.nodeType)return}if(a!==f){void 0===d&&(e=[],d=0);var g;a:{for(g=0;g<d&&g<e.length;g++)if(a===e[g]){g=!0;break a}g=!1}if(!(g||(e[d]=a,m=m||a,m&&p&&m[p]!==m[p]||n(a,m,p,h)))){p=0;g="";for(var q in a){if(!c.hasOwn||a.hasOwnProperty(q))try{var y=a[q];c.track&&(g=h?h+"."+q:q);b(y,n,c,d+1,m,q,g,k)}catch(u){}p++}}}}}var d=g.Define,c=g.Cookie,f=d.global();d.clazz("qubit.opentag.Utils",a);a.global=d.global;a.namespace=d.namespace;a.clazz=d.clazz;a.getObjectUsingPath=function(a,n){n=
n||f;for(var b=a.split("."),c=0;c<b.length;c++)n&&b[c]&&(n=n[b[c]]);return n};a.getParentObject=function(b){var n=b.lastIndexOf(".");b=b.substring(0,n);return a.getObjectUsingPath(b)};a.variableExists=function(a){return void 0!==a&&null!==a};a.ANON_VARS=[];a.getAnonymousAcessor=function(b){var n=a.indexInArray(b,a.ANON_VARS);-1===n&&(n=a.addToArrayIfNotExist(a.ANON_VARS,b));return"qubit.opentag.Utils.ANON_VARS["+n+"]"};a.replaceAll=function(a,n,b){return a.replace(new RegExp(n.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,
"\\$1"),"g"),b)};a.secureText=function(a){"string"!==typeof a&&(a+="");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")};a.getUrl=function(){return document.location.href};a.getQueryParam=function(b){var n,c,d,e;n=a.getUrl();if(0<n.indexOf("?"))for(e=n.substring(n.indexOf("?")+1).split("&"),n=0,c=e.length;n<c;n+=1)if(d=e[n],0<d.indexOf("=")&&(d=d.split("="),2===d.length&&d[0]===b))return d[1];return null};a.getElementValue=function(a){return(a=document.getElementById(a))?a.textContent||a.innerText:
null};var h=[];a.objectCopy=function(a,b){b=b||{};var c=k(a,b,b.maxDeep);h=[];return c};var e=[];a.traverse=function(a,n,c){b(a,n,c,void 0,void 0,void 0,void 0,c.maxDeep)};a.prepareQuotedString=function(a){return"string"===typeof a?'"'+a.replace(/\"/g,'\\"')+'"':a};a.expressionToFunction=function(b,n){return a.gevalAndReturn("function ("+(n||"")+") {"+b+"}").result};a.defineWrappedClass=function(a,b,c,e,f){var m=function(){return f?f.apply(this,arguments):b.apply(this,arguments)};d.clazz(a,m,b,e);
for(var p in c)c.hasOwnProperty(p)&&"CONSTRUCTOR"!==p&&(m.prototype[p]=c[p]);return m};a.copyAandAddFromB=function(a,b,c){a=this.objectCopy(a,{maxDeep:c||8});for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return a};a.keys=function(a){if(a instanceof Object){if(Object.keys)return Object.keys(a);var b=[],c;for(c in a)a.hasOwnProperty(c)&&(b[b.length]=c);return b}throw"keys() called on non-object!";};a.getSrcElement=function(a){var b;a=a||window.event;a.srcElement?b=a.srcElement:a.target&&(b=a.target);
return b};a.addToArrayIfNotExist=function(a,b,c){for(var d=0,e=!1;d<a.length;d+=1)if(c&&c(a[d],b)||a[d]===b){e=!0;break}e||(a[a.length]=b,d=-1);return d};a.indexInArray=function(a,b){for(var c=0,d=!1;c<a.length;c++)if(a[c]===b){d=!0;break}return d?c:-1};a.removeFromArray=function(a,b){for(var c=0,d=0;c<a.length;c+=1)a[c]===b&&(a.splice(c,1),d++);return d};a.addClass=function(b,c){var d;try{b.classList.add(c)}catch(e){null===b.className?b.className=c:(d=b.className.split(" "),a.addToArrayIfNotExist(d,
c),b.className=d.join(" "))}};a.removeClass=function(b,c){var d;try{b.classList.remove(c)}catch(e){null===b.className?b.className="":(d=b.className.split(" "),a.removeFromArray(d,c),b.className=d.join(" "))}};a.gevalAndReturn=function(b){var c=A;c.qubitopentagutilsgevalandreturn__var_test__=void 0;c.qubitopentagutilsgevalandreturn__var_test__error=void 0;a.geval("try{this.qubitopentagutilsgevalandreturn__var_test__=("+b+");}catch(ex){this.qubitopentagutilsgevalandreturn__var_test__error = ex;}");
b=c.qubitopentagutilsgevalandreturn__var_test__;var d=c.qubitopentagutilsgevalandreturn__var_test__error;try{c.qubitopentagutilsgevalandreturn__var_test__=void 0,c.qubitopentagutilsgevalandreturn__var_test__error=void 0,delete c.qubitopentagutilsgevalandreturn__var_test__,delete c.qubitopentagutilsgevalandreturn__var_test__error}catch(e){}return{result:b,error:d}};a.trim=function(a){try{return String(a).trim()}catch(b){return String(a).replace(/^\s+|\s+$/g,"")}};a.setIfUnset=function(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&
!a.hasOwnProperty(c)&&(a[c]=b[c])};a.overrideFromBtoA=function(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};a.geval=function(a){return window&&window.execScript?window.execScript(a):f.eval.call(f,a)};var m=[];a.bodyAvailable=function(a){if(document.body){if(m){for(var b=0;b<m.length;b++)try{m[b]()}catch(c){}m=!1}a()}else m.push(a)};a.rmCookiesMatching=function(a){for(var b=c.getAll(),d=0;d<b.length;d++){var e=b[d][0];0===e.match(a)&&c.rm(e)}};var u=[],p=!1,y=!1;a.bodyReady=
function(a){if(y)return a&&a(),!0;if(p=p||!(!document.body||"complete"!==document.readyState)){y=!0;for(var b=0;b<u.length;b++)try{u[b]()}catch(c){f.console&&f.console.trace&&f.console.trace(c)}a&&a()}else a&&u.push(a);return p};var q=f.onload;f.onload=function(b){a.bodyReady();q&&q(b)};(function(){var b,c=!1,d=1,e,f,m,h;f=function(a){!0===a&&(d-=1);if(!d||!0!==a&&!c){if(!document.body)return setTimeout(f,1);c=!0;if(!0!==a&&(d-=1,0<d))return;for(;0<e.length;)a=e.shift(),a()}};h=function(){if(!c){try{document.documentElement.doScroll("left")}catch(a){setTimeout(h,
1);return}f()}};m=function(){if(!e){e=[];if("complete"===document.readyState)return setTimeout(f,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",b,!1),window.addEventListener("load",f,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",b);window.attachEvent("onload",f);var a=!1;try{a=null===window.frameElement||void 0===window.frameElement}catch(c){}document.documentElement.doScroll&&a&&h()}}};document.addEventListener?b=function(){document.removeEventListener("DOMContentLoaded",
b,!1);f()}:document.attachEvent&&(b=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",b),f())});(function(a){m();c?setTimeout(a,1):e.push(a)})(function(){p=!0;a.bodyReady()})})()})();(function(){function a(a){this.log=new g.opentag.Log("Events -> ");this.calls={}}var l=g.Define,k=g.opentag.Utils;a.prototype.on=function(a,d){this.calls[a]=this.calls[a]||[];return k.addToArrayIfNotExist(this.calls[a],d)};a.prototype.call=function(a){if(a=this.calls[a])for(var d=
0;d<a.length;d++)try{a[d]()}catch(c){this.log.ERROR("Error while running event: "+c)}};a.prototype.remove=function(a,d){return k.removeFromArray(this.calls[a],d)};a.prototype.removeAll=function(a){var d=0,c;for(c in this.calls)this.calls.hasOwnProperty(c)&&(d+=k.removeFromArray(this.calls[c],a));return d};l.clazz("qubit.Events",a)})();(function(){function a(b,c,d){this.collectLogs=!!a.isCollecting();this.collectLocally=d;this.collection=[];this.getPrefix=function(){var a="";c&&("function"===typeof c?
a=c(this.ref):c.CLASS_NAME?a=c.CLASS_NAME:c.constructor&&c.constructor.name&&(a=c.constructor.name),a&&(a+=" -> "));return(b||"")+a}}function l(b,c,e,s,n,f,m,h){var k=d>=h;if(0<=a.getCollectLevel()||k)c=n?[s,m,e]:[c+b.getPrefix()+s,f,e],c[3]=h,b.collect(c,h),k&&b.printMessage.apply(b,c)}var k=g.Define,b=null;k.clazz("qubit.opentag.Log",a);a.LEVEL_FINEST=4;a.LEVEL_FINE=3;a.LEVEL_INFO=2;a.LEVEL_WARN=1;a.LEVEL_ERROR=0;a.LEVEL_NONE=-1;a.MAX_LOG_LEN=1E4;a.prototype.MAX_LOG_LEN=-1;var d=a.LEVEL_NONE,d=
a.LEVEL_INFO,c=a.LEVEL_FINE,f=!0;a.setCollecting=function(a){f=!!a};a.isCollecting=function(){return f||a.COLLECT};a.setLevel=function(a){d=+a};a.getLevel=function(){return d};a.setCollectLevel=function(a){c=+a};a.getCollectLevel=function(){return c};var h=[];a.logsCollection=h;a.rePrintAll=function(c,e,f,s){var n=d;void 0!==c&&(d=c);try{if(a.isCollecting()){try{f||b.clear()}catch(m){}var h=s||a.logsCollection,k=0;for(f=0;f<h.length;f++)(function(b){var f=h[b];b=f[3];void 0!==b&&d>=b&&(k++,e?g.opentag.Timed.setTimeout(function(){void 0!==
c&&(d=c);try{a.print.apply(a,f)}finally{d=n}},k*e):a.print.apply(a,f))})(f)}}catch(l){}finally{d=n}};var e=!!k.global().webkitURL;a.isStyleSupported=function(){return e};var m={};a.setConsole=function(a){return b=a||m};a.delayPrint=-1;var u=(new Date).valueOf();a.prototype.printMessage=function(b,c,d,e){if(0<a.delayPrint){var n=a.delayPrint,f=u-(new Date).valueOf();0<f&&(n+=f);try{g.opentag.Timed.setTimeout(function(){this.print(b,c,d,e)}.bind(this),n)}catch(m){setTimeout(function(){this.print(b,
c,d,e)}.bind(this),n)}u=(new Date).valueOf()+n}else this.print(b,c,d,e)};a.prototype.print=function(b,c,d,e){a.print(b,c,d,e)};a.print=function(c,e,f,s){if(!(void 0!==s&&d<s))try{if(b&&b.log)if(e&&a.isStyleSupported())if(f&&b[f])b[f]("%c"+c,e);else b.log("%c"+c,e);else if(f&&b[f])b[f](c);else b.log(c)}catch(n){}};a.prototype.collect=function(b,c){void 0===c&&(c=a.getCollectLevel());var d=!1,e=this.collectLogs&&a.isCollecting()&&a.getCollectLevel()>=+c;e&&(h.push(b),d=!0);this.collectLocally&&e&&(this.collection.push(b),
d=!0);0<a.MAX_LOG_LEN&&h.length>a.MAX_LOG_LEN&&h.splice(0,h.length-a.MAX_LOG_LEN);if(0<a.MAX_LOG_LEN||0<this.MAX_LOG_LEN)e=a.MAX_LOG_LEN,0<this.MAX_LOG_LEN&&(e=this.MAX_LOG_LEN),this.collection.length>e&&this.collection.splice(0,this.collection.length-e);return d?b:null};a.clearAllLogs=function(){try{b.clear()}catch(a){}finally{h.splice(0,h.length)}};a.getCollectedByLevel=function(a,b){b=b||h;for(var c=[],d=0;d<b.length;d++){var n=b[d];n[0][4]===a&&c.push(n)}return c};a.prototype.rePrint=function(b,
c,d){a.rePrintAll(b,c,!d,this.collection)};a.prototype.FINEST=function(b,c){l(this,"FINEST: ",!1,b,c,"color:#CCCCCC;",!1,a.LEVEL_FINEST)};a.prototype.FINE=function(b,c){l(this,"FINE: ",!1,b,c,"color:#999999;",!1,a.LEVEL_FINE)};a.prototype.INFO=function(b,c,d){l(this,"INFO: ","info",b,c,d,d,a.LEVEL_INFO)};a.prototype.WARN=function(b,c){l(this,"WARN: ","warn",b,c,"color:#26A110;",!1,a.LEVEL_WARN)};a.prototype.ERROR=function(b,c){l(this,"ERROR: ","error",b,c,"color:red;",!1,a.LEVEL_ERROR)};a.setConsole(k.global().console)})();
(function(){function a(a){a&&(l.FINEST("Config:"),l.FINEST(a,!0),this._rate=a.rate||10,this._smallestRate=-1,a.start&&this.startPooling(),this.config=a);this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}var l=new g.opentag.Log("Timer -> ");g.Define.clazz("qubit.opentag.Timer",a);a.prototype.timers=[];a.prototype.startPooling=function(a){a&&this.config.dynamic&&(0>this._smallestRate||this._smallestRate>a)&&(this._smallestRate=Math.min(Math.floor(a/2),1500));this.started||(this.started=
!0,setTimeout(this._binded_pool,0))};a.prototype._pool=function(){this.maxFrequent(function(){var a="";this.config&&this.config.name&&(a="["+this.config.name+"]");l.FINEST(a+"Pooling in progress...")},5E3,this._lck_obj);this.callTimers();0!==this.timers.length?setTimeout(this._binded_pool,this._smallestRate>this._rate?this._smallestRate:this._rate):(this.started=!1,this._smallestRate=-1)};a.prototype.callTimers=function(){this.lastCalled=(new Date).valueOf();for(var a=0;a<this.timers.length;a++){var d=
this.timers[a];if((new Date).valueOf()>=d.time){try{d.execute()}catch(c){l.ERROR("Error calling timer: "+c)}this.timers.splice(a,1);--a}}};a.prototype.cancellAll=function(){this.timers=[];l.WARN("Cancelling all stack.")};a.prototype.setRate=function(a){this._rate=a};a.prototype.maxFrequent=function(a,d,c){c||(a.__maxFrequent__timer_opentag_qubit_=a.__maxFrequent__timer_opentag_qubit_||{},c=a.__maxFrequent__timer_opentag_qubit_);var f=c.____last__timed__max__frequent____;if(!f||(new Date).valueOf()-
f>d)f=(new Date).valueOf(),c.____last__timed__max__frequent____=f,a()};a.prototype.runIfNotScheduled=function(a,d,c){c=c||a;if(c.__lastRun__&&(new Date).valueOf()<d+c.__lastRun__)return this.schedule(a,d,c);c.__lastRun__=(new Date).valueOf();a();return!0};a.prototype.schedule=function(a,d,c){if(c.___scheduled___)return!1;c.___scheduled___=(new Date).valueOf();this.setTimeout(function(){c.___scheduled___=!1;c.__lastRun__=(new Date).valueOf();a()},d);return!0};var k=1;a.prototype.setTimeout=function(a,
d){var c={id:k++,time:(new Date).valueOf()+ +d,execute:a};this.timers.push(c);this.startPooling(d);return c};a.prototype.setInterval=function(a,d){l.FINEST("Native wrapper");var c=setInterval(a,d);this.inervals.push(c);return c}})();(function(){g.Define.namespace("qubit.opentag.Timed",new g.opentag.Timer({rate:37,dynamic:!0}));var a=g.opentag.Timed;a.tillTrue=function(l,k,b){var d=function(){l()?k():a.setTimeout(d,b||33)};d()}})();(function(){function a(a){this.log=new g.opentag.Log("",function(){return this.CLASS_NAME+
"["+this.config.name+"]"}.bind(this),"collectLogs");this.config={order:0,include:!0,name:"Filter-"+k++,script:void 0,session:void 0};this.session=null;if(a){for(var b in a)a.hasOwnProperty(b)&&(this.config[b]=a[b]);a.session&&this.setSession(a.session);this.register(this)}}var l=g.opentag.Utils,k=0,b=[];g.Define.clazz("qubit.opentag.filter.BaseFilter",a);a.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};a.prototype.reset=function(){this.enable()};a.prototype.disable=function(){this.config.disabled=
!0};a.prototype.enable=function(){this.config.disabled=!1};a.prototype.match=function(){return!0};a.prototype.setSession=function(a){this.session=a};a.prototype.getSession=function(){return this.session};a.prototype.getState=function(){var b=a.state.PASS;if(this.config.disabled)return a.state.DISABLED;this.config.script&&(b=this.config.script.call(this,b));isNaN(+b)&&(this.log.WARN("filters should use a numerical state as a return for getState(): BaseFilter.state. Filter will fail. Returned: "+b),
b=a.state.FAIL);this.lastState=+b;return b};a.getFilters=function(){return b};a.prototype.register=function(){a.register(this)};a.register=function(a){l.addToArrayIfNotExist(b,a)}})();g.Define.namespace("qubit.opentag.filter.pattern.PatternType",{CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"});(function(){function a(d){this._lockObject={};var c={patternType:b.CONTAINS,pattern:""};if(d)for(var f in d)d.hasOwnProperty(f)&&
(c[f]=d[f]);a.SUPER.call(this,c)}var l=g.opentag.Utils,k=g.opentag.Timed,b=g.opentag.filter.pattern.PatternType;g.Define.clazz("qubit.opentag.filter.URLFilter",a,g.opentag.filter.BaseFilter);a.prototype.PATTERNS=b;a.prototype.getURL=function(a){return a||l.getUrl()};a.prototype.match=function(a){a=this.getURL(a);var c=!0,f=this.config.pattern;switch(this.config.patternType){case b.CONTAINS:c=0<=a.toLowerCase().indexOf(f.toLowerCase());break;case b.MATCHES_EXACTLY:c=a.toLowerCase()===this.config.pattern.toLowerCase();
break;case b.STARTS_WITH:c=0===a.toLowerCase().indexOf(f.toLowerCase());break;case b.ENDS_WITH:c=a.lastIndexOf(f.toLowerCase())+f.length===a.length;break;case b.REGULAR_EXPRESSION:c=(new RegExp(f)).test(a);break;case b.ALL_URLS:c=!0}k.maxFrequent(function(){this.log.FINEST("[ Filter "+this.config.name+"] Checking if patternType '"+this.config.patternType+"' match '"+f+"' pattern: "+(c?"Yes -> "+c:"No")+", include: "+this.config.include)}.bind(this),1E3,this._lockObject);return c}})();(function(){function a(d){var c=
{};if(d){for(var f in d)d.hasOwnProperty(f)&&("customStarter"===f&&d[f]?this.customStarter=d[f]:"customScript"===f&&d[f]&&(this.customScript=d[f]),c[f]=d[f]);this.uid="f"+b++}this.tagsToRun=[];a.SUPER.call(this,c)}var l=g.opentag.filter.BaseFilter,k=g.opentag.Utils,b=0;g.Define.clazz("qubit.opentag.filter.SessionVariableFilter",a,g.opentag.filter.URLFilter);a.prototype.customStarter=function(a,b,f){b(!1)};a.prototype.isAllStartersDefaults=function(){return this.customStarter!==a.prototype.customStarter||
this.customScript!==a.prototype.customScript?!1:!0};a.prototype.customScript=function(a){return!0};a.prototype.match=function(b){var c=!0;try{void 0===this._matchState&&(this._matchState=!!this.customScript(this.getSession())),c=this._matchState}catch(f){this.log.FINE("Filter match throws exception:"+f),c=!1}return c&&a.SUPER.prototype.match.call(this,b)};a.prototype.runTag=function(a){k.addToArrayIfNotExist(this.tagsToRun,a);if(this._runTag)this.lastRun&&(!0===this._rerun?a.run():a.runOnce());else if(this.customStarter){var b=
function(a){this.lastRun=(new Date).valueOf();this._processQueuedTagsToRun(a);this._rerun=a}.bind(this);this._runTag=!0;this.customStarter(this.getSession(),b,a)}};a.prototype._processQueuedTagsToRun=function(a){for(var b=0;b<this.tagsToRun.length;b++){var f=this.tagsToRun[b];!0===a?f.run():f.runOnce()}};a.prototype.getState=function(b){b&&this.setSession(b);b=a.SUPER.prototype.getState.call(this);if(b===l.state.DISABLED)return l.state.DISABLED;b===l.state.PASS&&this.customStarter&&(b=l.state.SESSION);
this.config.script&&(b=this.config.script.call(this,b,this.getSession()));return this.lastState=b};a.prototype.reset=function(){this._matchState=void 0;a.SUPER.prototype.reset.call(this);this.lastRun=this._runTag=void 0;this.tagsToRun=[]}})();(function(){function a(){p=p||{write:document.write,writeln:document.writeln}}function l(){document.write=p.write;document.writeln=p.writeln;p=null}var k=new g.opentag.Log("TagsUtils -> "),b=g.opentag.filter.BaseFilter,d=g.opentag.Utils,c=r.HtmlInjector,f=r.fileLoader,
h=g.opentag.filter.SessionVariableFilter,e=function(){};g.Define.clazz("qubit.opentag.TagsUtils",e);var m=!1;e.bodyLoaded=function(){return m?!0:m=!(!document.body||"loading"===document.readyState)};e.bodyAvailable=function(a){return!!document.body};var u={};e.loadScript=function(a){var b=a.url,c=function(c,n,d){u[b].error=n;d?(k.ERROR("Loading process error:"),k.ERROR(n,!0),u[b].state="failure",a.onerror()):(u[b].state="success",a.onsuccess())};if(u[b]){if(a.noMultipleLoad)return k.FINE(b+" is already loaded, with state: "+
u[b].state),c(b,u[b].error,"failure"===u[b].state);u[b].count+=1}else u[b]={count:1,state:null};var n=!a.async,d=e.bodyLoaded();n&&d&&k.WARN("Script configured for synchronous injection while document seems to be already loaded. Secure option applies. Script will be appended in standard way.");n&&!d?(k.WARN("Adding script element by using document.write. IE will error check fail broken url's."),e.writeScriptURL(b,function(a,n){c(b,n,!a)})):f.load(b,!1,c,a.node,a.async)};var p=null;e.redirectDocumentWritesToArray=
function(b,c){c&&c.FINE("redirecting document.write methods...");a();document.write=function(a){b.push(a);c&&c.FINE("Received call from document.write with:"+a)};document.writeln=function(a){b.push(a);c&&c.FINE("Received call from document.writeln with:"+a)}};e.flushDocWritesArray=function(a,b,c,n,d){if(b&&a){a=a.splice(0,a.length);try{return e.injectHTML(b,c,a.join("\n"),d||v),!0}catch(f){n&&n.ERROR("Loading html caused exception:"+f)}}else return n&&n.ERROR("Flushing location not found!"),!1;d&&
d();return!0};e.unlockDocumentWrites=function(){p&&(k&&k.FINEST("Bringing back document.write"),l())};var y=e.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks",q={};g.Define.namespace(y,q,A,!0);var s=0,n=(new Date).valueOf();e.writeScriptURL=function(b,c){var m="_"+n+"_"+s++,w=y+"."+m,h=!1;q[m]=function(a){h||(h=!0,a?c(!1,"error while loading script "+b):c(!0),q[m]=void 0,delete e.writeScriptURL.callbacks[m])};var t='if(this.readyState === "loaded" || this.readyState === "complete"){ try {'+
w+"(true)} catch (ex) {}}",g="try{"+w+"(false)}catch(ex){}",w="try{"+w+"(true)}catch(ex){}";b=f.tidyUrl(b);t="<script onload='"+g+"'  onerror='"+w+"' onreadystatechange='"+t+"' type='text/javascript'  src='"+b+"'>\x3c/script>";p?(l(),document.write(t),a()):document.write(t);d.bodyReady(function(){h||(k.WARN("URL loaded but cannot tell if successful: "+b),h=!0,c(!0))})};e.writeScriptURL.callbacks={};var w=b.state.SESSION,t=b.state.PASS,B=b.state.FAIL;e.filtersState=function(a,c,n,d){a=a.sort(function(a,
b){try{return b.config.order-a.config.order}catch(c){return 0}});var e=t;if(!a||0===a.length)return e;for(var e=null,f=!1,s=!1,m=0,k,p,l=[],g,q,u=0;u<a.length;u++)if(g=a[u],g.setSession(c),g.match())if(k=g.getState(),0<k){if(0===m||m>k)m=k}else k===b.state.DISABLED?(n.log.WARN("filter with name "+g.config.name+" is disabled"),f=!0):k===w?(s=!0,p=e=g,l.push(g)):e=g;else q=g;a=!1;null===e?(a=!0,e=f?t:B):e=e.config.include?k:k===t?B:t;0<m&&(e===t||a)&&(e=m);if(e===w||e===t&&s){if(!p.config.include)return B;
e=w;if(p instanceof h&&d)for(d=0;d<l.length;d++)try{l[d].runTag(n)}catch(y){l[d].log.FINEST("trying custom starter failed:"+y)}}n.config.dedupe&&e===t&&q&&q instanceof h&&(n.sendDedupePing=!0,e=B);return e};e.injectHTML=function(a,b,n,d){return c.inject(a,b?0:1,n,d||v)};e.getHTMLLocationForTag=function(a){a=a.prepareLocationObject(a.config.locationObject);switch(a){case "HEAD":a=document.getElementsByTagName("head")[0];break;case "BODY":a=document.body;break;default:a=a?document.getElementById(a):
document.body}return a}})();(function(){function a(b){this.config={};this.log=new g.opentag.Log("",function(){return this.CLASS_NAME+"["+this.uniqueId+"]"}.bind(this),"collectLogs");this.parameters=null;if(b){this.uniqueId="BV"+k++;a.ALL_VARIABLES[this.uniqueId]=this;for(var d in b)this.config[d]=b[d];void 0!==b.value&&(this.value=b.value);void 0!==b.defaultValue&&(this.defaultValue=b.defaultValue);(b=a.register(this))&&b!==this&&(b.log.FINEST("Variable config already registered."),b.log.FINEST("Returning existing one."));
return b}}var l=g.opentag.Utils,k=0;g.Define.clazz("qubit.opentag.pagevariable.BaseVariable",a);a.ALL_VARIABLES={};a.pageVariables=[];a.register=function(b){if(b instanceof a){for(var d=0;d<a.pageVariables.length;d++){var c=a.pageVariables[d];if(b===c)return c}a.pageVariables.push(b);return b}return null};a.prototype.getValue=function(){return this.value};a.prototype.setValue=function(a){this.value=a};a.prototype.getDefaultValue=function(){return this.defaultValue};a.prototype.setDefaultValue=function(a){this.defaultValue=
a};a.prototype.exists=function(a){var d=l.variableExists(this.getValue());a&&(d=d||l.variableExists(this.getDefaultValue()));return d};a.prototype.getRelativeValue=function(a,d){var c=this.getValue();l.variableExists(c)||(c=d);var f;a&&!l.variableExists(c)&&(f=this.getDefaultValue(),l.variableExists(f)&&(c=f));return c};a.prototype.replaceToken=function(a,d,c,f){var h=this.exists();c=h?this.getValue():c;a="\\$\\{"+a+"\\}";return f||c instanceof Array?(f=h?this.getValueAccessorString():l.getAnonymousAcessor(c),
d.replace(new RegExp(a,"g"),f)):d.replace(new RegExp(a,"g"),c)};a.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};a.prototype.getValueAccessorString=function(){return this.getAccessorString()+".getValue()"}})();(function(){function a(b){this._lockExprObject={};a.SUPER.apply(this,arguments)}var l=g.opentag.Utils,k=g.opentag.Timed;g.Define.clazz("qubit.opentag.pagevariable.Expression",a,g.opentag.pagevariable.BaseVariable);a.prototype.getValue=
function(){var b,d;try{if(-1===this.value.indexOf("[#]")){var c=l.gevalAndReturn(this.value);b=c.result;this.failMessage=null;d=c.error}else b=a.parseUVArray(this.value)}catch(f){d=f}d&&(d="could not read value of expression: \n"+this.value+"\nexact cause: "+d,this.failMessage!==d&&(this.failMessage=d),b=null);k.maxFrequent(function(){this.failMessage&&this.log.FINEST(this.failMessage);this.log.FINEST("getting value from expression: "+b)}.bind(this),1E4,this._lockExprObject);return b};a.parseUVArray=
function(a){var d=a.split("[#]");a=l.gevalAndReturn(d[0]).result;var c=[],d=d[1];0===d.indexOf(".")&&(d=d.replace(".",""));for(var f=0;f<a.length;f++){var h=l.getObjectUsingPath(d,a[f]);c.push(h)}return c};a.prototype.replaceToken=function(b,d,c,f){this.getValue()instanceof Array&&(f=!0);return a.SUPER.prototype.replaceToken.call(this,b,d,c,f)}})();(function(){function a(k){a.SUPER.apply(this,arguments)}var l=g.opentag.Utils;g.Define.clazz("qubit.opentag.pagevariable.DOMText",a,g.opentag.pagevariable.BaseVariable);
a.prototype.getValue=function(){this.log.FINEST("reading DOM element contents value");return l.getElementValue(this.value)}})();(function(){function a(k){a.SUPER.apply(this,arguments);this._lockObject={}}var l=g.opentag.Timed;g.Define.clazz("qubit.opentag.pagevariable.Cookie",a,g.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=g.Cookie.get(this.value);l.maxFrequent(function(){this.log.FINEST("reading cookie value: "+a)}.bind(this),2E3,this._lockObject);return a}})();(function(){function a(k){a.SUPER.apply(this,
arguments)}var l=g.opentag.Utils;g.Define.clazz("qubit.opentag.pagevariable.URLQuery",a,g.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){return l.getQueryParam(this.value)}})();(function(){function a(){}function l(a,b){var c=[];try{var d=a.parameters;if(d)for(var n=0;n<d.length;n++)d[n].variable===b&&c.push(d[n])}catch(e){}return c}var k=g.opentag.Utils,b=g.opentag.TagsUtils,d=g.opentag.Timed,c=g.opentag.pagevariable.BaseVariable,f=g.opentag.pagevariable.Expression,h=g.opentag.pagevariable.DOMText,
e=g.opentag.pagevariable.Cookie,m=g.opentag.pagevariable.URLQuery;g.Define.clazz("qubit.opentag.TagHelper",a);a.injectHTMLForLoader=function(a,c,d,e){if(e=void 0!==e?e:a.getHtml()){var n="END"===a.config.locationPlaceHolder,f=b.getHTMLLocationForTag(a);a.log.FINE("injecting html into page:");a.log.FINE(e);a.injectHTMLNotFinished=!0;try{f?b.injectHTML(f,n,e,function(){a.log.FINE("finished html injection.");a.injectHTMLNotFinished=!1;if(c)try{c()}catch(b){a.log.ERROR("error while trying to run callback after html injection: "+
b)}}.bind(a)):d&&"loading"===document.readyState?(document.write(e),a.injectHTMLNotFinished=!1):(a.injectHTMLFailed=(new Date).valueOf(),a.log.ERROR("location was not found or/and html is told to not to write at runtime or document is already loaded. Please check tag's configuration. Injection cancelled."))}catch(m){a.injectHTMLNotFinished=!1,a.injectHTMLFailed=(new Date).valueOf(),a.log.ERROR("error while trying to inject html: "+m)}}};a.getAllVariablesWithParameters=function(a){for(var b=a.getPageVariables(),
c=[],d=0;d<b.length;d++)for(var n=b[d],e=l(a,n),f=0;f<e.length;f++)c.push({parameter:e[f],variable:n});return c};var u={};a.allParameterVariablesReadyForTag=function(a,b){for(var c=a.log,e=!0,n=a.getPageVariables(),f=0;f<n.length;f++){var m=n[f];try{var h=l(a,m),k=m.exists();!k&&b&&(0<h.length&&(k=!!h[0].defaultValue),k=k||m.exists(!0));var g=m.config.name?m.config.name:"[unnamed]";d.maxFrequent(function(){c.FINEST("Variable '"+g+"' exists? "+k)},5E3,u);if(!k){e=!1;break}}catch(r){d.maxFrequent(function(){c.ERROR("Error checking variable existence ");
c.ERROR([m,r])},5E3,u);e=!1;break}}e&&!u.alreadyNotified&&(u={alreadyNotified:!0});d.maxFrequent(function(){c.FINEST("Checking page variables, variables are ready: "+e);e?(u.clear=!0,c.FINE("Variables ready.")):c.FINE("Variables not ready, waiting...")},2E3,u);return e};a.validateAndGetVariableForParameter=function(b){b.hasOwnProperty("variable")&&b.variable?b.variable=a.initPageVariable(b.variable):b.variable=b.uv?new f({name:b.uv,value:b.uv}):a.initPageVariable({value:void 0,empty:!0});return b.variable};
a.initPageVariable=function(a){if(!a||a instanceof c)return a;if("string"===typeof a){var b=k.getObjectUsingPath(a);if(b&&b instanceof c)return b}switch(a.type){case "2":return new f(a);case "3":return new m(a);case "4":return new e(a);case "5":return new h(a);case "EPRESSION":return new f(a);case "URL_PARAMETER":return new m(a);case "COOKIE_VALUE":return new e(a);case "DOM_VALUE":return new h(a);default:return new c(a)}}})();(function(){function a(a){this.log=new h("",function(){return this.CLASS_NAME+
"["+this.config.name+"]"}.bind(this),"collectLogs");this.urlsFailed=this.urlsLoaded=0;this.events=new g.Events({});this._depLoadedHandler=function(){this.dependenciesLoaded()&&this.awaitingDependencies&&(this.log.FINE("All dependencies has run successfuly. Triggering load."),this._triggerLoadingAndExecution())}.bind(this);this.config={name:"Tag-"+f++,async:!0,usesDocumentWrite:!1,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,locationPlaceHolder:"END",locationObject:null,dontWaitForInjectionLocation:!1,
noMultipleLoad:!1,loadDependenciesOnLoad:!1};this.delayDocWrite=!1;this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=this.genericDependencies||[];if(a){this.log.FINE("instance...");if(!a.name){var b="Tag-"+f++;this.config.name=b;this.log.WARN("Name was not specified for tag. Assigning auto: "+b)}this.addState("INITIAL");for(var c in a)this.config[c]=a[c];a.genericDependencies&&(this.genericDependencies=this.genericDependencies.concat(a.genericDependencies));
a.dependencies&&(this.dependencies=a.dependencies.concat(this.dependencies));a.PACKAGE&&(this._package=a.PACKAGE);this.onInit()}}function l(){if(this.cancelled)this._handleCancel();else{this.waitForDependenciesFinished=(new Date).valueOf();var a=this._fullBodyNeededAndUnLoaded(),b=this._bodyNeededButNotAvailable();a||b?this.waitForDependenciesFinished=!1:(this.timeoutCountdownStart||(this.timeoutCountdownStart=(new Date).valueOf()),this.allDependenciesLoaded()?this._markLoadedSuccesfuly():this._loadingOutOfTimeFrames()?
(this.loadingTimedOut=(new Date).valueOf(),this.allDependenciesLoaded(!0)?this._markLoadedSuccesfuly():(this.log.WARN("timed out while loading dependencies."),this.addState("TIMED_OUT"),this.loadingDependenciesFailed=(new Date).valueOf(),this._triggerOnLoadTimeout())):this.waitForDependenciesFinished=!1);if(this.waitForDependenciesFinished)this.addState("LOADED_DEPENDENCIES");else{this._setTimeout(l.bind(this),65);var c=((new Date).valueOf()-this.loadStarted)/this.getTimeout(),f=Math.ceil(this.getTimeout()/
3E3);this._lockObject.curr=c;d.maxFrequent(function(){a&&this.log.FINE("Full body needed. Waiting for full body.");b&&this.log.FINE("Interactive body needed. Waiting for body.");this.log.FINE("Waiting for dependencies, counting... "+this._lockObject.count++ +" ("+f+")")}.bind(this),3E3,this._lockObject)}}}var k=g.opentag.Utils,b=g.opentag.TagsUtils,d=g.opentag.Timed,c=g.opentag.TagHelper,f=0,h=g.opentag.Log;g.Define.clazz("qubit.opentag.GenericLoader",a);a.prototype.onInit=v;a.prototype.LOADING_TIMEOUT=
5E3;a.prototype.getHtml=function(){return this.config.html?this.config.html:this.htmlContent?k.trim(this.htmlContent):null};a.prototype._executeScript=function(){this.log.INFO("executing main script...");var a=!1;try{this.script(),a=!0,this.log.INFO("executed without errors.")}catch(b){this.addState("EXECUTED_WITH_ERRORS"),this.executedWithErrors=(new Date).valueOf(),this.log.ERROR("Error while executing: "+b),this.log.ERROR("There was an error while executing instance of tag: "+this.CLASS_NAME+" from package: "+
this.PACKAGE_NAME),this.log.ERROR(b,!0),this._onError(b)}finally{this._onExecute(a)}};a.prototype.getTimeout=function(){return this._getTimeout()};a.prototype._getTimeout=function(a){var b=+this.config.timeout,c=this.dependencies;if(-1!==b&&0<c.length){var d=0;a=a||[];if(-1===k.indexInArray(a,this)){a[a.length]=this;for(var f=0;f<c.length;f++){var h=c[f]._getTimeout(a);h>d&&(d=h)}0<d&&(b+=d)}else return 0}return b};a.prototype._onExecute=function(a){this.onExecute(a)};a.prototype.onExecute=v;a.prototype._flushDocWrites=
function(a){var c=!0;this._docWriteNotFlushed=!1;try{var d=b.getHTMLLocationForTag(this);d&&this._securedWrites&&0<this._securedWrites.length&&(this.log.FINE("flushing document.write proxy array"),this.log.FINE("flushing: "+this._securedWrites.join("\n")),(c=b.flushDocWritesArray(this._securedWrites,d,"END"===this.config.locationPlaceHolder,this.log,a))?this._docWriteFlushed=(new Date).valueOf():this._docWriteNotFlushed=(new Date).valueOf())}catch(f){this.log.ERROR("Unexpected exception during flushing! "+
f),this._onError(f)}a&&a();this._securedWrites&&0<this._securedWrites.length&&(c=!1,this._docWriteNotFlushed=(new Date).valueOf());return c};a.prototype.log=v;a.prototype.finished=function(){return!!this.runIsFinished};a.prototype.script=function(){this.log.INFO("Script run.")};a.prototype.before=function(){this.log.FINE("running before handler...");this.beforeRun=(new Date).valueOf();try{this.onBefore()}catch(a){this.log.ERROR("onBefore error: "+a),this._onError(a)}};a.prototype.onBefore=v;a.prototype.after=
function(a){this.log.FINE("running after...");this.afterRun=(new Date).valueOf();try{this.onAfter(a)}catch(b){this.log.ERROR("onAfter error: "+b),this._onError(b)}};a.prototype.onAfter=function(a){};a.prototype.runOnce=function(){this._runOnceTriggered||this.scriptExecuted?this.log.FINEST("runOnce has been already executed."):(this._runOnceTriggered=(new Date).valueOf(),this.run())};a.CANCEL_ALL=!1;a.prototype.runCounter=0;a.prototype.run=function(){if(this.cancelled||a.CANCEL_ALL)return this._handleCancel(),
!1;if(this.isRunning)return this.log.FINE("loader is currently in progress, try again later."),!1;this.lastRun&&(this.log.FINE("Running again. Run count: "+(this.runCounter+1)),this.reset());this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;this._ignoreDeps=!!this.ignoreDependencies;return this._ignoreDeps||this.dependenciesLoaded()?this._triggerLoadingAndExecution():(this.log.FINE("Dependencies (other loaders) not ready. Attaching handlers."),this._attachDepsEventsToContinue(),!1)};
a.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();this._ignoreDeps?this.execute():this.waitForDependenciesAndExecute();return!0};a.prototype._attachDepsEventsToContinue=function(){this.log.FINE("Attaching success events to dependencies...");this.awaitingDependencies=(new Date).valueOf();for(var a=this.dependencies,b=0;b<a.length;b++)try{a[b].events.on("success",this._depLoadedHandler)}catch(c){this.log.WARN("Cannot set event for dependency -> ",
a[b]),this.log.WARN("Exception: ",c)}this.log.FINE("Attached "+a.length+" handlers.")};a.prototype.dependenciesLoaded=function(){for(var a=this.dependencies,b=0;b<a.length;b++)if(a[b]!==this&&!(0<+a[b].scriptExecuted))return!1;return!0};a.prototype._setTimeout=function(a,b){this._wasTimed=(new Date).valueOf();return d.setTimeout(a,b)};a.prototype._handleCancel=function(){this.addState("CANCELLED");this.log.INFO("loader is cancelled.");try{this.onCancel()}catch(a){this.log.ERROR("Exception at onCancel"+
a),this._onError(a)}};a.prototype.waitForDependenciesAndExecute=function(){this.cancelled?this._handleCancel():this.loadedDependencies?this.execute():this.loadingDependenciesFailed?(this.log.INFO("script execution failed before running: dependencies failed to load."),this._markFailure(),this._markFinished()):this._setTimeout(this.waitForDependenciesAndExecute.bind(this),30)};a.prototype.execute=function(){this.log.FINE("entering execute...");this._triggerExecution()};a.prototype._triggerExecution=
function(){if(this.cancelled)this._handleCancel();else if(!this.scriptExecuted){var a=!0;if(this.shouldWaitForDocWriteProtection())a=!1;else{if(!this._beforeEntered){this._beforeEntered=(new Date).valueOf();a=!1;try{a=this.before()}catch(b){this.log.ERROR("`before` thrown an exception"),this.log.ERROR(b,!0),this._onError(b)}if(a){this.log.INFO("before calback cancelled execution.");this._markFailure();this._markFinished();return}}a=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(!this.scriptExecuted)if(this.unexpectedFail&&
(a=!0),a){this._flushDocWrites();this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail?this._markFailure():(this.log.FINE("Executing..."),this.scriptExecuted=(new Date).valueOf(),this.addState("EXECUTED"),this._executeScript());if(this.cancelled)return this._handleCancel(),!1;a=0<this.scriptExecuted;try{this.afterRun||(this.afterRun=(new Date).valueOf(),this.after(a))}catch(c){this.executedWithErrors=(new Date).valueOf()}this.executedWithErrors||a&&this.events.call("success");this._flushDocWrites();
this._markFinished();this.log.INFO("* stopped ["+(0<this.scriptExecuted?"executed":"not executed")+"] *")}else this._setTimeout(this._triggerExecution.bind(this),30)}};a.prototype._markFailure=function(){this.log.INFO("Script execution failed.");this.scriptExecuted=-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};a.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();this.isRunning=!1;a.LOCK_DOC_WRITE===this&&(this._flushDocWrites(),b.unlockDocumentWrites(),a.LOCK_DOC_WRITE=
!1);this.onFinished(!0)};a.prototype.onFinished=v;a.prototype.onCancel=v;a.prototype.onFinished=v;a.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!a.LOCK_DOC_WRITE)a.LOCK_DOC_WRITE=this,this._secureWriteAndCollectForExecution();else if(a.LOCK_DOC_WRITE!==this)return this._lockedDocWriteInformed||(this._lockedDocWriteInformed=(new Date).valueOf(),this.log.WARN("Tag will wait till document.write be available."),this.log.FINE(a.LOCK_DOC_WRITE,!0)),!0;return!1};
a.prototype.runWithoutDependencies=function(){this.ignoreDependencies=!0;this.run()};a.prototype.loadExecutionURLsAndHTML=function(a){if(this.cancelled)return this._handleCancel(),!0;this._loadExecutionURLsAndHTMLInformed||(this._loadExecutionURLsAndHTMLInformed=!0,this.log.INFO("tag is loaded, trying execution..."));this._triggerURLsLoading(a);return this.loadURLsNotFinished||(this._flushDocWrites(),this._triggerHTMLInjection(),this._flushDocWrites(),this.injectHTMLNotFinished||(this._flushDocWrites(),
this.log.INFO("url and html awaiting has ended..."),this._docWriteNotFlushed))?!1:(this._docWriteFlushed&&this.log.INFO("flushed document.write..."),!0)};a.prototype._triggerURLsLoading=function(a){!this._urlLoadTriggered&&this.config.url&&(this._urlLoadTriggered=!0,this.log.INFO("tag has url option set to: "+this.config.url),this.log.INFO("loading url and delaying execution till link is loaded"),this.loadURLs(!1,a))};a.prototype._triggerHTMLInjection=function(){!this._injectHTMLTriggered&&this.getHtml()&&
(this._injectHTMLTriggered=!0,this.log.FINE("tag has html option set to: "+this.getHtml()),this.log.INFO("injecting html and delaying execution till is ready"),this.injectHTML())};a.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,UNEXPECTED_FAIL:2048,CANCELLED:4096};a.prototype.addState=function(a){if(this.STATE.hasOwnProperty(a)){this.state|=
this.STATE[a];try{this.onStateChange(a)}catch(b){this.log.ERROR(b),this._onError(b)}}};a.prototype.onStateChange=v;a.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};a.prototype.state=a.prototype.STATE.INITIAL;a.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};a.prototype._secureWriteAndCollectForExecution=function(){this._securedWrites||(this._securedWrites=[],b.redirectDocumentWritesToArray(this._securedWrites,
this.log))};a.prototype.allDependenciesLoaded=function(a,b){return 0===this.getDependenciesToBeLoaded(a,b).length};a.prototype.getDependenciesToBeLoaded=function(a,b){var c=b||[];this.injectionLocationReady()||c.push("injection location");var f,h=this.dependencies;for(f=0;f<h.length;f++)h[f]!==this&&(0<+h[f].scriptExecuted||c.push("dependant Tag with name -> "+(h[f].config?h[f].config.name:"anonymous")));for(f=0;f<this.genericDependencies.length;f++)this.genericDependencies[f](this)||c.push("this.genericDependencies["+
f+"] (index: "+f+")");""!==c&&d.maxFrequent(function(){var a=c.join(", ");a?this.log.FINE("Dependencies check: Waiting for: "+a):this.log.FINE("Dependencies check: No basic dependencies.")}.bind(this),5E3,this._lockObjectDepsLoaded);return c};a.prototype.docWriteAsksToWaitForBody=function(){return!(!this.delayDocWrite||!this.config.usesDocumentWrite)};a.prototype._bodyNeededButNotAvailable=function(){return this._dontWaitForInjections()?!1:this._isBodyLocationNeeded()&&!b.bodyAvailable()};a.prototype._isBodyLocationNeeded=
function(){return this.isLoadingAsynchronously()?this._isBodyLocationSet()?!0:"HEAD"===this.config.locationObject&&"END"===this.config.locationPlaceHolder:!1};a.prototype._isBodyLocationSet=function(){var a=this.config.locationObject;return!a||"BODY"===a};a.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return!1;var a=!1;this._isBodyLocationNeeded()&&(a="END"===this.config.locationPlaceHolder);return(a=a||this.fullbodyNeeded||this.docWriteAsksToWaitForBody())&&!k.bodyReady()};
a.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||a.dontWaitForInjectionLocation};a.prototype.injectionLocationReady=function(){return this._dontWaitForInjections()?!0:this._fullBodyNeededAndUnLoaded()?!1:this.isLoadingAsynchronously()?!!b.getHTMLLocationForTag(this):!0};a.prototype._loadingOutOfTimeFrames=function(){return 0>this.getTimeout()?!1:(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};a.prototype.loadDependencies=
function(){this._loadDependencies()};a.prototype.addClientDependenciesList=function(a,b){return this.addDependenciesList(a,g.Define.clientSpaceClasspath())};a.prototype.addDependenciesList=function(b,c){if(b&&0!==b.length){this.failedDependenciesToParse||(this.failedDependenciesToParse=[]);for(var d=this.dependencies,f=0;f<b.length;f++){var h=b[f],g=!1;if(h instanceof a)d.push(h);else if("string"===typeof h){var s=h;c&&(h=c+"."+h);var n=k.getObjectUsingPath(h);n?n instanceof a?d.push(n):g=!0:this.failedDependenciesToParse.push(s)}else g=
!0;g&&(this.log.WARN("Bad object type passed to deps, ignoring."),this.badDepsObjects=this.badDepsObjects||[],k.addToArrayIfNotExist(this.badDepsObjects,h))}}};a.prototype._loadDependencies=function(a){a=a||[];var b=this.dependencies;if(-1===k.indexInArray(a,this)){a[a.length]=this;for(var c=0;c<b.length;c++)b[c].load(a)}};a.prototype.onError=v;a.prototype._onError=function(a){try{this.onError(a)}catch(b){}};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.onLoadTimeout=
v;a.prototype.onScriptsLoadSuccess=v;a.prototype.onScriptLoadError=v;a.prototype.onAllDependenciesLoaded=v;a.prototype.onBeforeLoad=v;a.prototype.load=function(){if(!this.loadStarted){this.loadStarted=(new Date).valueOf();try{this.onBeforeLoad()}catch(a){this.log.ERROR("onBeforeLoad error: "+a),this._onError(a)}this.addState("LOADING_DEPENDENCIES");this.log.INFO("Load started.");try{!this._ignoreDeps&&this.config.loadDependenciesOnLoad&&this.loadDependencies()}catch(b){throw this.log.ERROR("loadDependencies: unexpected exception occured: \n"+
b+"\ntrying to finish... "),b;}l.call(this)}};a.prototype._singleUrlLoadHandler=function(a,b,c){++this.urlsLoaded;a||++this.urlsFailed;if(this.urlsLoaded===b.length)if(this.loadURLsNotFinished=!1,a&&0===this.urlsFailed){this.log.INFO("succesfully loaded "+this.urlsLoaded+" urls.");this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{c&&c(!0)}catch(d){this.log.ERROR("Callback error:"+d),this._onError(d)}finally{this.onScriptsLoadSuccess()}}else{a="error loading urls. Failed "+this.urlsFailed;
this.log.ERROR(a);this._onError(a);this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=!0,c&&c(!1)}catch(f){this.log.ERROR("Callback error:"+f),this._onError(f)}finally{this.onScriptLoadError(a)}}};a.prototype.loadURLs=function(a,b){var c=a||this.config.url;this.addState("LOADING_URL");this.log.FINE("loading URL(s) ...");try{!c||c instanceof Array||(c=[c]);for(var d=0;d<c.length;d++){this.loadURLsNotFinished=!0;var f=c[d],f=this.prepareURL(f);this.log.FINE("loading URL: "+
f+" ...");this.loadURL(f,function(a){this._singleUrlLoadHandler(a,c,b)}.bind(this))}}catch(h){this.log.ERROR("loadURLs thrown unexpected exception! : "+h),this.loadURLsNotFinished=!1,this.addState("UNEXPECTED_FAIL"),this.unexpectedFail=(new Date).valueOf(),this._onError(h)}};a.prototype.prepareLocationObject=function(a){return a};a.prototype.prepareURL=function(a){return a};a.prototype.prepareHTML=function(a){return a};a.prototype.loadURL=function(a,c,d){this.addState("LOADING_URL");b.loadScript({onsuccess:function(){this.log.FINE("succesfully loaded "+
a);try{c&&c(!0)}catch(b){this.log.ERROR("error at callback for "+a+":"+b)}}.bind(this),onerror:function(){this.log.ERROR("error loading "+a);try{c&&c(!1)}catch(b){this.log.ERROR("error at callback for error at "+a+":"+b)}}.bind(this),url:a,node:d||this.config.urlLocation,async:this.isLoadingAsynchronously(),noMultipleLoad:this.config.noMultipleLoad})};a.prototype.reset=function(){this.log.FINE("resetting.");this._securedWrites=this.delayDocWrite=this.scriptLoadingFailed=this.scriptExecuted=this.runIsFinished=
this.loadingTimedOut=this.loadingDependenciesFailed=this.loadedDependencies=this.loadURLsNotFinished=this.loadStarted=this.injectHTMLFailed=this.filtersRunTriggered=this.beforeRun=this.afterRun=this._urlLoadTriggered=this._runOnceTriggered=this._lockedDocWriteInformed=this._loadExecutionURLsAndHTMLInformed=this._injectHTMLTriggered=void 0;this.state=0;this.unexpectedFail=void 0;this.urlsLoaded=this.urlsFailed=0;this.timeoutCountdownStart=this.awaitingDependencies=this._beforeEntered=this.cancelled=
this._lastRun=this.isRunning=this.waitForDependenciesFinished=void 0;this.addState("INITIAL")};a.prototype.isLoadingAsynchronously=function(){return this._wasTimed?!0:!(!this.config.async&&!this.forceAsynchronous)};a.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};a.prototype.injectHTML=function(a){var b=!this.docWriteAsksToWaitForBody(),d=this.prepareHTML(this.getHtml());d&&c.injectHTMLForLoader(this,a,b,d)};a.prototype.clone=function(){return new a(this.config)}})();
(function(){function a(b){k.setIfUnset(b,{filterTimeout:b&&b.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:b&&b.PACKAGE,dedupe:!1,needsConsent:!1,inactive:!1,variables:null,runner:null,disabled:!1,locked:!1});a.SUPER.apply(this,arguments);this.namedVariables={};this.parameters=[];this.filters=[];this.session=null;if(b){this.addState("INITIAL");try{a.register(this)}catch(c){this.log.WARN("Problem with registering tag "+this.config.name),this.log.WARN(c,!0)}this.setupConfig(b);this.uniqueRefString=
null;if(b.init)try{b.init.call(this,b)}catch(d){this.log.ERROR("init call failed:"+d)}this.onTagInit()}}function l(a,b){var c=a.namedVariables,d=f.initPageVariable(c[b]);return c[b]=d}var k=g.opentag.Utils,b=g.opentag.TagsUtils,d=g.opentag.filter.BaseFilter,c=g.opentag.GenericLoader,f=g.opentag.TagHelper,h=g.opentag.pagevariable.BaseVariable,e=g.Cookie,m=new g.opentag.Log("BaseTag -> ");g.Define.clazz("qubit.opentag.BaseTag",a,c);a.prototype.setupConfig=function(a){if(a){a.filters&&this.addFilters(a.filters);
a.parameters&&this.addParameters(a.parameters);if(a.variables)for(var b in a.variables)if(a.variables.hasOwnProperty(b)){var c=this.getParameterByTokenName(b);if(c){var d=a.variables[b];c.variable=d;void 0!==d.defaultValue&&(c.defaultValue=d.defaultValue);void 0!==d.uv&&(c.uv=d.uv)}}a.locked&&this.lock();this.log.FINEST("Initializing variables.");this.initPageVariablesForParameters()}};a.prototype.valueForToken=function(a,b){var c=this.getParameterByTokenName(a);if(c)return void 0===b&&this.loadingTimedOut&&
(b=!0),this.getParameterValue(c,b);if((c=this.namedVariables)&&c[a]&&(c=l(this,a)))return c.getRelativeValue(b)};a.prototype.addParameters=function(a){this.parameters=this.parameters.concat(a)};a.prototype.LOADING_TIMEOUT=5E3;a.prototype.FILTER_WAIT_TIMEOUT=-1;a.prototype.run=function(){this.resolveAllDynamicData();if(this.config.runner){var a=!1;try{this.log.INFO("Running custom runner..."),this.addState("AWAITING_CALLBACK"),a=this._runner=(new Date).valueOf(),this.config.runner.call(this)}catch(b){this.log.ERROR("Error while running custom runner: "+
b)}return a}this._runner=!1;return this.start()};a.prototype.lock=function(){this.locked=!0;this._unlock=null};a.prototype.unlock=function(){this.locked=!1;this._unlock&&(this._unlock(),this._unlock=!1)};a.prototype.start=function(){return this.locked?(this.log.WARN("Tag is locked. Running delegated."),this._unlock=function(){return a.SUPER.prototype.run.call(this)}.bind(this),!1):a.SUPER.prototype.run.call(this)};a.prototype.startOnce=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.runOnce.call(this)}.bind(this),
!1):a.SUPER.prototype.runOnce.call(this)};a.prototype.getFilters=function(){return this.filters};a.prototype.runOnceIfFiltersPass=function(){this._runOnceIfFiltersPassTriggered||this.scriptExecuted||(this._runOnceIfFiltersPassTriggered=(new Date).valueOf(),this.runIfFiltersPass())};a.prototype.runIfFiltersPass=function(){this.resolveAllDynamicData();var a=this.filtersState(!0);this.addState("FILTER_ACTIVE");this.filtersRunTriggered||(this.filtersRunTriggered=(new Date).valueOf());if(a===d.state.SESSION)this.addState("AWAITING_CALLBACK"),
this.log.FINE("tag is in session and will be manually triggered by custom starter"),this.awaitingCallback=(new Date).valueOf();else if(a===d.state.PASS){this.filtersPassed=(new Date).valueOf();this.log.FINE("tag passed filters tests");try{this.onFiltersPassed()}catch(b){this.log.ERROR("error running onFiltersDelayed:"+b)}this.run()}else if(a===d.state.FAIL)this.log.FINE("tag failed to pass filters"),this._markFiltersFailed(),this._markFinished();else if(0<a){var c=this.config.filterTimeout;if(0>c||
(new Date).valueOf()-this.filtersRunTriggered>c){if(!this._awaitingForFilterInformed){this.log.INFO("filters found indicating for tag to wait for applicable conditions - waiting...");this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(f){this.log.ERROR("error running onFiltersDelayed:"+f)}}this._setTimeout(this.runIfFiltersPass.bind(this),a)}else this._markFiltersFailed(),this._markFinished(),this.filtersRunTimedOut=(new Date).valueOf(),this.log.WARN("awaiting for filters timed out.")}try{this.onFiltersCheck(a)}catch(e){this.log.ERROR(e)}return a};
a.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};a.prototype.STATE={INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,TIMED_OUT:8192,UNEXPECTED_FAIL:16384,CANCELLED:32768};a.prototype.addState=function(b){a.SUPER.prototype.addState.call(this,
b);try{a.onStateChange(this)}catch(c){this.log.ERROR(c)}this.stateStack=[];b=this.STATE;var d=this.state,f=this.stateStack;d&b.INITIAL&&f.push("Initial state.");d&b.FILTER_ACTIVE&&f.push("Tag running with filters pass triggered.");d&b.FILTERS_FAILED&&f.push("Filters failed to pass.");d&b.AWAITING_CALLBACK&&f.push("Awaiting callback to run this tag. Not pooling.");d&b.STARTED&&f.push("Tag is initialized and loading has been started.");d&b.LOADING_DEPENDENCIES&&f.push("Dependencies are being loaded.");
d&b.LOADED_DEPENDENCIES&&f.push("Dependencies loading process has been finished.");d&b.LOADING_URL&&f.push("External URL is being loaded.");d&b.LOADED_URL&&f.push("External URL has been loaded.");d&b.EXECUTED&&f.push("Main script has been executed.");d&b.EXECUTED_WITH_ERRORS&&f.push("Main script has been executed but errors occured.");d&b.FAILED_TO_LOAD_DEPENDENCIES&&f.push("Dependencies has failed to load.");d&b.FAILED_TO_LOAD_URL&&f.push("URL location failed to load.");d&b.FAILED_TO_EXECUTE&&f.push("Script failed to execute.");
d&b.TIMED_OUT&&f.push("Script timed out awaiting for dependencies.");d&b.UNEXPECTED_FAIL&&f.push("Script occured UNEXPECTED exception and is failed.");d&b.CANCELLED&&f.push("Tag has been cancelled.")};a.prototype.onTagInit=v;a.onStateChange=v;a.prototype.onFiltersDelayed=v;a.prototype.onFiltersPassed=v;a.prototype.onFiltersCheck=v;a.prototype.state=a.prototype.STATE.INITIAL;a.prototype.arePageVariablesLoaded=function(a){return f.allParameterVariablesReadyForTag(this,a)};a.prototype.getDependenciesToBeLoaded=
function(b,c){var d=c||[];this.arePageVariablesLoaded(b)||d.push("page variables");return a.SUPER.prototype.getDependenciesToBeLoaded.call(this,b,d)};a.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};a.prototype.resolveDependencies=function(){var a=this.failedDependenciesToParse;a&&(this.failedDependenciesToParse=null,this.addDependenciesList(a,g.Define.clientSpaceClasspath()));return this.dependencies};a.prototype.addClientVariablesMap=
function(a){return this.unresolvedClientVariablesMap=this.addVariablesMap(a,g.Define.clientSpaceClasspath())};a.prototype.resolvePageVariables=function(){var a=this.unresolvedClientVariablesMap;a&&(this.unresolvedClientVariablesMap=null,this.addClientVariablesMap(a));return this.getPageVariables()};a.prototype.addVariablesMap=function(a,b){if(a){var c={},d=this.namedVariables,f;for(f in a)if(a.hasOwnProperty(f)){var e=a[f];if(e instanceof h)d[f]=e;else if("string"===typeof e){var m=e;b&&(e=b+"."+
e);k.getObjectUsingPath(e)?d[f]=e:c[f]=m}else this.log.ERROR("Added variable is of wrong type!"),this.log.ERROR(e)}return c}};a.prototype.prepareURL=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareLocationObject=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareHTML=function(a){a&&(a=this.replaceTokensWithValues(a));return a};a.prototype._executeScript=function(){if(this.config&&this.config.script)if("function"===typeof this.config.script)this.script=this.config.script;
else{var b=this.replaceTokensWithValues(String(this.config.script));this.script=k.expressionToFunction(b).bind(this)}a.SUPER.prototype._executeScript.call(this)};a.prototype.replaceTokensWithValues=function(a){if(!a||-1===a.indexOf("${"))return a;var b=this.parameters;if(b)for(var c=0;c<b.length;c++){var d=this.getVariableForParameter(b[c]);if(d){var f=b[c].token,e=this.valueForToken(f);a=d.replaceToken(f,a,e)}}return a};a.prototype.getParameter=function(a){var b=this.parameters,c=null;if(b)for(var d=
0;d<b.length;d++)b[d].name===a&&(c=b[d]);return c};a.prototype.setParameterValueByTokenName=function(a,b){var c=this.getParameterByTokenName(a);return null!==c?(c.variable={value:b},!0):!1};a.prototype.getParameterValue=function(a,b){var c="string"===typeof a?this.getParameter(a):a;if(c){var d=this.getVariableForParameter(c);if(d)try{var f;b&&""!==c.defaultValue&&(f=k.gevalAndReturn(c.defaultValue).result);return f=d.getRelativeValue(b,f)}catch(e){this.log.ERROR("error while trying to resolve variable value:"+
e),this.log.ERROR("Variable defaults string is invalid: "+c.defaultValue)}}};a.prototype.filtersState=function(a){return b.filtersState(this.filters,this.session,this,a)};a.prototype.addFilter=function(a){k.addToArrayIfNotExist(this.filters,a)};a.prototype.addFilters=function(a){for(var b=0;b<a.length;b++)this.addFilter(a[b])};a.prototype.addClientFiltersList=function(a){return this.unresolvedClientFilterClasspaths=this.addFiltersList(a,g.Define.clientSpaceClasspath())};a.prototype.resolveFilters=
function(){var a=this.unresolvedClientFilterClasspaths;a&&(this.unresolvedClientFilterClasspaths=null,this.addClientFiltersList(a));return this.filters};a.prototype.addFiltersList=function(a,b){for(var c=[],f=0;f<a.length;f++)try{var e=a[f],h=e,m=null;"string"===typeof e&&(b&&(e=b+"."+e),m=e,e=k.getObjectUsingPath(e));"function"===typeof e&&(e=new e);e||this.log.FINE("Filter "+h+" does NOT exists.");!e instanceof d&&(this.log.ERROR("Not a filter! ",e),e=null);e?this.addFilter(e):m&&k.addToArrayIfNotExist(c,
m)}catch(g){this.log.FINE("Failed adding filter: "+a[f]),this.failedFilters=this.failedFilters||[],this.failedFilters.push(a[f])}return c};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);this.resetFilters();this._runner=this.filtersRunTriggered=this._runOnceIfFiltersPassTriggered=this.pingSent=this.dedupePingSent=this.filtersPassed=void 0};a.prototype.resetFilters=function(){for(var a=0;a<this.filters.length;a++)this.filters[a].reset()};a.prototype.getParameterByTokenName=function(a){var b=
null;if(this.parameters)for(var c=this.parameters,d=0;d<c.length;d++)c[d].token===a&&(b=c[d]);return b};a.prototype.removeFilter=function(a){k.removeFromArray(this.filters,a)};var u=0,p=[],r={},q={};a.register=function(a){m.FINEST('registering tag named "'+a.config.name+'", instance of:');m.FINEST(a,!0);var b=k.addToArrayIfNotExist(p,a);-1!==b&&m.FINE("tag already exists in tags registry.");a._tagIndex=-1===b?p.length-1:b;a.config.id?(b="Q"+a.config.id,q[b]=a,a.uniqueId=b):q[a.CLASSPATH]=a};a.getById=
function(a){return q[String(a)]};a.prototype.getById=a.getById;a.prototype.unregister=function(b){a.unregister(b||this)};a.unregister=function(a){m.FINEST('Un-registering tag named "'+a.config.name+'", instance of:');m.FINEST(a,!0);var b=k.removeFromArray(p,a);b&&0!==b.length||m.FINEST("tag "+a.config.name+" is already unregisterd.");a._tagIndex=-1};a.getTags=function(){return p};a.getAccessorsMap=function(){return r};a.prototype.getTags=function(){return p};a.prototype.initPageVariablesForParameters=
function(){var a=this.parameters;if(a)for(var b=0;b<a.length;b++)a[b].variable=f.validateAndGetVariableForParameter(a[b]);if(a=this.namedVariables)for(var c in a)a.hasOwnProperty(c)&&(a[c]=f.initPageVariable(a[c]))};a.prototype.getPageVariables=function(){var a=this.parameters,b=[];if(a)for(var c=0;c<a.length;c++){var d=this.getVariableForParameter(a[c]);null!==d&&k.addToArrayIfNotExist(b,d)}if(this.namedVariables)for(var f in this.namedVariables)k.addToArrayIfNotExist(b,l(this,f));return b};a.prototype.getAccessorString=
function(){this._accessorsMapKey||(this._accessorsMapKey="_"+u++,r[this._accessorsMapKey]=this);return"qubit.opentag.BaseTag.getAccessorsMap()."+this._accessorsMapKey};a.prototype.getVariableForParameter=function(a){var b=f.validateAndGetVariableForParameter(a),c=this.namedVariables;(!b||b.config.empty)&&c&&c[a.token]&&(b=l(this,a.token));return b};a.prototype.printVariablesState=function(){var a=[];this.log.FINE("Tag has been timed out, showing variables:");for(var b=f.getAllVariablesWithParameters(this),
c=0;c<b.length;c++){var d=b[c].parameter,e=b[c].variable,h;h=d&&d.token?this.valueForToken(d.token):e.getRelativeValue(!0);e={name:e.config.name,exists:e.exists(),token:d?d.token:null,value:h,variable:e};a.push(e);this.log.FINE(" Variable Name: "+e.name+", Exists: "+e.exists+", Token: "+(d?d.token:"<param is not assigned>")+", Value:"+h)}return a};a.prototype._triggerOnLoadTimeout=function(){this.printVariablesState();this.onLoadTimeout()};a.prototype._getUniqueId=function(){var a=this.config.name;
this.config.id&&(a=this.config.id);return a};a.prototype.cookieSaysToRunEvenIfDisabled=function(){var a=this._getUniqueId(),b=!!e.get("qubit.tag.forceAllToRun");b||(b=!!e.get("qubit.tag.forceRunning_"+a));return b};a.prototype.setCookieForcingTagToRun=function(){var a=this._getUniqueId();e.set("qubit.tag.forceRunning_"+a,"true")};a.setCookieForcingTagsToRun=function(){e.set("qubit.tag.forceAllToRun","true")};a.prototype.setCookieToDisable=function(){var a=this._getUniqueId();e.set("qubit.tag.disableRunning_"+
a,"true")};a.prototype.rmCookieToDisable=function(){var a=this._getUniqueId();e.rm("qubit.tag.disableRunning_"+a)};a.prototype.disabledByCookie=function(){var a=this._getUniqueId();return!!e.get("qubit.tag.disableRunning_"+a)};a.rmCookieForcingTagsToRun=function(){e.rm("qubit.tag.forceAllToRun")};a.prototype.rmCookieForcingTagToRun=function(){var a=this._getUniqueId();e.rm("qubit.tag.forceRunning_"+a)};a.rmAllDisablingCookies=function(){k.rmCookiesMatching("qubit.tag.disableRunning_")};a.rmAllCookiesForcingTagToRun=
function(){k.rmCookiesMatching("qubit.tag.forceRunning_");a.rmCookieForcingTagsToRun()}})();(function(){function a(b){k.setIfUnset(b,a.defaultConfig);if(this.singleton){var d=g.opentag.Utils.getObjectUsingPath(this.PACKAGE_NAME+"."+this.CLASS_NAME,G);if(d.__instance)return d.__instance.log.FINEST("Returning singleton instance."),d.__instance;d.__instance=this}a.SUPER.call(this,b)}function l(a,d){var c=a.toString(),c=c.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,""),c=c.substring(0,c.lastIndexOf("}")),
c=c.replace(/(["']\s*\+\s*)\s*_*this\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,'$1"${$2}"'),c=c.replace(/\s*_*this\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),c=c.replace(/(["']\s*\+\s*)\s*_*this\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"'),c=c.replace(/\s*_*this\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),c=c.replace(/\s*_*this\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,"${$1}"),c=c.replace(/\s*_*this\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,
"${$1}"),c=d.replaceTokensWithValues(c);k.geval(c)}var k=g.opentag.Utils;g.Define.clazz("qubit.opentag.LibraryTag",a,g.opentag.BaseTag);a.defaultConfig={vendor:null,imageUrl:null,description:"",async:!1,isPrivate:!1,upgradeable:!0,html:"",parameters:[]};a.prototype.pre=function(){this.log.FINEST("emtpy pre called")};a.prototype.post=function(){this.log.FINEST("emtpy post called")};a.prototype.before=function(){a.SUPER.prototype.before.call(this);if(this.getHtml()||this.config.script)return this.log.FINE("html or config.script is set while using pre. Cancelling running pre."),
!1;this.log.INFO("Running PRE script execution...");try{var b=this.config;if(b&&b.pre)if("function"===typeof b.pre)this.pre=b.pre;else{var d=this.replaceTokensWithValues(String(b.pre));this.pre=k.expressionToFunction(d).bind(this)}this.config.prePostWindowScope&&this.pre!==a.prototype.pre&&this.pre.toString?l(this.pre,this):this.pre()}catch(c){return this.log.ERROR(this.config.name+" exception while running pre: "+c),!0}return!1};a.prototype.after=function(b){a.SUPER.prototype.after.call(this,b);
if(this.getHtml()||this.config.script)this.log.WARN("html or config.script is set while using post. Cancelling running post.");else{this.log.INFO("Running POST script execution...");try{var d=this.config;if(d&&d.post)if("function"===typeof d.post)this.post=d.post;else{var c=this.replaceTokensWithValues(String(d.post));this.post=k.expressionToFunction(c).bind(this)}this.config.prePostWindowScope&&this.post!==a.prototype.post&&this.post.toString?l(this.post,this):this.post(b)}catch(f){this.log.ERROR(this.config.name+
" exception while running pre: "+f)}}};a.define=function(b,d){b=b.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");b=g.Define.vendorsSpaceClasspath()+"."+b;var c={};d.getDefaultConfig&&(c=d.getDefaultConfig());var f=d.CONSTRUCTOR,h={},e;for(e in d)"config"!==e&&(h[e]=d[e]);h=g.opentag.Utils.defineWrappedClass(b,a,h,A,function(a){a=a||{};a=k.overrideFromBtoA(c,a);var b=g.opentag.LibraryTag.call(this,a);f&&f.call(this,a);if(b)return b});0!==b.indexOf("qubit.vs.")&&k.namespace("qubit.vs."+
b,h);return h};a.getLibraryByClasspath=function(a){return k.getObjectUsingPath(a,g.Define.getVendorSpace())}})();(function(){function a(){}var l=g.opentag.LibraryTag,k=g.Define;a.library=function(){return l.define.apply(l,arguments)};a.libraryRef=function(){return l.getLibraryByClasspath.apply(l.getLibraryByClasspath,arguments)};k.namespace("qubit.Quick",a)})();(function(){function a(a){if(a)if(a.alphabet)for(this.alphabet=a.alphabet,this.dict={},a=0;a<this.alphabet.length;a++)this.dict[this.alphabet[a]]=
a;else this.alphabet=k,this.dict=c}function l(a,b){for(var c in b)if(a===b[c])return c;return null}for(var k=[],b=Math.pow(2,8),d=0;d<b;d++)k.push(String.fromCharCode(d));for(var c={},b=0;b<k.length;b++)c[k[b]]=b;g.Define.clazz("qubit.compression.LZW",a);a.prototype.encode=function(a){for(var b=this.alphabet.length,c={},d=[],k=0,g=a.charAt(k++),l,q=this.dict;l=a.charAt(k++);){var s=g+l;if(q.hasOwnProperty(s)||c.hasOwnProperty(s))g=s;else{var n=q.hasOwnProperty(g)?q[g]:c[g];if(void 0===n)throw"Dictionary base is to small for those contents: "+
g;d.push(n);c[s]=b++;g=l}}""!==g&&d.push(c.hasOwnProperty(g)?c[g]:q[g]);return d};a.prototype.decode=function(a){for(var b=this.dict,c=this.alphabet.length,d,k={},g=l(a[0],b),r=g,q=[g],s=1;s<a.length;s++){var n=a[s];d=l(n,b);null===d&&(k.hasOwnProperty(n)&&(d=k[n]),null===d&&(d=r+g));q.push(d);g=d.charAt(0);k[c++]=r+g;r=d}return q.join("")}})();(function(){function a(a){}for(var l={},k=0;45>k;k++)l["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(k)]=k;for(var b={},k=0;45>k;k++)b['ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(k)]=
k;for(var d={},k=0;45>k;k++)d["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(k)]='ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(k);var c="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".split(""),f=c.length,h=new g.compression.LZW({});g.Define.clazz("qubit.compression.Compressor",a);a.prototype.compress=function(a,b){for(var c=(b||h).encode(a),d=[],f=0;f<c.length;f++)d.push(String.fromCharCode(c[f]));return d.join("")};a.prototype.compressAnsi=function(a,b){for(var k=(b||h).encode(a),
g=[],l=0;l<k.length;l++){var q;q=k[l];var s=0,n=0>q;n&&(q=-q);var w="",t=!0;do s=q%f,t?(w=d[c[s]],t=!1):w=c[s]+w,q=(q-s)/f;while(0<q);q=n?"-"+w:w;g.push(q)}return g.join("")};a.prototype.decompressAnsi=function(a,c){for(var d=[],k="",g=0;g<a.length;g++){var q=a.charAt(g);if(b.hasOwnProperty(q)){for(var q=k+q,k="",s=0,n=0,w=!0,t=0;t<q.length;t++){var B=q.charAt(q.length-1-t);w&&(w=!1,B="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(b[B]));s+=l[B]*Math.pow(f,n++)}q=s;d.push(q)}else k+=q}return(c||
h).decode(d)};a.prototype.decompress=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a.charCodeAt(d));return(b||h).decode(c)}})();(function(){var a=new g.opentag.Log("Tags -> "),l=g.opentag.Utils,k=g.opentag.filter.BaseFilter,b=function(){};g.Define.clazz("qubit.opentag.Tags",b);b.getById=function(a){return g.opentag.BaseTag.getById(String(a))};b.getAllTagsByState=function(){return g.opentag.Container.getAllTagsByState(b.getTags())};b.findTagByName=function(a){for(var b=this.getTags(),d=[],e=
0;e<b.length;e++)b[e].config.name===a&&d.push(b[e]);return d};b.findTagByMatch=function(a){for(var b=this.getTags(),d=[],e=0;e<b.length;e++)b[e].config.name.match(a)&&d.push(b[e]);return d};b.findTagContainers=function(a){for(var d=b.getContainers(),h=[],e=0;e<d.length;e++){var k=d[e].tags,g;for(g in k)if(k[g]===a){h.push(d[e]);break}}return h};b.getTags=function(){a.FINEST("getTags");return g.opentag.BaseTag.getTags()};b.resetAllTags=function(){a.WARN("reseting all tags!");for(var c=b.getTags(),
d=0;d<c.length;d++)c[d].reset()};b.getContainersPageVariables=function(){for(var a=b.getContainers(),d=[],h=0;h<a.length;h++)d=d.concat(a.getPageVariables());return d};b.getAllPageVariables=function(){for(var a=b.getTags(),d=[],h=0;h<a.length;h++)d=d.concat(a[h].getPageVariables());return d};b.cancelAll=function(){for(var a=b.getTags(),d=0;d<a.length;d++)a[d].cancel()};b.resetAll=function(){for(var a=b.getTags(),d=0;d<a.length;d++)a[d].reset()};b.getPageVariableByName=function(a){for(var d=b.getAllPageVariables(),
h=[],e=0;e<d.length;e++)d[e].config.name===a&&h.push(d[e]);return h};b.getLoadTime=function(a){var b=a.beforeRun,d=a.runIsFinished;return isNaN(d)?{tag:a,loadTime:null}:{tag:a,loadTime:d-b}};b.getLoadTimes=function(a){var d=[];if(a instanceof g.opentag.BaseTag)return d.push([b.getLoadTime(a[h])]),d;a=a||b.getTags();if(a instanceof Array)for(h=0;h<a.length;h++)a[h]instanceof g.opentag.BaseTag&&d.push(b.getLoadTime(a[h]));else for(var h in a)a[h]instanceof g.opentag.BaseTag&&d.push(b.getLoadTime(a[h]));
return d};b.forceAllContainersAndTagsToRunIfDisabled=function(){g.opentag.Container.setCookieForDisabledContainersToRun();g.opentag.BaseTag.setCookieForcingTagsToRun()};b.rmAllContainersAndTagsForcingFlags=function(){g.opentag.Container.rmCookieForDisabledContainersToRun();g.opentag.BaseTag.rmAllCookiesForcingTagToRun()};b.getContainers=function(){return g.opentag.Container.getContainers()};b.findAllTagsByClassPath=function(c){var d=(new Date).valueOf(),h=[],e=[];try{e.push(g.opentag.CustomTag),e.push(g.opentag.LibraryTag)}catch(k){a.FINEST("Warning:Missing known libraries: CustomTag, LibraryTag")}for(var r=
b.getTags(),p=0;p<r.length;p++){var y=r[p];0>l.indexInArray(e,y)&&0===y.PACKAGE_NAME.indexOf(c)&&(h.push(y),a.FINEST("findAllTagsByClassPath(): found: "+y.PACKAGE_NAME+" -> "+y.config.name))}a.FINE("findAllTags(): selection found in "+((new Date).valueOf()-d));return h};b.findAllTags=function(c,d){var h=g.opentag.BaseTag,e=[],k=(new Date).valueOf();try{e.push(g.opentag.CustomTag),e.push(g.opentag.LibraryTag)}catch(l){a.FINEST("Warning:Missing known libraries: CustomTag, LibraryTag")}h=b.findAllInstances(c,
h,e,d);a.FINE("findAllTags(): found in "+((new Date).valueOf()-k));return h};var d=function(b,d,h,e){var k=[];"string"===typeof b&&(b=l.getObjectUsingPath(b));if(b){var g={objectsOnly:!0};e&&(g.maxDeep=!0);g.track=!0;e=(new Date).valueOf();var p=function(b,c,e,n){if(d(b)){for(c=0;c<h.length;c++)if(h[c]===b)return!0;a.FINE("found ["+n+"]:"+(b.config?b.config.name:e));l.addToArrayIfNotExist(k,b);return!0}return!1}.bind(this);l.traverse(b,p,g);a.FINE("Found in "+((new Date).valueOf()-e))}return k};b.findAllInstances=
function(a,b,h,e){return d(a,function(a){return a instanceof b},h,e)};b.findAllInheriting=function(a,b,h,e){return d(a,function(a){return a.prototype instanceof b},h,e)};b.findAllFilters=function(c,d){var h=[];try{h.push(g.opentag.filter.SessionVariableFilter),h.push(g.opentag.filter.Filter),h.push(g.opentag.filter.URLFilter)}catch(e){a.FINE("Warning: Missing known libraries: CustomTag, LibraryTag")}return b.findAllInheriting(c,k,h,d)};a.INFO("*** Qubit TagSDK *** ",!0,"font-size: 22px; color:#CCC;text-shadow:#fff 0px 1px 0, #555 0 -1px 0;")})();
(function(){function a(){}var l=new g.opentag.Log("Ping -> ");g.Define.clazz("qubit.opentag.Ping",a);a.prototype.send=function(a,b){for(var d=a.config,c="c="+d.clientId+"&p="+a.getContainerId()+"&l="+d.tellLoadTimesProbability+"&pv="+K.update()+"&d=",f=[],h=0;h<b.length;h++){var e=b[h].tag,g=b[h].loadTime;if(null!==g&&!isNaN(g)){var u=e.config.id;!e.pingSent&&u&&null!==g?void 0!==u?(f.push('"'+u+'":'+g),e.pingSent=!0):l.WARN("send: tag `"+e.config.name+"` has no ID assigned! Time load will not be sent."):
e.pingSent?l.FINEST("send: ping already sent for `"+e.config.name+"`, ignoring."):null===g&&l.FINEST("send: null load times for `"+e.config.name+"`, ignoring (ping not sent).")}}d.pingServerUrl&&0<f.length?(c+=encodeURIComponent("{"+f.join(",")+"}"),d="//"+d.pingServerUrl+"/tag2?"+c,l.FINE("send: sending pings "+d),r.PostData(d,null,"GET")):(f.length||l.FINE("send: no pings to sent"),d.pingServerUrl||l.WARN("send: config.pingServerUrl is unset!"))};a.prototype.sendErrors=function(a,b){l.WARN("Errors sending is disabled.")};
a.prototype.sendDedupe=function(a,b){for(var d=a.config,c="c="+d.clientId+"&p="+a.getContainerId()+"&l="+d.tellLoadTimesProbability+"&pv="+K.update()+"&dd=",f=[],h=0;h<b.length;h++){var e=b[h],g=e.config.id;void 0===g?l.WARN("sendDedupe: tag `"+e.config.name+"` has no ID assigned! Deduplicaton time load will not be sent."):e.dedupePingSent||(f.push(g),e.dedupePingSent=!0)}0<f.length&&d.pingServerUrl?(c+=encodeURIComponent("["+f.join(",")+"]"),r.PostData("//"+d.pingServerUrl+"/tag2?"+c,null,"GET")):
(f.length||l.FINE("sendDedupe: no dedupe pings to sent"),d.pingServerUrl||l.WARN("sendDedupe: config.pingServerUrl is unset!"))}})();(function(){function a(a){for(var b=[],c=0;c<a.length;c++){var f=d(a[c][0]);b.push([new RegExp(f,"g"),"*"+a[c][1]])}return b}function l(a,b){for(var c=0;c<b.length;c++)if(b[c][1]===a)return b[c][0];return null}function k(b){this._regexDefs=m;this._defs=e;b&&b.definitions&&(this._regexDefs=a(b.definitions),this._defs=b.definitions)}function b(a,b){for(var c=[],d=0;d<
a.length;d++){var f=!0;b&&(f=a.charCodeAt(d)<=b);var e=h.cookieAlphabetMap.hasOwnProperty(a.charAt(d));f&&!e?c.push("*"+a.charCodeAt(d)+"."):c.push(a.charAt(d))}return c.join("")}function d(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function c(a){for(var b={},c="",d=0;d<a.length;d++){var f=a.charAt(d);r[f]?c+=f:(isNaN(b[c])&&(b[c]=a.split(c).length-1),c="")}a=[];for(var e in b)b.hasOwnProperty(e)&&(c=b[e],c>=v&&e.length>=p&&a.push([e,c]));return a=a.sort(function(a,b){return a[0].length===
b[0].length?0:b[0].length>a[0].length?1:-1})}var f=g.Define,h=g.Cookie,e=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww","10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',
"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["<","S"],[">","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'","i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]],m=a(e);f.clazz("qubit.opentag.compression.Encoder",
k);k.prototype.encode=function(a,f){for(var e=a.replace(/\*/g,"**"),h=c(e),k=0;k<this._regexDefs.length;k++)var g=this._regexDefs[k],e=e.replace(g[0],g[1]);e=e.replace(/;/g,"*-");e=e.replace(/&/g,"*.");e=e.replace(/\\/g,"*/");e=e.replace(/=/g,"*+");e=e.replace(/\n/g,"*N");e=e.replace(/ /g,"*_");e=e.replace(/\t/g,"*T");e=e.replace(/"/g,"*Q");k=c(e);k.concat(h);for(var h=e.replace(/@/g,"@@"),g=[],m=0,l=0;m<k.length;m++){var p=new RegExp(d(k[m][0]),"g"),p=h.replace(p,"@"+l+"-");p!==h&&(g.push(k[m][0]),
l++,h=p)}k=[h,g];h=k[1];(g=0<h.length)&&(e=k[0]);e=f?b(e,f):b(e);return g?"Y"+h.join("*")+"@"+e:"N"+e};for(var r={},f=0;65>f;f++)r["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.".charAt(f)]=!0;var p=4,v=2;k.prototype.decode=function(a){var b=null;if("N"===a.charAt(0))a=a.substring(1);else if("Y"===a.charAt(0)){var c=a.indexOf("@");if(0<=c&&(b=a.substring(1,c),b=b.split("*"),a=a.substring(c+1),b&&0!==b.length&&a)){for(var c="",d=!1,f=!1,e="",h=0;h<a.length;h++){var k=a.charAt(h);
"@"===k||d||f?d||f?(d=!1,"@"===k?c+="@":isNaN(+("-"+k))?f?(c=b&&"-"===k&&b[+e]?c+b[+e]:c+("@"+e+k),e="",f=!1):c+="@"+k:(f=!0,e+=k)):d=!0:c+=k}e&&(c+="@"+e);d&&(c+="@");a=c}}b="";d=c=!1;f="";for(e=0;e<a.length;e++)h=a.charAt(e),"*"===h||c||d?c||d?(c=!1,isNaN(+("-"+h))?d?(b="."===h?b+String.fromCharCode(+f):"-"===h&&l(f+"-",this._defs)?b+l(f+"-",this._defs):b+("*"+f+h),f="",d=!1):"*"===h?b+="*":"-"===h?b+=";":"/"===h?b+="\\":"."===h?b+="&":"+"===h?b+="=":"N"===h?b+="\n":"_"===h?b+=" ":"T"===h?b+="\t":
"Q"===h?b+='"':null!==l(h,this._defs)?(h=l(h,this._defs),b+=h):b+="*"+h:(f+=h,d=!0)):c=!0:b+=h;f&&(b+="*"+f);c&&(b+="*");return b}})();(function(){function a(a){this.testBinary=!1;this.binSupported=d;a&&(b.FINEST("Created compressor instance."),this.compressor=new g.compression.Compressor,this.encoder=new g.opentag.compression.Encoder({}))}var l=g.Define,k=g.Cookie,b=new g.opentag.Log("CookieCompressor -> "),d=!1;l.clazz("qubit.opentag.compression.CookieCompressor",a);a.prototype.compress=function(a,
d){if("string"!==typeof a||""===a)return a;b.FINEST("Compressing...");var h=this.encoder.encode(a),e;if(this.binSupported||this.testBinary){e=this.compressor.compress(h);e='"B'+this.encoder.encode(e,128)+'"';k.set("__qtag_test_bin__",e,void 0,void 0,!0);var g=k.get("__qtag_test_bin__",!0);k.rm("__qtag_test_bin__");g&&g!==e&&(e=null,b.FINEST("Binary cookie saving trial failed."))}g=this.encoder.encode(this.compressor.compressAnsi(h));h=!d&&h.length<=g.length?"E"+h:"C"+g;if(e&&e.length<h.length)return b.FINEST("Binary compression ratio:"+
e.length/a.length),e;b.FINEST("Compression ratio: "+h.length/a.length);return h};a.prototype.decompress=function(a){if("string"!==typeof a||""===a)return a;'"'===a.charAt(0)&&(a=a.substring(1,a.length-1));b.FINEST("Decompressing...");var d=a.charAt(0);a=a.substring(1);switch(d){case "E":return this.encoder.decode(a);case "C":return a=this.compressor.decompressAnsi(this.encoder.decode(a)),this.encoder.decode(a);case "B":return a=this.compressor.decompress(this.encoder.decode(a)),this.encoder.decode(a);
default:throw"This code is not supported! Code: "+d;}}})();(function(){var a=g.Cookie,l=g.opentag.Utils,k=new g.opentag.Log("Session -> "),b=function(){};g.Define.clazz("qubit.opentag.Session",b);var d=new g.opentag.compression.CookieCompressor({});b.readCompressedCookie=function(b){b=a.get(b,!0);return d.decompress(b)};b.setupSession=function(c){var f=c.config,h,e,g,r,p;h={};h.sessionCount=D.update(f.cookieDomain);p="qtag_"+c.getContainerId();var v="x_qtag_"+c.getContainerId();g=a.get(p);c=!!g;null===
g&&(g=a.get(v,!0),g=d.decompress(g));if(g)try{g=z.parse(g)}catch(q){g={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else g={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};e=(new Date).getTime();h.sessionCount!==parseInt(g.sc,10)?(g.sessionStartTime=e,g.sc=h.sessionCount,g.sessionCount+=1,g.referrer.push({url:b.getReferrer(),landing:l.getUrl().substring(0,300),time:e}),g.sessionLandingPage=l.getUrl().substring(0,
300)):b.isReferrerDifferent()&&!b.referrerIsSameAsPrevious(g.referrer,e,18E5)&&(g.referrer.push({url:b.getReferrer(),landing:l.getUrl().substring(0,300),time:e}),g.sessionLandingPage=l.getUrl().substring(0,300),g.sessionStartTime=e,g.sessionCount+=1);h.sessionCount=g.sessionCount;h.sessionStartTime=g.sessionStartTime;h.pageStartTime=e;g.pageViews+=1;h.pageViews=g.pageViews;h.sessionLandingPage=g.sessionLandingPage;h.referrer=g.referrer;5<h.referrer.length&&h.referrer.splice(2,h.referrer.length-5);
r=z.stringify(g);for(e=0;d.compress(r).length>f.maxCookieLength&&5>e;)3<=g.referrer.length?g.referrer.splice(2,1):2===g.referrer.length?g.referrer=[g.referrer[0]]:1===g.referrer.length&&(g.referrer=[]),r=z.stringify(g),e+=1;h.referrer=g.referrer;c&&a.rm(p);p=d.compress(r);a.rm(v);0<f.maxCookieLength&&a.set(v,p,365,f.cookieDomain,!0);h.setVariable=function(b,c,e){g.__v[b]=[c,e?e:0];b=d.compress(z.stringify(g));0<f.maxCookieLength?a.set(v,b,365,f.cookieDomain,!0):a.rm(v)};h.getCookie=function(b,c){var f=
a.get(b,!0);if(f&&(c||0===b.indexOf("x_"))){k.FINE("getCookie() : Comressed cookie accessed:\n"+b+"="+f);try{f=d.decompress(f)}catch(e){k.ERROR("Cookie failed to decompress: "+e)}}else null!==f&&(f=a.decode(f));return f};h.getVariable=function(a){var b;if(a=g.__v[a])if(b=a[1],0===b||b>(new Date).getTime())return a[0];return null};h.on=function(a,b,c){b.attachEvent?b.attachEvent("on"+a,c):b.addEventListener&&b.addEventListener(a,c,!1)};h.getTagCookie=function(){return b.readCompressedCookie(v)};return b.lastSession=
h};b.referrerIsSameAsPrevious=function(a,d,g){var e,k;return 0<a.length?(e=b.getReferrer(),k=l.getUrl().substring(0,300),a=a[a.length-1],a.url===e&&a.landing===k&&a.time+g>d):!1};b.isReferrerDifferent=function(){var a,d;d=b.getReferrer();a=d.indexOf("://");if(-1===a)return!0;try{return 0!==d.substring(a+3).indexOf(b.getDomain())?!0:!1}catch(g){return!0}};b.getReferrer=function(){return document.referrer?document.referrer.substring(0,300):"direct"};b.getDomain=function(){return document.location.host}})();
(function(){function a(b){this.runQueue=[];this.log=new g.opentag.Log("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),!0);this.tags={};this.config={cookieDomain:"",maxCookieLength:1E3,gzip:!0,delayDocWrite:!1,clientId:"",name:"",tellLoadTimesProbability:0,pingServerUrl:null,trackSession:null,disabled:!1,containerId:"",scanTags:!1,noPings:!1};this.ignoreTagsState=!1;if(b){this.setConfig(b);this.isTellingLoadTimes=this.config.tellLoadTimesProbability>Math.random();b.name||
(this.config.name="Cont-"+p++);a.register(this);this.log.FINE("container registered.");a.NO_PINGS&&(this.config.noPings=!0);this.ping=new g.opentag.Ping(this.config);var c=this.sendPings.bind(this);this._pingAsyncCallback=function(){f.setTimeout(c,5)};if(b.init)try{b.init.call(this,b)}catch(d){this.log.ERROR("init call failed:"+d)}}return this}function l(a,b,c){a[c]&&(s[c]=s[c]||1,c+="("+s[c]+")",s[c]++);a[c]=b}var k=g.opentag.Utils,b=g.opentag.filter.BaseFilter,d=g.opentag.filter.SessionVariableFilter,
c=g.opentag.BaseTag,f=g.opentag.Timed,h=g.opentag.Tags,e=g.opentag.Session,m=g.Cookie,r=new g.opentag.Log("Container -> "),p=1;try{window.opentag_consentGiven=function(){a.consentIsGiven=!0;for(var b=a.getContainers(),c=0;c<b.length;c++)try{b[c].run()}catch(d){r.ERROR("error running consent dependant containers: "+d)}}.bind(this)}catch(y){r.WARN("opentag_consentGiven could not be set!")}g.Define.clazz("qubit.opentag.Container",a);var q=[];a.register=function(a){k.addToArrayIfNotExist(q,a)};a.findContainersByName=
function(a){for(var b=this.getContainers(),c=[],d=0;d<b.length;d++)b[d].config.name===a&&c.push(b[d]);return c};a.getById=function(a){for(var b=this.getContainers(),c=0;c<b.length;c++)if(b[c].getContainerId()===a)return b[c];return null};a.prototype.unregister=function(){a.unregister(this)};a.unregister=function(a){k.addToArrayIfNotExist(q,a);r.FINEST('Un-registering container named "'+a.config.name+'", instance of:');r.FINEST(a,!0);(a=k.removeFromArray(q,a))&&0!==a.length||r.FINE("container is already unregisterd.")};
a.prototype.hasConsent=function(){return"Accepted"===m.get("qubitconsent")};a.prototype.register=function(b){a.register(b||this)};a.getContainers=function(){return q};a.prototype.getContainers=function(){return a.getContainers()};a.prototype.onTagRegistered=function(a){};a.prototype.registerTag=function(a){var b=a.config.name;if(this.tags[b])this.log.FINE("Tag with name `"+b+"` already is registered!");else{this.tags[b]=a;try{this.onTagRegistered(a)}catch(c){this.log.ERROR("onTagRegistered exception: "+
c)}}};a.prototype.registerTags=function(a){for(var b=0;b<a.length;b++)this.registerTag(a[b])};a.prototype.setConfig=function(a){this.log.FINEST("Setting configuration:");this.log.FINEST(a,!0);for(var b in a)this.config[b]=a[b]};a.prototype.run=function(){this.log.FINE("starting loading");this.runTags({command:"runOnceIfFiltersPass"})};a.prototype.runWithoutFilters=function(){this.log.FINE("starting loading");this.runTags({command:"run"})};a.prototype.getTagByname=function(a){return this.tags[a]};
a.prototype.containerScriptLoadedSynchronously=function(){var a,b,c,d,f;d=document.getElementsByTagName("script");a=0;for(b=d.length;a<b;a+=1)if(c=d[a],(f=c.getAttribute("src"))&&0<f.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js"))return null===c.getAttribute("async")&&(!1===c.getAttribute("defer")||""===c.getAttribute("defer")||null===c.getAttribute("defer"));return!0};a.prototype.prepareSessionIfNeeded=function(){var b=this.config.trackSession;if(!0!==b&&!1!==b){var b=this.tags,
c;for(c in b)if(b.hasOwnProperty(c)){for(var f=b[c].getFilters(),g=0;g<f.length;g++){var h=f[g];if(h instanceof d&&!h.isAllStartersDefaults()){this.trackSession=!0;break}}if(this.trackSession)break}}else this.trackSession=b;a.TRACK_SESSION&&(this.trackSession=!0);this.trackSession&&(this.session=e.setupSession(this));this.session&&(this.log.INFO("Session attached:"),this.log.INFO(this.session,!0))};a.prototype.runTags=function(b,c){if(c||!a.LOCKED&&!k.global().QUBIT_CONTAINERS_LOCKED){if(this.onBeforeRun)try{this.onBeforeRun()}catch(d){this.log.ERROR("Soft failure [Container.onBeforeRun()]: "+
d)}var e=!this.containerScriptLoadedSynchronously(),g="runIfFiltersPass";b&&b.command&&(g=b.command);this.runningStarted=(new Date).valueOf();this.log.FINE("triggering runningStarted at "+this.runningStarted);var h={};this.config.scanTags&&!this._scanned&&(this.scanForTags(),this._scanned=(new Date).valueOf());this.prepareSessionIfNeeded();for(var l=this.getTagsInOrder(),m=0;m<l.length;m++)try{var p=l[m],q=p.config.name;if(this.includedToRun(p)){var r=p.resolveDependencies();if(0<r.length)for(var s=
0;s<r.length;s++){var u=r[s],v=u.config.name;!h[v]&&this.tags[v]&&(h[v]=u,this._tagRunner(u,g,e))}h[q]||(h[q]=p,this._tagRunner(p,g,e))}}catch(y){this.log.ERROR("Error while preparing tag '"+q+"' to run.\n Error: "+y)}f.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),1100);this.waitForAllTagsToFinish()}else this.log.INFO("All containers are LOCKED."),this.log.INFO("To run, set Container.LOCKED to false and  set Utils.global().QUBIT_CONTAINERS_LOCKED to false or use force parameter."),
this.log.WARN("Container locked - stopping here.")};a.prototype.getTagsInOrder=function(){var a=[],b;for(b in this.tags){var c=this.tags[b],d=c.config.priority;if(0<+d){for(var f=0,e=0;e<a.length;e++){var g=a[e];if(g)if(g=+g.config.priority,0<g&&g>d)f++;else break}a.splice(f,0,c)}else a.push(c)}return a};a.prototype._tagRunner=function(a,b,c){try{this.includedToRun(a)&&(this.log.FINE("triggering tag named: "+a.config.name),c&&(a.forceAsynchronous=!0),this.config.delayDocWrite&&(a.delayDocWrite=!0),
a.session=a.session||this.session,a[b]())}catch(d){this.log.ERROR(" -> tagRunner: Error running tag with name '"+a.config.name+"'.\n Error: "+d)}};a.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;if(this._pkgName)return this._pkgName;var a=this.PACKAGE_NAME.split(".");return this._pkgName=a=a[a.length-1]};a.prototype.includedToRun=function(b){if(!b)return!1;var d=b.config;if(d.inactive||d.disabled&&!b.cookieSaysToRunEvenIfDisabled()||b.disabledByCookie())return!1;
d=a.consentIsGiven||!d.needsConsent||this.hasConsent();b=b.state===c.prototype.STATE.INITIAL;return this.ignoreTagsState||d&&b};a.prototype.scanForTags=function(a,b){a&&(this.tags={});var c;c=b&&"object"===typeof b?this.findAllTags(b):this.findAllTagsByClassPath();this.registerTags(c);return c};a.prototype.findAllTags=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return h.findAllTags(a,b)};a.prototype.findAllTagsByClassPath=function(a){a=a||this.PACKAGE_NAME;return h.findAllTagsByClassPath(a)};
a.prototype.findAllFilters=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return h.findAllFilters(a,b)};a.prototype.waitForAllTagsToFinish=function(){if(!this._waitForAllTagsToFinishWaiting){this._lastWaited||(this._lastWaited=(new Date).valueOf());var a=this.log,b=15E3<(new Date).valueOf()-this._lastWaited,c=this.allTagsFinished()||b;if(!this._showFinishedOnce&&c){this._lastWaited=null;b&&this.log.WARN("Waiting too long. Check tags dependencies.");this._showFinishedOnce=!0;this.runningFinished=
(new Date).valueOf();b=this.getAllTagsByState();c=null===b.awaiting?0:k.keys(b.awaiting).length;a.INFO("********************************************************",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");a.INFO("Startup tags have ended their processing.",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");a.INFO("Finished in "+(this.runningFinished-this.runningStarted)+"ms.",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");var d;b.run?(d=k.keys(b.run).length,a.INFO("Successfully run tags["+
d+"]:",0," ;color: #0F7600;font-size: 12px;font-weight:bold; "),a.INFO(b.run,!0)):a.INFO("No successfully run tags.",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");b.failed?(d=k.keys(b.failed).length,a.INFO("Failed to run["+d+"]:",0," ;color: #0F7600;font-size: 12px;font-weight:bold; "+(null===b.failed?"":"color: #DF5500;")),a.INFO(b.failed,!0)):a.INFO("No failed tags.",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");b.awaiting?(d=k.keys(b.awaiting).length,a.INFO("There is still "+
c+" tag(s) ready to be fired by awaiting filters that can run.",0," ;color: #0F7600;font-size: 12px;font-weight:bold; color: #DC9500;"),a.INFO("Filter ready tags["+d+"]:",0," ;color: #0F7600;font-size: 12px;font-weight:bold; color: #DC9500;"),a.INFO(b.awaiting,!0)):a.INFO("No filter ready tags.",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");b.consent?(d=k.keys(b.consent).length,a.INFO("Consent awaiting tags["+d+"]:",0," ;color: #0F7600;font-size: 12px;font-weight:bold; "),a.INFO(b.consent,
!0)):a.INFO("No consent awaiting tags.",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");b.locked?(d=k.keys(b.locked).length,a.INFO("Locked ["+d+"]:",0," ;color: #0F7600;font-size: 12px;font-weight:bold; "),a.INFO(b.locked,!0)):a.INFO("No locked tags.",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");b.other?(d=k.keys(b.other).length,a.INFO("Other unloaded tags["+d+"]:",0," ;color: #0F7600;font-size: 12px;font-weight:bold; "),a.INFO(b.other,!0)):a.INFO("No unloaded tags.",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");
a.INFO("********************************************************",0," ;color: #0F7600;font-size: 12px;font-weight:bold; ");this.sendPingsNotTooOften();if(this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else c?(a.INFO("********************************************************"),a.WARN("All tags seem to finished current jobs."),a.INFO("********************************************************")):(this._waitForAllTagsToFinishWaiting=!0,this._showFinishedOnce=!1,f.setTimeout(function(){this._waitForAllTagsToFinishWaiting=
!1;this.waitForAllTagsToFinish()}.bind(this),100))}};a.prototype.onTagsInitiallyRun=v;a.prototype.resetAllTags=function(){this.log.WARN("reseting all tags!");for(var a in this.tags)this.tags.hasOwnProperty(a)&&this.tags[a].reset()};a.prototype.reset=function(){this.log.WARN("reseting container!");this._showFinishedOnce=this.runningStarted=this._waitForAllTagsToFinishWaiting=this.runningFinished=void 0;this.resetAllTags()};a.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};f.runIfNotScheduled(this._pingAsyncCallback,
2E3,this._sndLck)};a.prototype.sendPings=function(){if(this.config.noPings)this.log.WARN("Pings are cancelled due to configuration.");else{var a;if(this.isTellingLoadTimes){var b=this.getAllTagsByState(),c=this,d;b.run&&(d=h.getLoadTimes(b.run),this.log.INFO("Sending standard load pings"),this.lastPingsSentTime=(new Date).valueOf(),this.ping.send(this,d));d=h.getLoadTimes();var f=[];for(a=0;a<d.length;a++)(function(a){a=d[a].tag;a.config.dedupe&&a.sendDedupePing&&f.push(a)})(a);0<f.length&&(this.log.INFO("Sending deduplication pings"),
this.lastDedupePingsSentTime=(new Date).valueOf(),this.ping.sendDedupe(this,f));if(b.other){d=h.getLoadTimes(b.other);var e=[];for(a=0;a<d.length;a++)(function(a){var b=d[a].tag;e.push(d[a]);var f=b.onAfter;b.onAfter=function(a){f.call(b,a);c.sendPingsNotTooOften();a&&b.log.INFO("[Other]SENDING LOAD STATS")}})(a);0<e.length&&this.ping.send(this,e)}if(b.awaiting){d=h.getLoadTimes(b.awaiting);var g=[];for(a=0;a<d.length;a++)(function(a){var b=d[a].tag;g.push(d[a]);var f=b.onAfter;b.onAfter=function(a){f.call(b,
a);c.sendPingsNotTooOften();a&&b.log.INFO("[Awaiting]SENDING LOAD STATS")}})(a);0<g.length&&this.ping.send(this,g)}}}};a.prototype.getAllTagsByState=function(){return a.getAllTagsByState(this.tags)};a.getAllTagsByState=function(a){var d=null,f=null,e=null,g=null,h=null,k=null,m=c.prototype.STATE.EXECUTED_WITH_ERRORS,p;for(p in a){var q=a[p];if(q instanceof c){var r=q.config.name;0<q.scriptExecuted?(d=d||{},l(d,q,r)):q.locked?(k=k||{},l(k,q,r)):0>q.scriptExecuted||q.state>=m?(g=g||{},l(g,q,r)):q.filtersState()===
b.state.SESSION||0<q.filtersState()?(e=e||{},l(e,q,r)):q.config.needsConsent?(h=h||{},l(h,q,r)):(f=f||{},l(f,q,r))}}return{run:d,failed:g,awaiting:e,consent:h,locked:k,other:f}};var s={};a.prototype.allTagsFinished=function(){for(var a in this.tags)if(this.tags.hasOwnProperty(a)){var c=this.tags[a];if(c instanceof g.opentag.BaseTag){var d=c.filtersState();if(!c.config.disabled){var f=0>c.filtersState()&&!c.locked,e=!(c.finished()||c.config.runner&&!c.isRunning);if(f&&e&&(c=0<+c.awaitingDependencies,
d!==b.state.SESSION&&!c))return!1}}}return!0};a.prototype.getPageVariables=function(){var a=[],b;for(b in this.tags)if(this.tags.hasOwnProperty(b))for(var c=this.tags[b].getPageVariables(),d=0;d<c.length;d++)k.addToArrayIfNotExist(a,c[d]);return a};a.getPageVariableByName=function(a){for(var b=this.getAllPageVariables(),c=[],d=0;d<b.length;d++)b[d].config.name===a&&c.push(b[d]);return c};a.prototype._getCookieNameForDisabling=function(){return"qubit.opentag.disableContainerRunning_"+this.getContainerId()+
this.config.name};a.prototype.disabledByCookie=function(){return!!m.get(this._getCookieNameForDisabling())};a.prototype.setCookieToDisable=function(){m.set(this._getCookieNameForDisabling(),"true")};a.prototype.rmCookieToDisable=function(){m.rm(this._getCookieNameForDisabling())};a.rmAllDisablingCookies=function(){k.rmCookiesMatching("qubit.opentag.disableContainerRunning_")};a.setCookieForDisabledContainersToRun=function(){m.set("qubit.opentag.forceContainerRunning","true")};a.rmCookieForDisabledContainersToRun=
function(){m.rm("qubit.opentag.forceContainerRunning")}})();(function(){function a(g){l.setIfUnset(g,{url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:!0});a.SUPER.call(this,g)}var l=g.opentag.Utils;g.Define.clazz("qubit.opentag.CustomTag",a,g.opentag.LibraryTag)})();(function(){function a(){}function l(a,b,d){!d||void 0!==a[b]&&""!==a[b]&&null!==a[b]||(a[b]=d)}var k=new g.opentag.Log("Main -> "),b=g.Cookie,d=g.opentag.Utils;g.opentag.Log.setLevel(g.opentag.Log.LEVEL_NONE);
g.opentag.Log.setCollectLevel(3);g.opentag.Log.setLevel(g.opentag.Log.LEVEL_INFO);g.opentag.Log.setCollectLevel(4);a.run=function(){var c=!1,d;d=0<=document.location.href.indexOf("opentag_disabled=true")?!0:!1;if(!d){d=!1;d=!0;var h;h=!1;if(b.get("opentag_debug_tool")||0<=document.location.href.indexOf("opentag_debug_tool"))h=!0;var e;!(e=h)&&(e=!1,b.get("opentag_debug")||0<=document.location.href.indexOf("opentag_debug"))&&(e=!0);!d&&e&&(A.TAGSDK_NS_OVERRIDE=g.opentag.Log?!1:!0,c=!0);g.opentag.Log&&
(A.TAGSDK_NS_OVERRIDE=!1);try{r.UVListener.init()}catch(k){}a.runAllContainers(c);!c&&d&&h&&!A.TAGSDK_DEBUG_TOOL_LOADED&&(c=document.createElement("script"),c.src="https://s3-eu-west-1.amazonaws.com/opentag-dev/debug-tool/loader.js",document.getElementsByTagName("head")[0].appendChild(c),A.TAGSDK_DEBUG_TOOL_LOADED=!0)}};a.runAllContainers=function(b){try{for(var f=g.opentag.Container.getContainers(),h=0;h<f.length;h++){var e=f[h],m=e.config;if(!e.runningStarted&&!e.configuredInMain){m.scanTags=!0;
var r=d.getParentObject(e.PACKAGE_NAME).ClientConfig;r&&l(e.config,"clientId",r.id);var p=d.getParentObject(e.PACKAGE_NAME).SystemDefaults;p&&(l(m,"pingServerUrl",p.pingServerUrl),l(m,"tellLoadTimesProbability",p.tellLoadTimesProbability));e.configuredInMain=!0;b?a.loadDebugVersionForContainer(e):A.QUBIT_OPENTAG_STOP_MAIN_EXECUTION?function(){var a=g.opentag.RUN_STOPPED_EXECUTON;g.opentag.RUN_STOPPED_EXECUTON=function(){try{a&&a()}finally{e.run()}}}(e):(k.INFO("Running container "+e.CLASSPATH),e.run())}}}catch(v){}};
a.loadDebugVersion=function(a){var b=document.createElement("script"),d,e=a.config.scriptURL,k;(k=g.opentag.Utils.getParentObject(a.PACKAGE_NAME).ClientConfig)&&k.clientId?k=k.clientId:(k=a.PACKAGE_NAME.split("."),k=k[k.length-2].substring(1));a=a.getContainerId();e&&(d=e,d.lastIndexOf("-debug.js")!==d.length-9&&(d=d.substring(0,d.length-3),d+="-debug.js"));b.src=d&&"//d3c3cq33003psk.cloudfront.net/opentag-"+k+"-"+a+"-debug.js"!==d?d:"//s3-eu-west-1.amazonaws.com/opentag/opentag-"+k+"-"+a+"-debug.js";
document.getElementsByTagName("head")[0].appendChild(b)};g.Define.namespace("qubit.opentag.Main",a)})();(function(){function a(g){a.SUPER.call(this,g)}g.Define.clazz("qubit.opentag.filter.Filter",a,g.opentag.filter.SessionVariableFilter)})();(function(){function a(g){a.SUPER.apply(this,arguments)}g.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",a,g.opentag.pagevariable.Expression)})()})();
